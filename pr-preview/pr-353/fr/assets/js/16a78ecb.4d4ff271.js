"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3424],{6394:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>u,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"API/api-key-app-developer-authorization-flow","title":"Flux d\'autorisation de cl\xe9 API","description":"Ce document d\xe9crit le processus de cr\xe9ation de cl\xe9 API en libre-service pour les applications tierces.","source":"@site/i18n/fr/docusaurus-plugin-content-docs/current/API/api-key-app-developer-authorization-flow.mdx","sourceDirName":"API","slug":"/API/api-key-app-developer-authorization-flow","permalink":"/docs/pr-preview/pr-353/fr/API/api-key-app-developer-authorization-flow","draft":false,"unlisted":false,"editUrl":"https://translate.unraid.net/unraid-docs/fr","tags":[],"version":"current","frontMatter":{},"sidebar":"unraidSidebar","previous":{"title":"Feuille de route & Fonctionnalit\xe9s","permalink":"/docs/pr-preview/pr-353/fr/API/upcoming-features"},"next":{"title":"Contribute","permalink":"/docs/pr-preview/pr-353/fr/category/contribute"}}');var r=s(4848),t=s(8453);const l={},c="Flux d'autorisation de cl\xe9 API",o={},a=[{value:"Aper\xe7u",id:"aper\xe7u",level:2},{value:"Flux",id:"flux",level:2},{value:"Param\xe8tres de requ\xeate",id:"param\xe8tres-de-requ\xeate",level:2},{value:"Format de port\xe9e",id:"format-de-port\xe9e",level:2},{value:"Exemples :",id:"exemples-",level:3},{value:"Ressources disponibles :",id:"ressources-disponibles-",level:3},{value:"Actions disponibles :",id:"actions-disponibles-",level:3},{value:"Consid\xe9rations de s\xe9curit\xe9",id:"consid\xe9rations-de-s\xe9curit\xe9",level:2},{value:"Int\xe9gration Exemple",id:"int\xe9gration-exemple",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"flux-dautorisation-de-cl\xe9-api",children:"Flux d'autorisation de cl\xe9 API"})}),"\n",(0,r.jsx)(n.p,{children:"Ce document d\xe9crit le processus de cr\xe9ation de cl\xe9 API en libre-service pour les applications tierces."}),"\n",(0,r.jsx)(n.h2,{id:"aper\xe7u",children:"Aper\xe7u"}),"\n",(0,r.jsx)(n.p,{children:"Les applications peuvent demander un acc\xe8s API \xe0 un serveur Unraid en redirigeant les utilisateurs vers une page d'autorisation sp\xe9ciale o\xf9 les utilisateurs peuvent examiner les autorisations demand\xe9es et cr\xe9er une cl\xe9 API en un clic."}),"\n",(0,r.jsx)(n.h2,{id:"flux",children:"Flux"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"L'application initie la demande"})," : L'application redirige l'utilisateur vers :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://[unraid-server]/ApiKeyAuthorize?name=MyApp&scopes=docker:read,vm:*&redirect_uri=https://myapp.com/callback&state=abc123\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Authentification de l'utilisateur"})," : Si non d\xe9j\xe0 connect\xe9, l'utilisateur est d'abord redirig\xe9 pour se connecter (auth standard Unraid)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"\xc9cran de consentement"})," : L'utilisateur voit :"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Nom et description de l'application"}),"\n",(0,r.jsx)(n.li,{children:"Autorisations demand\xe9es (avec cases \xe0 cocher pour approuver/refuser des port\xe9es sp\xe9cifiques)"}),"\n",(0,r.jsx)(n.li,{children:"Champ de nom de la cl\xe9 API (pr\xe9-rempli)"}),"\n",(0,r.jsx)(n.li,{children:"Boutons Autoriser & Annuler"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Cr\xe9ation de cl\xe9 API"})," : Apr\xe8s autorisation :"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"La cl\xe9 API est cr\xe9\xe9e avec les port\xe9es approuv\xe9es"}),"\n",(0,r.jsx)(n.li,{children:"La cl\xe9 est affich\xe9e \xe0 l'utilisateur"}),"\n",(0,r.jsxs)(n.li,{children:["Si ",(0,r.jsx)(n.code,{children:"redirect_uri"})," est fourni, l'utilisateur est redirig\xe9 avec la cl\xe9"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Rappel"})," : L'application re\xe7oit la cl\xe9 API :"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://myapp.com/callback?api_key=xxx&state=abc123\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"param\xe8tres-de-requ\xeate",children:"Param\xe8tres de requ\xeate"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"name"})," (obligatoire) : Nom de l'application requ\xe9rante"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"description"})," (facultatif) : Description de l'application"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"scopes"})," (obligatoire) : Liste des port\xe9es demand\xe9es, s\xe9par\xe9e par des virgules"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"redirect_uri"})," (facultatif) : URL de redirection apr\xe8s autorisation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"state"})," (facultatif) : Valeur opaque pour maintenir l'\xe9tat"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"format-de-port\xe9e",children:"Format de port\xe9e"}),"\n",(0,r.jsxs)(n.p,{children:["Les port\xe9es suivent le mod\xe8le : ",(0,r.jsx)(n.code,{children:"ressource:action"})]}),"\n",(0,r.jsx)(n.h3,{id:"exemples-",children:"Exemples :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"docker:read"})," - Acc\xe8s en lecture \xe0 Docker"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"vm:*"})," - Acc\xe8s complet aux machines virtuelles"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"system:update"})," - Acc\xe8s de mise \xe0 jour au syst\xe8me"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"role:viewer"})," - Acc\xe8s en tant que visualiseur"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"role:admin"})," - Acc\xe8s en tant qu'administrateur"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"ressources-disponibles-",children:"Ressources disponibles :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"docker"}),", ",(0,r.jsx)(n.code,{children:"vm"}),", ",(0,r.jsx)(n.code,{children:"system"}),", ",(0,r.jsx)(n.code,{children:"share"}),", ",(0,r.jsx)(n.code,{children:"user"}),", ",(0,r.jsx)(n.code,{children:"network"}),", ",(0,r.jsx)(n.code,{children:"disk"}),", etc."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"actions-disponibles-",children:"Actions disponibles :"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"create"}),", ",(0,r.jsx)(n.code,{children:"read"}),", ",(0,r.jsx)(n.code,{children:"update"}),", ",(0,r.jsx)(n.code,{children:"delete"})," ou ",(0,r.jsx)(n.code,{children:"*"})," pour toutes"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"consid\xe9rations-de-s\xe9curit\xe9",children:"Consid\xe9rations de s\xe9curit\xe9"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"HTTPS requis"})," : Les URIs de redirection doivent utiliser HTTPS (sauf localhost pour le d\xe9veloppement)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Consentement de l'utilisateur"})," : Les utilisateurs approuvent explicitement chaque autorisation"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Bas\xe9 sur la session"})," : Utilise la session d'authentification Unraid existante"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Affichage unique"})," : Les cl\xe9s API sont affich\xe9es une fois et doivent \xeatre sauvegard\xe9es en toute s\xe9curit\xe9"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"int\xe9gration-exemple",children:"Int\xe9gration Exemple"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// JavaScript example\nconst unraidServer = 'tower.local';\nconst appName = 'My Docker Manager';\nconst scopes = 'docker:*,system:read';\nconst redirectUri = 'https://myapp.com/unraid/callback';\nconst state = generateRandomState();\n\n// Store state for verification\nsessionStorage.setItem('oauth_state', state);\n\n// Redirect user to authorization page\nwindow.location.href =\n    `https://${unraidServer}/ApiKeyAuthorize?` +\n    `name=${encodeURIComponent(appName)}&` +\n    `scopes=${encodeURIComponent(scopes)}&` +\n    `redirect_uri=${encodeURIComponent(redirectUri)}&` +\n    `state=${encodeURIComponent(state)}`;\n\n// Handle callback\nconst urlParams = new URLSearchParams(window.location.search);\nconst apiKey = urlParams.get('api_key');\nconst returnedState = urlParams.get('state');\n\nif (returnedState === sessionStorage.getItem('oauth_state')) {\n    // Save API key securely\n    saveApiKey(apiKey);\n}\n"})})]})}function u(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var i=s(6540);const r={},t=i.createContext(r);function l(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:l(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);