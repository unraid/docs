"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2340],{8831:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"API/api-key-app-developer-authorization-flow","title":"API key authorization flow","description":"This document describes the self-service API key creation flow for third-party applications.","source":"@site/docs/API/api-key-app-developer-authorization-flow.mdx","sourceDirName":"API","slug":"/API/api-key-app-developer-authorization-flow","permalink":"/docs/pr-preview/pr-394/API/api-key-app-developer-authorization-flow","draft":false,"unlisted":false,"editUrl":"https://github.com/unraid/docs/edit/fix-device-counts/docs/API/api-key-app-developer-authorization-flow.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"unraidSidebar","previous":{"title":"Roadmap & Features","permalink":"/docs/pr-preview/pr-394/API/upcoming-features"},"next":{"title":"Contribute","permalink":"/docs/pr-preview/pr-394/category/contribute"}}');var i=r(4848),t=r(8453);const o={},a="API key authorization flow",c={},d=[{value:"Overview",id:"overview",level:2},{value:"Flow",id:"flow",level:2},{value:"Query parameters",id:"query-parameters",level:2},{value:"Scope format",id:"scope-format",level:2},{value:"Example integration",id:"example-integration",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"api-key-authorization-flow",children:"API key authorization flow"})}),"\n",(0,i.jsx)(n.p,{children:"This document describes the self-service API key creation flow for third-party applications."}),"\n",(0,i.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,i.jsx)(n.p,{children:"Applications can request API access to an Unraid server by redirecting users to a special authorization page where users can review requested permissions and create an API key with one click."}),"\n",(0,i.jsx)(n.h2,{id:"flow",children:"Flow"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Application initiates request"}),": The app redirects the user to:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"https://[unraid-server]/ApiKeyAuthorize?name=MyApp&scopes=docker:read,vm:*&redirect_uri=https://myapp.com/callback&state=abc123\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"User authentication"}),": If not already logged in, the user is redirected to login first (standard Unraid auth)."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Consent screen"}),": User sees:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Application name and description"}),"\n",(0,i.jsx)(n.li,{children:"Requested permissions (with checkboxes to approve/deny specific scopes)"}),"\n",(0,i.jsx)(n.li,{children:"API key name field (pre-filled)"}),"\n",(0,i.jsx)(n.li,{children:"Authorize & Cancel buttons"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"API key creation"}),": Upon authorization:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"API key is created with approved scopes."}),"\n",(0,i.jsx)(n.li,{children:"Key is displayed to the user."}),"\n",(0,i.jsxs)(n.li,{children:["If ",(0,i.jsx)(n.code,{children:"redirect_uri"})," is provided, user is redirected back with the key."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Callback"}),": App receives the API key:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"https://myapp.com/callback?api_key=xxx&state=abc123\n"})}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"query-parameters",children:"Query parameters"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"name"})," (required): Name of the requesting application"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"description"})," (optional): Description of the application"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"scopes"})," (required): Comma-separated list of requested scopes"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"redirect_uri"})," (optional): URL to redirect after authorization"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"state"})," (optional): Opaque value for maintaining state"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"scope-format",children:"Scope format"}),"\n",(0,i.jsxs)(n.p,{children:["Scopes follow the pattern: ",(0,i.jsx)(n.code,{children:"resource:action"}),". Examples include ",(0,i.jsx)(n.code,{children:"docker:read"})," (read access to Docker), ",(0,i.jsx)(n.code,{children:"vm:*"})," (full access to VMs), ",(0,i.jsx)(n.code,{children:"system:update"})," (update access to system), ",(0,i.jsx)(n.code,{children:"role:viewer"})," (viewer role access), and ",(0,i.jsx)(n.code,{children:"role:admin"})," (admin role access)."]}),"\n",(0,i.jsxs)(n.p,{children:["Available resources include ",(0,i.jsx)(n.code,{children:"docker"}),", ",(0,i.jsx)(n.code,{children:"vm"}),", ",(0,i.jsx)(n.code,{children:"system"}),", ",(0,i.jsx)(n.code,{children:"share"}),", ",(0,i.jsx)(n.code,{children:"user"}),", ",(0,i.jsx)(n.code,{children:"network"}),", ",(0,i.jsx)(n.code,{children:"disk"}),", and others. Available actions are ",(0,i.jsx)(n.code,{children:"create"}),", ",(0,i.jsx)(n.code,{children:"read"}),", ",(0,i.jsx)(n.code,{children:"update"}),", ",(0,i.jsx)(n.code,{children:"delete"}),", or ",(0,i.jsx)(n.code,{children:"*"})," for all."]}),"\n",(0,i.jsx)(n.p,{children:"Redirect URIs must use HTTPS (except localhost for development). Users explicitly approve each permission, and the flow uses existing Unraid authentication sessions. API keys are shown once and must be saved securely."}),"\n",(0,i.jsx)(n.h2,{id:"example-integration",children:"Example integration"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"// JavaScript example\nconst unraidServer = 'tower.local';\nconst appName = 'My Docker Manager';\nconst scopes = 'docker:*,system:read';\nconst redirectUri = 'https://myapp.com/unraid/callback';\nconst state = generateRandomState();\n\n// Store state for verification\nsessionStorage.setItem('oauth_state', state);\n\n// Redirect user to authorization page\nwindow.location.href =\n    `https://${unraidServer}/ApiKeyAuthorize?` +\n    `name=${encodeURIComponent(appName)}&` +\n    `scopes=${encodeURIComponent(scopes)}&` +\n    `redirect_uri=${encodeURIComponent(redirectUri)}&` +\n    `state=${encodeURIComponent(state)}`;\n\n// Handle callback\nconst urlParams = new URLSearchParams(window.location.search);\nconst apiKey = urlParams.get('api_key');\nconst returnedState = urlParams.get('state');\n\nif (returnedState === sessionStorage.getItem('oauth_state')) {\n    // Save API key securely\n    saveApiKey(apiKey);\n}\n"})})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}},8453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var s=r(6540);const i={},t=s.createContext(i);function o(e){const n=s.useContext(t);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(t.Provider,{value:n},e.children)}}}]);