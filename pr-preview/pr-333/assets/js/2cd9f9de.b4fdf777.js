"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[3101],{3242:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"API/programmatic-api-key-management","title":"Programmatic API Key Management","description":"Create, use, and delete API keys programmatically for automated workflows","source":"@site/docs/API/programmatic-api-key-management.mdx","sourceDirName":"API","slug":"/API/programmatic-api-key-management","permalink":"/docs/pr-preview/pr-333/API/programmatic-api-key-management","draft":false,"unlisted":false,"editUrl":"https://github.com/unraid/docs/edit/fix-go-check-filesystem/docs/API/programmatic-api-key-management.mdx","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Programmatic API Key Management","description":"Create, use, and delete API keys programmatically for automated workflows","sidebar_position":4},"sidebar":"unraidSidebar","previous":{"title":"CLI Reference","permalink":"/docs/pr-preview/pr-333/API/cli"},"next":{"title":"Roadmap & Features","permalink":"/docs/pr-preview/pr-333/API/upcoming-features"}}');var r=i(4848),l=i(8453);const d={title:"Programmatic API Key Management",description:"Create, use, and delete API keys programmatically for automated workflows",sidebar_position:4},c="Programmatic API Key Management",o={},a=[{value:"Overview",id:"overview",level:2},{value:"Creating API Keys Programmatically",id:"creating-api-keys-programmatically",level:2},{value:"Basic Creation with JSON Output",id:"basic-creation-with-json-output",level:3},{value:"Advanced Creation with Permissions",id:"advanced-creation-with-permissions",level:3},{value:"Handling Existing Keys",id:"handling-existing-keys",level:3},{value:"Deleting API Keys Programmatically",id:"deleting-api-keys-programmatically",level:2},{value:"Non-Interactive Deletion",id:"non-interactive-deletion",level:3},{value:"JSON Output for Deletion",id:"json-output-for-deletion",level:3},{value:"Error Handling",id:"error-handling",level:3},{value:"Complete Workflow Example",id:"complete-workflow-example",level:2},{value:"Command Reference",id:"command-reference",level:2},{value:"Create Command Options",id:"create-command-options",level:3},{value:"Available Roles",id:"available-roles",level:3},{value:"Available Resources and Actions",id:"available-resources-and-actions",level:3},{value:"Delete Command Options",id:"delete-command-options",level:3},{value:"Best Practices",id:"best-practices",level:2},{value:"Error Handling",id:"error-handling-1",level:3},{value:"Key Naming",id:"key-naming",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"Common Issues",id:"common-issues",level:3},{value:"Debug Mode",id:"debug-mode",level:3}];function t(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"programmatic-api-key-management",children:"Programmatic API Key Management"})}),"\n",(0,r.jsx)(n.p,{children:"This guide explains how to create, use, and delete API keys programmatically using the Unraid API CLI, enabling automated workflows and scripts."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"unraid-api apikey"})," command supports both interactive and non-interactive modes, making it suitable for:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Automated deployment scripts"}),"\n",(0,r.jsx)(n.li,{children:"CI/CD pipelines"}),"\n",(0,r.jsx)(n.li,{children:"Temporary access provisioning"}),"\n",(0,r.jsx)(n.li,{children:"Infrastructure as code workflows"}),"\n"]}),"\n",(0,r.jsx)(n.admonition,{title:"Quick Start",type:"tip",children:(0,r.jsxs)(n.p,{children:["Jump to the ",(0,r.jsx)(n.a,{href:"#complete-workflow-example",children:"Complete Workflow Example"})," to see everything in action."]})}),"\n",(0,r.jsx)(n.h2,{id:"creating-api-keys-programmatically",children:"Creating API Keys Programmatically"}),"\n",(0,r.jsx)(n.h3,{id:"basic-creation-with-json-output",children:"Basic Creation with JSON Output"}),"\n",(0,r.jsxs)(n.p,{children:["Use the ",(0,r.jsx)(n.code,{children:"--json"})," flag to get machine-readable output:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'unraid-api apikey --create --name "workflow key" --roles ADMIN --json\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "key": "your-generated-api-key-here",\n    "name": "workflow key",\n    "id": "generated-uuid"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"advanced-creation-with-permissions",children:"Advanced Creation with Permissions"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'unraid-api apikey --create \\\n  --name "limited access key" \\\n  --permissions "DOCKER:READ_ANY,ARRAY:READ_ANY" \\\n  --description "Read-only access for monitoring" \\\n  --json\n'})}),"\n",(0,r.jsx)(n.h3,{id:"handling-existing-keys",children:"Handling Existing Keys"}),"\n",(0,r.jsxs)(n.p,{children:["If a key with the same name exists, use ",(0,r.jsx)(n.code,{children:"--overwrite"}),":"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'unraid-api apikey --create --name "existing key" --roles ADMIN --overwrite --json\n'})}),"\n",(0,r.jsx)(n.admonition,{title:"Key Replacement",type:"warning",children:(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"--overwrite"})," flag will permanently replace the existing key. The old key will be immediately invalidated."]})}),"\n",(0,r.jsx)(n.h2,{id:"deleting-api-keys-programmatically",children:"Deleting API Keys Programmatically"}),"\n",(0,r.jsx)(n.h3,{id:"non-interactive-deletion",children:"Non-Interactive Deletion"}),"\n",(0,r.jsx)(n.p,{children:"Delete a key by name without prompts:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'unraid-api apikey --delete --name "workflow key"\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"Successfully deleted 1 API key\n"})}),"\n",(0,r.jsx)(n.h3,{id:"json-output-for-deletion",children:"JSON Output for Deletion"}),"\n",(0,r.jsxs)(n.p,{children:["Use ",(0,r.jsx)(n.code,{children:"--json"})," flag for machine-readable delete confirmation:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'unraid-api apikey --delete --name "workflow key" --json\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Success Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "deleted": 1,\n    "keys": [\n        {\n            "id": "generated-uuid",\n            "name": "workflow key"\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Error Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "deleted": 0,\n    "error": "No API key found with name: nonexistent key"\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"error-handling",children:"Error Handling"}),"\n",(0,r.jsx)(n.p,{children:"When the specified key doesn't exist:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'unraid-api apikey --delete --name "nonexistent key"\n# Output: No API keys found to delete\n'})}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"JSON Error Output:"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n    "deleted": 0,\n    "message": "No API keys found to delete"\n}\n'})}),"\n",(0,r.jsx)(n.h2,{id:"complete-workflow-example",children:"Complete Workflow Example"}),"\n",(0,r.jsx)(n.p,{children:"Here's a complete example for temporary access provisioning:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\nset -e\n\n# 1. Create temporary API key\necho "Creating temporary API key..."\nKEY_DATA=$(unraid-api apikey --create \\\n  --name "temp deployment key" \\\n  --roles ADMIN \\\n  --description "Temporary key for deployment $(date)" \\\n  --json)\n\n# 2. Extract the API key\nAPI_KEY=$(echo "$KEY_DATA" | jq -r \'.key\')\necho "API key created successfully"\n\n# 3. Use the key for operations\necho "Configuring services..."\ncurl -H "Authorization: Bearer $API_KEY" \\\n  -H "Content-Type: application/json" \\\n  -d \'{"provider": "azure", "clientId": "your-client-id"}\' \\\n  http://localhost:3001/graphql\n\n# 4. Clean up (always runs, even on error)\ntrap \'echo "Cleaning up..."; unraid-api apikey --delete --name "temp deployment key"\' EXIT\n\necho "Deployment completed successfully"\n'})}),"\n",(0,r.jsx)(n.h2,{id:"command-reference",children:"Command Reference"}),"\n",(0,r.jsx)(n.h3,{id:"create-command-options",children:"Create Command Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Flag"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Example"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--name <name>"})}),(0,r.jsx)(n.td,{children:"Key name (required)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'--name "my key"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--roles <roles>"})}),(0,r.jsx)(n.td,{children:"Comma-separated roles"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--roles ADMIN,VIEWER"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--permissions <perms>"})}),(0,r.jsxs)(n.td,{children:["Resource",":action"," pairs"]}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'--permissions "DOCKER:READ_ANY"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--description <desc>"})}),(0,r.jsx)(n.td,{children:"Key description"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'--description "CI/CD key"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--overwrite"})}),(0,r.jsx)(n.td,{children:"Replace existing key"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--overwrite"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--json"})}),(0,r.jsx)(n.td,{children:"Machine-readable output"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--json"})})]})]})]}),"\n",(0,r.jsx)(n.h3,{id:"available-roles",children:"Available Roles"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"ADMIN"})," - Full system access"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"CONNECT"})," - Unraid Connect features"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"VIEWER"})," - Read-only access"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"GUEST"})," - Limited access"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"available-resources-and-actions",children:"Available Resources and Actions"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Resources:"})," ",(0,r.jsx)(n.code,{children:"ACTIVATION_CODE"}),", ",(0,r.jsx)(n.code,{children:"API_KEY"}),", ",(0,r.jsx)(n.code,{children:"ARRAY"}),", ",(0,r.jsx)(n.code,{children:"CLOUD"}),", ",(0,r.jsx)(n.code,{children:"CONFIG"}),", ",(0,r.jsx)(n.code,{children:"CONNECT"}),", ",(0,r.jsx)(n.code,{children:"CONNECT__REMOTE_ACCESS"}),", ",(0,r.jsx)(n.code,{children:"CUSTOMIZATIONS"}),", ",(0,r.jsx)(n.code,{children:"DASHBOARD"}),", ",(0,r.jsx)(n.code,{children:"DISK"}),", ",(0,r.jsx)(n.code,{children:"DISPLAY"}),", ",(0,r.jsx)(n.code,{children:"DOCKER"}),", ",(0,r.jsx)(n.code,{children:"FLASH"}),", ",(0,r.jsx)(n.code,{children:"INFO"}),", ",(0,r.jsx)(n.code,{children:"LOGS"}),", ",(0,r.jsx)(n.code,{children:"ME"}),", ",(0,r.jsx)(n.code,{children:"NETWORK"}),", ",(0,r.jsx)(n.code,{children:"NOTIFICATIONS"}),", ",(0,r.jsx)(n.code,{children:"ONLINE"}),", ",(0,r.jsx)(n.code,{children:"OS"}),", ",(0,r.jsx)(n.code,{children:"OWNER"}),", ",(0,r.jsx)(n.code,{children:"PERMISSION"}),", ",(0,r.jsx)(n.code,{children:"REGISTRATION"}),", ",(0,r.jsx)(n.code,{children:"SERVERS"}),", ",(0,r.jsx)(n.code,{children:"SERVICES"}),", ",(0,r.jsx)(n.code,{children:"SHARE"}),", ",(0,r.jsx)(n.code,{children:"VARS"}),", ",(0,r.jsx)(n.code,{children:"VMS"}),", ",(0,r.jsx)(n.code,{children:"WELCOME"})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Actions:"})," ",(0,r.jsx)(n.code,{children:"CREATE_ANY"}),", ",(0,r.jsx)(n.code,{children:"CREATE_OWN"}),", ",(0,r.jsx)(n.code,{children:"READ_ANY"}),", ",(0,r.jsx)(n.code,{children:"READ_OWN"}),", ",(0,r.jsx)(n.code,{children:"UPDATE_ANY"}),", ",(0,r.jsx)(n.code,{children:"UPDATE_OWN"}),", ",(0,r.jsx)(n.code,{children:"DELETE_ANY"}),", ",(0,r.jsx)(n.code,{children:"DELETE_OWN"})]}),"\n",(0,r.jsx)(n.h3,{id:"delete-command-options",children:"Delete Command Options"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Flag"}),(0,r.jsx)(n.th,{children:"Description"}),(0,r.jsx)(n.th,{children:"Example"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--delete"})}),(0,r.jsx)(n.td,{children:"Enable delete mode"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--delete"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"--name <name>"})}),(0,r.jsx)(n.td,{children:"Key to delete (optional)"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'--name "my key"'})})]})]})]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Note:"})," If ",(0,r.jsx)(n.code,{children:"--name"})," is omitted, the command runs interactively."]}),"\n",(0,r.jsx)(n.h2,{id:"best-practices",children:"Best Practices"}),"\n",(0,r.jsxs)(n.admonition,{title:"Security Best Practices",type:"info",children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Minimal Permissions"})}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use specific permissions instead of ADMIN role when possible"}),"\n",(0,r.jsxs)(n.li,{children:["Example: ",(0,r.jsx)(n.code,{children:'--permissions "DOCKER:READ_ANY"'})," instead of ",(0,r.jsx)(n.code,{children:"--roles ADMIN"})]}),"\n"]}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"Key Lifecycle Management"})}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Always clean up temporary keys after use"}),"\n",(0,r.jsx)(n.li,{children:"Store API keys securely (environment variables, secrets management)"}),"\n",(0,r.jsx)(n.li,{children:"Use descriptive names and descriptions for audit trails"}),"\n"]})]}),"\n",(0,r.jsx)(n.h3,{id:"error-handling-1",children:"Error Handling"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Check exit codes (",(0,r.jsx)(n.code,{children:"$?"}),") after each command"]}),"\n",(0,r.jsxs)(n.li,{children:["Use ",(0,r.jsx)(n.code,{children:"set -e"})," in bash scripts to fail fast"]}),"\n",(0,r.jsxs)(n.li,{children:["Implement proper cleanup with ",(0,r.jsx)(n.code,{children:"trap"})]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"key-naming",children:"Key Naming"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Use descriptive names that include purpose and date"}),"\n",(0,r.jsx)(n.li,{children:"Names must contain only letters, numbers, and spaces"}),"\n",(0,r.jsx)(n.li,{children:"Unicode letters are supported"}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"troubleshooting",children:"Troubleshooting"}),"\n",(0,r.jsx)(n.h3,{id:"common-issues",children:"Common Issues"}),"\n",(0,r.jsxs)(n.admonition,{title:"Common Error Messages",type:"note",children:[(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'"API key name must contain only letters, numbers, and spaces"'})}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Remove special characters like hyphens, underscores, or symbols"]}),"\n"]}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:"\"API key with name 'x' already exists\""})}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Use ",(0,r.jsx)(n.code,{children:"--overwrite"})," flag or choose a different name"]}),"\n"]}),(0,r.jsx)(n.p,{children:(0,r.jsx)(n.strong,{children:'"Please add at least one role or permission to the key"'})}),(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Solution:"})," Specify either ",(0,r.jsx)(n.code,{children:"--roles"})," or ",(0,r.jsx)(n.code,{children:"--permissions"})," (or both)"]}),"\n"]})]}),"\n",(0,r.jsx)(n.h3,{id:"debug-mode",children:"Debug Mode"}),"\n",(0,r.jsx)(n.p,{children:"For troubleshooting, run with debug logging:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",children:'LOG_LEVEL=debug unraid-api apikey --create --name "debug key" --roles ADMIN\n'})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(t,{...e})}):t(e)}},8453:(e,n,i)=>{i.d(n,{R:()=>d,x:()=>c});var s=i(6540);const r={},l=s.createContext(r);function d(e){const n=s.useContext(l);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:d(e.components),s.createElement(l.Provider,{value:n},e.children)}}}]);