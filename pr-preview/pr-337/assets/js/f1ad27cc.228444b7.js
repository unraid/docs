"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2340],{8831:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>c,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"API/api-key-app-developer-authorization-flow","title":"API Key Authorization Flow","description":"This document describes the self-service API key creation flow for third-party applications.","source":"@site/docs/API/api-key-app-developer-authorization-flow.mdx","sourceDirName":"API","slug":"/API/api-key-app-developer-authorization-flow","permalink":"/docs/pr-preview/pr-337/API/api-key-app-developer-authorization-flow","draft":false,"unlisted":false,"editUrl":"https://github.com/unraid/docs/edit/spencerjunraid-patch-1/docs/API/api-key-app-developer-authorization-flow.mdx","tags":[],"version":"current","frontMatter":{},"sidebar":"unraidSidebar","previous":{"title":"Roadmap & Features","permalink":"/docs/pr-preview/pr-337/API/upcoming-features"},"next":{"title":"Contribute","permalink":"/docs/pr-preview/pr-337/category/contribute"}}');var r=s(4848),t=s(8453);const c={},o="API Key Authorization Flow",a={},l=[{value:"Overview",id:"overview",level:2},{value:"Flow",id:"flow",level:2},{value:"Query Parameters",id:"query-parameters",level:2},{value:"Scope Format",id:"scope-format",level:2},{value:"Examples:",id:"examples",level:3},{value:"Available Resources:",id:"available-resources",level:3},{value:"Available Actions:",id:"available-actions",level:3},{value:"Security Considerations",id:"security-considerations",level:2},{value:"Example Integration",id:"example-integration",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"api-key-authorization-flow",children:"API Key Authorization Flow"})}),"\n",(0,r.jsx)(n.p,{children:"This document describes the self-service API key creation flow for third-party applications."}),"\n",(0,r.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsx)(n.p,{children:"Applications can request API access to an Unraid server by redirecting users to a special authorization page where users can review requested permissions and create an API key with one click."}),"\n",(0,r.jsx)(n.h2,{id:"flow",children:"Flow"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Application initiates request"}),": The app redirects the user to:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://[unraid-server]/ApiKeyAuthorize?name=MyApp&scopes=docker:read,vm:*&redirect_uri=https://myapp.com/callback&state=abc123\n"})}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"User authentication"}),": If not already logged in, the user is redirected to login first (standard Unraid auth)"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Consent screen"}),": User sees:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Application name and description"}),"\n",(0,r.jsx)(n.li,{children:"Requested permissions (with checkboxes to approve/deny specific scopes)"}),"\n",(0,r.jsx)(n.li,{children:"API key name field (pre-filled)"}),"\n",(0,r.jsx)(n.li,{children:"Authorize & Cancel buttons"}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"API key creation"}),": Upon authorization:"]}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"API key is created with approved scopes"}),"\n",(0,r.jsx)(n.li,{children:"Key is displayed to the user"}),"\n",(0,r.jsxs)(n.li,{children:["If ",(0,r.jsx)(n.code,{children:"redirect_uri"})," is provided, user is redirected back with the key"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.li,{children:["\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.strong,{children:"Callback"}),": App receives the API key:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"https://myapp.com/callback?api_key=xxx&state=abc123\n"})}),"\n"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"query-parameters",children:"Query Parameters"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"name"})," (required): Name of the requesting application"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"description"})," (optional): Description of the application"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"scopes"})," (required): Comma-separated list of requested scopes"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"redirect_uri"})," (optional): URL to redirect after authorization"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"state"})," (optional): Opaque value for maintaining state"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"scope-format",children:"Scope Format"}),"\n",(0,r.jsxs)(n.p,{children:["Scopes follow the pattern: ",(0,r.jsx)(n.code,{children:"resource:action"})]}),"\n",(0,r.jsx)(n.h3,{id:"examples",children:"Examples:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"docker:read"})," - Read access to Docker"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"vm:*"})," - Full access to VMs"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"system:update"})," - Update access to system"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"role:viewer"})," - Viewer role access"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"role:admin"})," - Admin role access"]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"available-resources",children:"Available Resources:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"docker"}),", ",(0,r.jsx)(n.code,{children:"vm"}),", ",(0,r.jsx)(n.code,{children:"system"}),", ",(0,r.jsx)(n.code,{children:"share"}),", ",(0,r.jsx)(n.code,{children:"user"}),", ",(0,r.jsx)(n.code,{children:"network"}),", ",(0,r.jsx)(n.code,{children:"disk"}),", etc."]}),"\n"]}),"\n",(0,r.jsx)(n.h3,{id:"available-actions",children:"Available Actions:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"create"}),", ",(0,r.jsx)(n.code,{children:"read"}),", ",(0,r.jsx)(n.code,{children:"update"}),", ",(0,r.jsx)(n.code,{children:"delete"})," or ",(0,r.jsx)(n.code,{children:"*"})," for all"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"security-considerations",children:"Security Considerations"}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"HTTPS required"}),": Redirect URIs must use HTTPS (except localhost for development)"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"User consent"}),": Users explicitly approve each permission"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"Session-based"}),": Uses existing Unraid authentication session"]}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.strong,{children:"One-time display"}),": API keys are shown once and must be saved securely"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"example-integration",children:"Example Integration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-javascript",children:"// JavaScript example\nconst unraidServer = 'tower.local';\nconst appName = 'My Docker Manager';\nconst scopes = 'docker:*,system:read';\nconst redirectUri = 'https://myapp.com/unraid/callback';\nconst state = generateRandomState();\n\n// Store state for verification\nsessionStorage.setItem('oauth_state', state);\n\n// Redirect user to authorization page\nwindow.location.href =\n    `https://${unraidServer}/ApiKeyAuthorize?` +\n    `name=${encodeURIComponent(appName)}&` +\n    `scopes=${encodeURIComponent(scopes)}&` +\n    `redirect_uri=${encodeURIComponent(redirectUri)}&` +\n    `state=${encodeURIComponent(state)}`;\n\n// Handle callback\nconst urlParams = new URLSearchParams(window.location.search);\nconst apiKey = urlParams.get('api_key');\nconst returnedState = urlParams.get('state');\n\nif (returnedState === sessionStorage.getItem('oauth_state')) {\n    // Save API key securely\n    saveApiKey(apiKey);\n}\n"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>o});var i=s(6540);const r={},t=i.createContext(r);function c(e){const n=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),i.createElement(t.Provider,{value:n},e.children)}}}]);