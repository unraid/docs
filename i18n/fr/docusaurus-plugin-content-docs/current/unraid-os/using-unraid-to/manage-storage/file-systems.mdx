---
sidebar_position: 4
sidebar_label: Systèmes de fichiers
---

# Systèmes de fichiers

## Sélection d'un type de système de fichiers

Sélectionner le bon système de fichiers pour votre %%array|array%% Unraid ou %%cache pool|cache-pool%% est crucial. Cela vous aide à obtenir un équilibre entre performance, protection des données et fonctionnalités avancées. Unraid supporte plusieurs systèmes de fichiers modernes Linux, chacun avec ses propres forces uniques et cas d'utilisation spécifiques.

| Système de fichiers | Protection des données                                                                | Efficacité de l'espace                  | Fonctionnalités avancées                                         | Meilleur cas d'utilisation                                        |
| ------------------- | ------------------------------------------------------------------------------------- | --------------------------------------- | ---------------------------------------------------------------- | ----------------------------------------------------------------- |
| %%XFS\|xfs%%        | Aucune redondance intégrée                                                            | 100 %                                   | Résistant à la corruption                                        | Par défaut pour les disques d'une baie ; haute fiabilité          |
| EXT4                | Aucune redondance intégrée                                                            | 100 %                                   | Mature, stable, journaled                                        | Lecteurs en réseau ou pools à un seul disque ; alternative au XFS |
| %%ZFS\|zfs%%        | %%RAIDZ1\|raidz1%%/%%RAIDZ2\|raidz2%%/%%RAIDZ3\|raidz3%%, miroirs, etc.               | Varie selon le niveau de %%RAID\|raid%% | %%Checksums\|checksum%%, %%Snapshots\|snapshot%%, %%RAID\|raid%% | Baies multi-appareils, %%VMs\|vm%%, Docker, utilisateurs avancés  |
| %%BTRFS\|btrfs%%    | %%RAID 0\|raid0%%/%%RAID 1\|raid1%%/%%10\|raid10%%/%%5\|raid5%%/%%6\|raid6%%, miroirs | Varie selon le niveau de %%RAID\|raid%% | %%Checksums\|checksum%%, %%Snapshots\|snapshot%%, %%RAID\|raid%% | Baies multi-appareils, mélange SSD/HDD, baies flexibles           |
| NTFS                | Aucune redondance intégrée                                                            | 100 %                                   | Compatibilité Windows                                            | Ajouter des lecteurs Windows existants sans migration des données |
| exFAT               | Aucune redondance intégrée                                                            | 100 %                                   | Compatibilité multiplateforme                                    | Ajout de lecteurs exFAT existants sans migration des données      |

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import FsCheckCliXfs from './partials/fs-check-cli-xfs.mdx';
import FsCheckCliBtrfs from './partials/fs-check-cli-btrfs.mdx';
import FsCheckCliZfs from './partials/fs-check-cli-zfs.mdx';
import FsRepairCliXfs from './partials/fs-repair-cli-xfs.mdx';
import FsRepairCliBtrfs from './partials/fs-repair-cli-btrfs.mdx';
import FsRepairCliZfs from './partials/fs-repair-cli-zfs.mdx';

### XFS

%%XFS|xfs%% est le système de fichiers par défaut pour les lecteurs %%array|array%% dans Unraid. Il est reconnu pour sa robustesse et sa capacité à récupérer de la corruption après des arrêts imprévus ou des crashs. Chaque lecteur formaté avec %%XFS|xfs%% fonctionne comme un système de fichiers autonome, rendant la récupération de données directe sur tout système Linux.

- **Protection des données :** Pas de redondance intégrée ; s'appuie sur la %%parité|parity%% d'Unraid pour la protection.
- **Performance :** Cohérent et fiable.
- **Meilleur pour :** Disques %%Array|array%%, surtout lorsque la stabilité et la facilité de récupération de données sont des priorités.

### EXT4

EXT4 est un système de fichiers mature et stable offrant une excellente compatibilité et fiabilité. Il est entièrement pris en charge et se mesure à %%XFS|xfs%%, %%BTRFS|btrfs%% et %%ZFS|zfs%%, ce qui en fait un excellent choix pour les lecteurs en réseau ou les pools à un seul disque.

- **Protection des données :** Il ne dispose pas de redondance intégrée et dépend de la %%parity|parité%% d'Unraid pour la protection.
- **Performance :** Il offre des performances constantes et fiables avec le journalisation pour garantir l'intégrité des données.
- **Best for:** %%Array|array%% drives or single-drive pools when you are looking for an alternative to %%XFS|xfs%%.

### ZFS

%%ZFS|zfs%% est un système de fichiers moderne doté de fonctionnalités avancées comme les %%checksums|somme de contrôle%% pour détecter la %%bit rot|bit-rot%%, les %%snapshots|instantanés%% pour les sauvegardes, et un support natif pour les options de %%RAID|raid%% telles que %%RAIDZ1|raidz1%%/%%RAIDZ2|raidz2%%/%%RAIDZ3|raidz3%% et miroirs. %%ZFS|zfs%% peut être utilisé pour des pools à un seul dispositif ou multidispositifs.

- **Protection des données :** Supporte divers niveaux de %%RAID|raid%% pour la redondance.
- **Performance :** Excellent, en particulier pour les pools multi-appareils.
- **Idéal pour :** environnements haute performance, %%virtual machines|machines virtuelles%%, Docker, ou lorsqu'il est nécessaire d'utiliser des fonctionnalités avancées comme les %%snapshots|instantanés%%.

Pour une orientation complète sur les fonctionnalités de %%ZFS|zfs%%, la configuration et les meilleures pratiques, consultez la page dédiée au [stockage ZFS](../../advanced-configurations/optimize-storage/zfs-storage.mdx).

### BTRFS

%%BTRFS|btrfs%% offre un support %%RAID|raid%% flexible, des %%checksums|checksum%% pour l'intégrité des données, et une gestion efficace des lecteurs de tailles mixtes dans les pools. Il sert de système de fichiers par défaut pour les %%cache pools|cache-pool%% et prend en charge les configurations à un ou plusieurs dispositifs.

- **Protection des données :** Supporte %%RAID 0|raid0%%/%%1|raid1%%/%%10|raid10%%/%%5|raid5%%/%%6|raid6%% (notez que %%RAID 5|raid5%%/%%6|raid6%% sont encore expérimentaux).
- **Performance :** Bonne, avec flexibilité pour l'expansion et la contraction.
- **Meilleur pour :** %%Cache pools|cache-pool%%, surtout si vous prévoyez de mélanger des SSD et HDD ou avez besoin d'un moyen facile d'étendre.

### NTFS et exFAT (support limité)

Les systèmes de fichiers NTFS et exFAT sont pris en charge avec certaines limitations. Cela sert principalement à vous aider à ajouter les lecteurs existants avec des données à votre système Unraid sans avoir besoin de transférer les données ailleurs au préalable.

:::warning

Les lecteurs formatés en NTFS ou exFAT doivent être ajoutés à l'%%array|array%% **avant** d'ajouter des lecteurs de parité. Une fois qu'un lecteur de parité est ajouté à votre %%array|array%%, tous les nouveaux lecteurs de données que vous ajoutez seront effacés, indépendamment du format de leur système de fichiers.

Si vous souhaitez utiliser des lecteurs NTFS ou exFAT existants :

- Ajoutez-les d'abord à l'%%array|array%% (ou exécutez ***Outils → Nouvelle Config*** pour réinitialiser la configuration de votre array).
- Après avoir ajouté vos lecteurs de données NTFS/exFAT, vous pouvez ensuite ajouter des lecteurs de parité.
- Les données existantes sur ces lecteurs seront préservées et protégées par la parité.

:::

- **Protection des données :** Ces lecteurs n'offrent pas de redondance intégrée ; ils dépendent de la %%parity|parité%% d'Unraid pour la protection dès que la parité est ajoutée.
- **Performance :** Adéquat pour les besoins de stockage de base.
- **Idéal pour :** Ajouter des lecteurs formatés pour Windows (NTFS) ou formatés multiplateformes (exFAT) sans besoin de migration des données. Ils peuvent également être utilisés pour des pools à un seul disque.
- **Limitations :** Ces systèmes de fichiers ne sont pas recommandés pour une utilisation régulière ; ils sont principalement destinés à la migration de lecteurs existants. Pour de nouveaux lecteurs, envisagez d'utiliser %%XFS|xfs%%, EXT4, %%BTRFS|btrfs%% ou %%ZFS|zfs%% à la place.

Pour plus de détails sur l'ajout de lecteurs existants, consultez les [notes de version](../../release-notes/7.2.0.md#ext234-ntfs-and-exfat-support).

:::note[Additional Notes]

- Mélanger différents types de systèmes de fichiers dans votre système Unraid est tout à fait acceptable ; le système de %%parité|parity%% d'Unraid fonctionne indépendamment du système de fichiers utilisé.
- Formatez toujours et partitionnez les disques dans Unraid pour assurer la compatibilité.
- Les systèmes Linux peuvent lire ces systèmes de fichiers nativement ; cependant, Windows et macOS nécessitent des logiciels supplémentaires pour y accéder.
- Vous pouvez **crypter** les lecteurs pour une sécurité accrue, mais gardez à l'esprit que les lecteurs cryptés peuvent poser des défis pour la récupération en cas de corruption.
- Pour les disques de transfert ou les appareils externes, il est recommandé d'utiliser le plugin **[Unassigned Devices](#using-the-unassigned-devices-plugins)**, qui prend en charge des systèmes de fichiers supplémentaires.
  :::

:::

:::tip[Still besoin d'aide pour choisir?

- **Pour les lecteurs array :** %%XFS|xfs%% est généralement le meilleur choix pour la plupart des utilisateurs. L'EXT4 est également une option solide si vous préférez un système de fichiers Linux plus traditionnel.
- **Pour des performances élevées ou des fonctionnalités avancées :** Choisissez %%ZFS|zfs%% ou %%BTRFS|btrfs%% pour des %%cache pools|cache-pool%% ou des configurations multi-dispositifs. Consultez la page de [stockage ZFS](../../advanced-configurations/optimize-storage/zfs-storage.mdx) pour une orientation détaillée sur %%ZFS|zfs%%.
- **Pour les baies mixtes ou en expansion :** %%BTRFS|btrfs%% est idéal si vous voulez utiliser différentes tailles de disques ou ajouter ou retirer facilement des appareils.
- **Pour les lecteurs existants :** Utilisez NTFS ou exFAT uniquement lors de l'ajout de lecteurs existants avec des données ; ajoutez-les avant d'ajouter la parité.

Si vous êtes incertain, commencer avec les paramètres par défaut est une bonne approche : utilisez %%XFS|xfs%% pour les disques %%array|array%% et %%BTRFS|btrfs%% pour les %%cache pools|cache-pool%%.

:::

---

## Définir un type de système de fichiers

Lors de l'ajout d'un nouveau disque à Unraid, vous pouvez sélectionner le type de système de fichiers qui correspond le mieux à vos besoins. Le système de fichiers détermine comment les données sont organisées et protégées sur le disque.

Pour définir le type de système de fichiers de manière globale, allez dans ***Paramètres → Paramètres des Disques*** pour définir le système de fichiers par défaut pour les nouveaux lecteurs %%array|array%% uniquement. Unraid utilise par défaut %%XFS|xfs%% pour les lecteurs %%array|array%%.

:::note

Il n'existe actuellement aucune configuration par défaut globale pour les %%cache pools|cache-pool%%. Ils sont toujours par défaut en %%BTRFS|btrfs%% si laissés sur "auto".

:::

:::important

Si vous ajoutez des lecteurs contenant des données NTFS ou exFAT existantes, ils doivent être ajoutés à l'%%array|array%% avant tout ajout de lecteurs de parité. Une fois la parité présente, tous les nouveaux lecteurs de données ajoutés seront vidés, quelle que soit leur forme de système de fichiers.

:::

Pour définir le système de fichiers pour un lecteur individuel :

1. Arrêtez l'%%array|array%% avant de procéder aux changements.
2. Dans l'onglet **Principal**, cliquez sur le lecteur que vous souhaitez configurer.
3. Sélectionnez le type de système de fichiers souhaité dans le menu déroulant.
4. (Optionnel) Si vous sélectionnez **auto**, Unraid utilise le défaut global.
5. Pour les %%cache pools|cache-pool%% multi-appareils, seuls %%BTRFS|btrfs%% ou %%ZFS|zfs%% sont pris en charge.
6. Si vous ajoutez des lecteurs de données NTFS ou exFAT existants à l'%%array|array%%, ajoutez-les avant d'ajouter des lecteurs de parité.

---

## Création d'un système de fichiers (formatage)

Avant d'utiliser un nouveau disque dans Unraid, vous devez le formater avec le système de fichiers sélectionné.

:::warning

Le formatage effacera tout le contenu existant du lecteur. Assurez-vous d'avoir sauvegardé toutes les données importantes avant de continuer.

:::

Pour formater un lecteur :

1. Démarrez l’%%array|array%%.
2. Identifiez les lecteurs non montables (ils apparaissent comme **non montables**).
3. Vérifiez que tous les lecteurs non montables sont ceux que vous souhaitez formater.
4. Cochez la case de confirmation, lisez la boîte de dialogue d'avertissement, et cliquez sur **Format**.
5. Surveillez le processus. Pour les nouveaux disques, Unraid réécrit d'abord la table de partitions.
6. Attendez la fin du processus. Si le progrès stagne, rafraîchissez l'onglet **Principal**.

Une fois le formatage terminé, le disque est prêt à stocker des fichiers.

---

## Changer un type de système de fichiers

Vous pourriez vouloir changer le type de système de fichiers sur un disque spécifique pour profiter de nouvelles fonctionnalités ou pour assurer la compatibilité avec vos autres disques.

:::warning

Changer le type de système de fichiers **effacera toutes les données existantes** sur le disque. Pensez toujours à sauvegarder les fichiers importants avant de commencer.

:::

Pour changer le type de système de fichiers sur un disque particulier :

1. Arrêtez le %%array|array%%.
2. Dans l'onglet **Principal**, cliquez sur le lecteur que vous souhaitez modifier.
3. Choisissez le nouveau système de fichiers dans la liste déroulante (répétez pour plusieurs lecteurs si nécessaire).
4. Démarrez l’%%array|array%%.
5. Dans l'onglet **Principal**, examinez la liste des lecteurs non montables et assurez-vous que seuls les lecteurs prévus sont inclus.
6. Cochez la case de confirmation et cliquez sur **Format**.
7. Attendez la fin du processus. Si le statut ne se met pas à jour, rafraîchissez l'onglet **Principal**.

Si vous rencontrez des problèmes, n'hésitez pas à visiter les [forums Unraid](https://forums.unraid.net/). Joignez votre fichier de diagnostic système zip (trouvé sous ***Outils → Diagnostics***) pour obtenir de l'aide.

---

## Conversion vers un nouveau type de système de fichiers

:::important

La page ***Principal*** avertira si des lecteurs array ou pool sont formatés avec des systèmes de fichiers hérités :

- Tous les lecteurs formatés en ReiserFS doivent être migrés vers un autre système de fichiers dès que possible, car ils ne seront pas utilisables dans les versions futures d'Unraid.
- Tous les lecteurs formatés avec des versions plus anciennes de XFS doivent être migrés avant 2030.

:::

Ce processus est particulièrement courant pour les utilisateurs passant du ReiserFS obsolète (utilisé dans les anciennes versions d'Unraid) au %%XFS|xfs%% ou au %%BTRFS|btrfs%%, mais il s'applique à toute conversion de système de fichiers.

:::important

Ce processus nécessite de déplacer temporairement vos données vers un autre emplacement. Assurez-vous d'avoir suffisamment d'espace libre ailleurs dans votre %%array|array%% ou sur un appareil externe avant de commencer.

:::

Reformater un lecteur dans Unraid effacera toutes vos données et créera un nouveau système de fichiers vide. Ce processus est utile pour résoudre les erreurs de système de fichiers persistantes ou pour repartir à zéro avec un nouveau format.

1. Déplacez toutes les données du lecteur vers un autre emplacement (un autre lecteur %%array|array%%, %%cache pool|cache-pool%% ou une sauvegarde externe). Utilisez l'une de ces méthodes :

   **Via le WebGUI :**

   - Naviguez vers ***Principal → Opération de la matrice*** et arrêtez la matrice.
   - Naviguez vers ***Paramètres → Paramètres de partage global***. Dans la zone **Vider disque(s)**, sélectionnez le(s) disque(s) à vider et **Appliquer**. Note : ce statut sera automatiquement supprimé lorsque la matrice est arrêtée.
   - Naviguez vers ***Principal → Opération de la matrice*** et démarrez la matrice.
   - Sur ***Principal → Opération de la matrice*** cliquez sur **Déplacer** (ou attendez que le mover s'exécute selon son calendrier normal).
   - Mover vide le disque selon vos paramètres de partage. Notez que les fichiers à la racine du lecteur sont en dehors de tout partage et ne seront pas déplacés.
   - Vérifiez ***Outils → Journal du système*** pour les messages concernant les fichiers qui n'ont pas pu être déplacés en raison d'une utilisation ou d'un manque d'espace libre.

   **Ou via la ligne de commande :**

   - Déplacer les fichiers [en utilisant le 'mover' pour vider un disque de la matrice](../../release-notes/7.0.0.md#using-mover-to-empty-an-array-disk) vers les autres lecteurs de la matrice

   **Ou manuellement :**

   - Déplacez les fichiers manuellement vers un autre emplacement

   Une fois terminé, naviguez vers ***Principal → Appareils Array*** et parcourez le disque pour confirmer qu'il est vide. Continuez seulement lorsque vous êtes certain que le disque est vide.
2. Suivez la procédure pour [changer un type de système de fichiers](#changing-a-file-system-type). Cela formate le disque et efface tout le contenu, laissant un disque vide dans le nouveau format.
3. (Optionnel) Déplacez vos données vers le disque nouvellement formaté, selon où vous avez déplacé les fichiers.
4. Si vous avez plusieurs lecteurs à convertir, répétez ces étapes pour chaque lecteur.

:::note\[Timing]

Le processus peut prendre plusieurs heures, en fonction de la quantité de données et de la vitesse de vos lecteurs. La majeure partie du temps est consacrée à la copie des fichiers, qui peut être effectuée sans surveillance.

:::

---

## Reformatage d'un disque

Reformater un lecteur dans Unraid effacera toutes vos données et créera un nouveau système de fichiers vide. Ce processus est utile pour résoudre les erreurs de système de fichiers persistantes ou pour repartir à zéro avec un nouveau format.

:::warning

Le reformatage effacera définitivement toutes les données sur le lecteur. Sauvegardez toujours les fichiers importants avant de commencer.

:::

Pour reformater **en toute sécurité** votre disque :

1. **Arrêtez la matrice**.
2. **Changez le type de système de fichiers** :
   - Allez à l'onglet **Principal** et cliquez sur le disque que vous souhaitez reformater.
   - Sélectionnez un type de système de fichiers différent (par exemple, changez de %%XFS|xfs%% à %%BTRFS|btrfs%%).
   - Démarrez le %%array|array%%, et le disque s'affichera comme **non montable**.
   - Lorsque vous y êtes invité, formatez le disque.
3. **(Optionnel) Revenez à votre type de système de fichiers d'origine** :
   - Arrêtez à nouveau le %%array|array%%.
   - Changez le système de fichiers à votre type préféré.
   - Démarrez le %%array|array%% et formatez à nouveau le disque.

Ce processus simple garantit que le lecteur est complètement effacé et formaté comme vous le souhaitez. Le processus de formatage prend généralement juste quelques minutes.

### Reformatage d'un disque cache

Parfois, il est nécessaire de reformater un disque %%cache|cache%% pour les raisons suivantes :

- Pour changer le type de système de fichiers (par exemple, de %%BTRFS|btrfs%% à %%XFS|xfs%% ou vice versa)
- Pour corriger des erreurs persistantes du système de fichiers
- Pour démarrer à neuf pour de nouvelles charges de travail

#### Préparation

Avant de reformater, préparez votre système :

1. Arrêtez le %%array|array%%.
2. Allez dans **Paramètres** et désactivez les services Docker et %%VM|vm%% (cela empêche leurs onglets d'apparaître pendant le processus).
3. Démarrez de nouveau l'%%array|array%%.

#### Déplacer les données hors du cache

Pour déplacer les données hors du cache :

1. Définir le stockage partagé et l'action du Mover (cache → matrice) :
   - Allez dans l'onglet **Partages**.
   - Pour chaque partage avec des fichiers dans le %%cache|cache%%, définissez le **stockage principal** sur la source du pool %%cache|cache%% et le **stockage secondaire** sur l'%%array|array%%.
   - Définissez **Action du Mover** sur **cache → tableau**.
   - Notez les partages que vous avez modifiés et leurs paramètres d'origine.
2. Dans l'onglet **Principal**, cliquez sur **Déplacer maintenant** et attendez la fin du processus. Assurez-vous que le %%cache|cache%% est vide.
   - Si des fichiers restent, arrêtez et consultez les forums pour obtenir de l'aide.

#### Reformater le lecteur de cache

Maintenir vos pools %%BTRFS|btrfs%% dans Unraid est essentiel pour assurer leur bon fonctionnement et la sécurité de vos données. Deux outils clés que vous voudrez utiliser régulièrement sont **Balance** et **Scrub**. Ces opérations aident à résoudre les problèmes d'allocation d'espace, à optimiser l'utilisation de votre stockage, et à protéger vos données contre la corruption cachée.

1. Arrêtez le %%array|array%%.
2. Définir le format du lecteur de cache :
   - Dans l'onglet **Principal**, cliquez sur le lecteur de cache.
   - Choisissez entre %%XFS|xfs%%, EXT4 ou %%BTRFS|btrfs%%.
   - Pour un %%cache|cache%% à un seul disque, %%XFS|xfs%% ou EXT4 sont recommandés.
   - Notez que %%XFS|xfs%% et EXT4 sont disponibles uniquement avec un seul emplacement %%cache|cache%%.
3. Démarrez l’%%array|array%%.
4. Formater le lecteur de cache :
   - Confirmer que seul le lecteur %%cache|cache%% est listé comme non montable.
   - Cochez la case de confirmation et cliquez sur **Format**.

#### Restaurer les données et les paramètres

Pour restaurer les données et les paramètres :

1. Pour chaque partage que vous avez modifié, réinitialisez le **stockage principal** et le **stockage secondaire** à leurs valeurs d'origine.
2. Déplacez les données en retour (matrice → cache) :
   - Pour chaque partage que vous avez modifié, réglez le **stockage principal** sur le pool de destination %%cache|cache%% et le **stockage secondaire** sur l'%%array|array%%.
   - Définissez **Action du Mover** sur **array → cache**.
   - Dans l'onglet **Principal**, cliquez sur **Déplacer maintenant** pour déplacer les données vers le %%cache|cache%%.
3. Arrêtez le %%array|array%%.
4. Allez dans **Paramètres** et réactivez les services Docker et %%VM|vm%%.
5. Démarrez l'%%array|array%% pour terminer le processus.

:::note\[Timing]

Le temps nécessaire pour déplacer les données avec le **Mover** et formater le disque peut varier de plusieurs minutes à plusieurs heures, selon la quantité de données et la vitesse du disque.

:::

---

## Opérations BTRFS

Maintenir vos pools %%BTRFS|btrfs%% dans Unraid est essentiel pour assurer leur bon fonctionnement et la sécurité de vos données. Deux outils clés que vous voudrez utiliser régulièrement sont **Balance** et **Scrub**. Ces opérations aident à résoudre les problèmes d'allocation d'espace, à optimiser l'utilisation de votre stockage, et à protéger vos données contre la corruption cachée.

Décomposons ce que chaque opération fait et quand les utiliser :

### Équilibre

L'opération **Balance** redistribue des morceaux de données et de métadonnées à travers votre pool %%BTRFS|btrfs%%. Ce processus aide à libérer de l'espace, résout les problèmes d'allocation et peut corriger les erreurs "plus d'espace disponible" même lorsque de l'espace semble être disponible.

#### Quand exécuter le Balance

- Lorsque vous rencontrez des erreurs "plus d'espace disponible" mais que vous avez de l'espace libre.
- Après avoir ajouté ou retiré des disques dans un pool.
- Pour optimiser l'utilisation de l'espace et améliorer les performances.

#### Comment exécuter le Balance

1. Dans le %%WebGUI|web-gui%%, cliquez sur le pool dans l'onglet **Principal** et sélectionnez **Balance**.
2. (Optionnel) Ajoutez des paramètres pour des usages avancés (reportez-vous à l'aide d'Unraid pour en savoir plus).
3. Cliquez sur **Démarrer** pour commencer.

:::note\[Timing]

Les opérations de Balance peuvent prendre de quelques minutes à plusieurs heures, selon la taille du pool et la quantité de données.

:::

### Nettoyer

L'opération **Scrub** lit toutes les données et métadonnées, vérifie l'intégrité des sommes de contrôle et répare les blocs corrompus en utilisant les copies redondantes disponibles. Le nettoyage aide à identifier et à corriger la corruption silencieuse des données, connue sous le nom de "bit rot", avant que cela ne devienne un problème important.

#### Quand exécuter le Scrub

- Dans le cadre de la maintenance régulière (voir le programme recommandé ci-dessous).
- Après des arrêts imprévus ou si vous suspectez une corruption.
- Plus fréquemment sur les pools à utilisation intensive.

#### Calendrier recommandé

- Pools à utilisation intensive : **Une fois par semaine**
- Tous les autres pools : **Une fois par mois**

#### Comment exécuter le Scrub

1. Dans le %%WebGUI|web-gui%%, cliquez sur le pool dans l'onglet **Principal** et sélectionnez **Scrub**.
2. Cliquez sur **Démarrer** pour initier le processus.

:::note\[Timing]

Les opérations de vérification sont généralement plus rapides qu'une analyse complète du disque car elles ne vérifient que les données allouées. En fonction de la taille et de l'utilisation du pool, cela peut prendre de quelques minutes à quelques heures.

:::

:::tip

Tant **Balance** que **Scrub** peuvent être effectués pendant que le système est en ligne, mais gardez à l'esprit que la performance peut être affectée pendant ces opérations. Vous pouvez surveiller l'avancement dans le %%WebGUI|web-gui%%.

:::

Pour plus de détails sur les fonctionnalités avancées %%BTRFS|btrfs%%, consultez [la documentation officielle BTRFS](https://btrfs.readthedocs.io/en/latest/Introduction.html).

---

## Disques non assignés

Les lecteurs non assignés sont des dispositifs de stockage connectés à votre serveur Unraid qui ne font pas partie de l'%%array|array%% principal ou de tout %%cache pool|cache-pool%%. Vous pouvez utiliser ces lecteurs pour transférer des fichiers, créer des backups, ou fournir un stockage rapide pour des %%machines virtuelles|vm%%.

:::note

All drives connected to your server when the %%array|array%% starts count toward your Unraid Attached Devices license limit, even if they aren't assigned to the %%array|array%% or a pool.

:::

### Utilisations courantes pour les disques non assignés

- Connectez des disques amovibles pour des transferts de fichiers ou des sauvegardes faciles.
- Utilisez des disques dédiés pour des tâches haute performance comme exécuter des machines virtuelles ou pour du stockage temporaire de données.

### Utilisation des plugins Unassigned Devices

Pour tirer le meilleur parti de vos disques non assignés, envisagez d'installer les plugins suivants depuis l'onglet **Apps** :

- **[Périphériques non attribués](https://unraid.net/community/apps?q=dlandon\&r=0#:~:text=and%20iso%20files.-,Unassigned%20Devices,-dlandon):** Ce plugin vous permet de monter, partager et gérer des disques avec des systèmes de fichiers pris en charge par Unraid, comme %%XFS|xfs%%, %%BTRFS|btrfs%% ou NTFS.

- **[Unassigned Devices Plus](https://unraid.net/community/apps?q=dlandon\&r=0#:~:text=and%20iso%20files.-,Unassigned%20Devices%20Plus,-\(Addon\))** : Cette extension élargit vos options en supportant des systèmes de fichiers supplémentaires, y compris ExFAT et HFS+.

Ces plugins permettent :

- De monter et démonter facilement des disques depuis l'interface web d'Unraid.
- Partager vos disques non assignés sur le réseau.
- D'automatiser le montage lors du démarrage du serveur.
- De formater ou d'effacer des disques pour une utilisation future.
- De déconnecter en toute sécurité les disques USB ou externes sans tracas.

Pour plus de détails sur l'installation et la gestion des plugins, consultez [Plugins](../customize-your-experience/plugins.mdx).

---

## Dépannage

### Le disque apparaît comme non montable

Si vous voyez qu'un disque dans Unraid est **non montable**, cela peut être dû à deux raisons principales :

1. Si vous venez d'ajouter un nouveau lecteur à votre installation, il apparaîtra comme non montable jusqu'à ce que vous le formatiez. Le formatage crée un système de fichiers qui permet au lecteur de stocker des fichiers. Vous pouvez trouver les étapes pour formater un lecteur [ici](#creating-a-file-system-formatting).

2. Si un lecteur qui fonctionnait précédemment montre soudainement un état non montable, il y a probablement un problème de système de fichiers. Cela peut se produire en raison d'arrêts inattendus, de problèmes d'écriture de données, ou si le lecteur a été marqué comme désactivé (ce qui apparaît comme un 'x' rouge dans le %%WebGUI|web-gui%%).

:::important

Do not format an unmountable drive unless you are okay with losing all the data on it. Formatting will erase everything and update the %%parity|parity%% information, making recovery impossible. Always try to fix the file system first.

:::

Si votre disque est non montable :

1. Déterminez s'il s'agit d'un nouveau lecteur ou d'un lecteur qui fonctionnait déjà.
2. Pour les nouveaux lecteurs : formatez le lecteur pour créer un nouveau système de fichiers (voir [étapes de formatage](#creating-a-file-system-formatting)).
3. Pour les lecteurs qui fonctionnaient déjà : effectuez une vérification ou une réparation du système de fichiers (voir [Vérification d'un système de fichiers](#checking-a-file-system)). Évitez le formatage si vous souhaitez conserver les données.

:::note

Si un lecteur est à la fois non montable et désactivé ('x' rouge), exécutez d'abord la vérification/réparation du système de fichiers sur le lecteur **émulé**. Si le lecteur émulé est également non montable et que vous tentez de le reconstruire, le nouveau lecteur sera également non montable.

:::

À partir d'Unraid 7.0, la réparation du système de fichiers XFS est maintenant entièrement automatisée via le WebGUI :

:::important[Why la parité n'est-elle pas suffisante?]

Bien que la %%parité|parity%% aide à récupérer un disque défectueux, elle ne peut pas résoudre les problèmes de système de fichiers. Si le système de fichiers est corrompu, la %%parité|parity%% ne fera que reproduire cette corruption sur le nouveau disque.

Si vous n'êtes pas sûr :

- Téléchargez les journaux de votre système en naviguant vers **Outils → Diagnostiques**.
- Pour une assistance experte, postez votre problème ainsi que les diagnostics sur les [forums d'Unraid](https://forums.unraid.net/).

:::

:::note[Just pour réitérer]

- Ne formatez que les disques non montables s'ils sont neufs ou si vous souhaitez effacer toutes les données.
- Utilisez la vérification/réparation du système de fichiers pour corriger les fichiers corrompus ; ne comptez pas sur la %%parité|parity%% pour résoudre ces problèmes.
- Pour les %%cache pools|cache-pool%% avec plusieurs disques, envisagez d'utiliser soit le %%BTRFS|btrfs%% soit le %%ZFS|zfs%%.
- Vérifiez toujours avant de formater ou de réparer des disques pour éviter la perte accidentelle de données.

:::

---

### Vérifier un système de fichiers

Si un disque qui montait sans problème auparavant montre maintenant comme **non montable**, cela indique généralement une corruption du système de fichiers. Cela peut résulter d'un arrêt inapproprié, d'une opération d'écriture échouée, ou du disque étant marqué comme désactivé dans le %%WebGUI|web-gui%%. Vérifier et réparer le système de fichiers est généralement plus rapide et plus sûr que de reconstruire, il est donc conseillé d'essayer cela avant de formater ou reconstruire le disque.

:::important

Si le %%WebGUI|web-gui%% suggère de formater un lecteur non montable, **ne formatez pas** sauf si vous avez l'intention d'effacer toutes les données. Le formatage détruira le contenu du lecteur et mettra à jour la %%parity|parité%%, rendant la récupération impossible.

:::

#### Préparer à vérifier ou réparer

1. Identifiez le type de système de fichiers :
   - Dans l'onglet **Principal**, sélectionnez votre disque (par exemple, Disque 3, Cache).
   - Trouvez le **type de système de fichiers** (devrait être %%XFS|xfs%%, EXT4, %%BTRFS|btrfs%%, ou %%ZFS|zfs%%).

2. Démarrez la matrice en mode correct :
   - Pour **%%XFS|xfs%%** ou **EXT4**, démarrez l'%%array|array%% en **mode de maintenance**.
   - Pour **%%BTRFS|btrfs%%**, démarrez l'%%array|array%% en **mode normal** pour un %%scrub|scrub%% ou en **mode maintenance** pour une réparation.
   - Pour **ZFS**, référez-vous à la section **ZFS** ci-dessous.

3. If the disk is disabled and being emulated, run the check/repair on the %%emulated disk|emulated-disk%% before attempting a rebuild. If the %%emulated disk|emulated-disk%% is unmountable, the rebuilt disk will also be unmountable.

#### Messages d'erreur courants

| Message                                                                 | Signification / Action                                                                |
| ----------------------------------------------------------------------- | ------------------------------------------------------------------------------------- |
| **Superblock a un mauvais nombre magique**                              | Corruption sévère; tentez une réparation du système de fichiers.                      |
| **Système de fichiers est sale**                                        | Arrêt non net ; effectuez une vérification du système de fichiers.                    |
| **Corruption de métadonnées détectée**                                  | Les structures du système de fichiers sont endommagées ; initier une réparation.      |
| **Aucun %%BTRFS\|btrfs%% valide trouvé**                                | Le disque peut ne pas appartenir à un pool valide; vérifiez les assignations de pool. |
| **Montage: mauvais type fs, mauvaise option, etc.**                     | Sélection incorrecte du système de fichiers ou disque non formaté.                    |
| **Impossible de monter /dev/mdX: La structure a besoin d'un nettoyage** | Le système de fichiers est corrompu; effectuez une réparation.                        |

#### Vérification via le WebGUI

1. Start the %%array|array%% in the correct mode (refer to the steps above).
2. Dans l'onglet **Principal**, sélectionnez le disque que vous souhaitez vérifier.
3. Accédez à **Vérifier l'état du système de fichiers**.
4. Pour XFS : Vous verrez un bouton **VÉRIFIER** sans options à entrer. Le système détermine automatiquement les actions nécessaires en fonction des résultats de la vérification.
5. Pour les autres systèmes de fichiers : entrez les options nécessaires (pour plus de détails, consultez **Aide** en haut à droite).
6. Cliquez sur **Vérifier** pour lancer le processus.
7. Suivez l'avancement dans la boîte de sortie. Utilisez **Rafraîchir** si nécessaire.
8. Examinez les résultats. En cas d'incertitude, copiez la sortie et postez-la sur les [forums](https://forums.unraid.net/) pour obtenir des conseils.

#### Workflow automatique de réparation du système de fichiers XFS

La réparation du système de fichiers XFS est entièrement automatisée via le WebGUI :

1. Cliquez sur le bouton **VÉRIFIER** (sans options à entrer)
2. Vérifiez les résultats :
   - **Aucune corruption détectée** : Affiche "aucune corruption du système de fichiers détectée" et le bouton **VÉRIFIER** reste
   - **Corruption détectée** : Affiche "corruption du système de fichiers détectée" et un bouton **RÉPARER** apparaît
3. Cliquez sur **RÉPARER** pour réparer automatiquement le système de fichiers
4. Si nécessaire, un bouton **EFFACER LE JOURNAL** peut apparaître
5. Montre "système de fichiers réparé" lorsque le processus est terminé

Ce système automatisé élimine le besoin pour les utilisateurs d'entrer manuellement des options de réparation et garantit que la séquence de réparation correcte est suivie.

#### Vérification via la ligne de commande

<Tabs>
  <TabItem value="xfs" label="XFS">
    <FsCheckCliXfs />
  </TabItem>

  <TabItem value="btrfs" label="BTRFS">
    <FsCheckCliBtrfs />
  </TabItem>

  <TabItem value="zfs" label="ZFS">
    <FsCheckCliZfs />
  </TabItem>
</Tabs>

:::tip

- Les réparations du système de fichiers sont généralement plus rapides qu'une reconstruction complète et peuvent restaurer l'accès sans perte de données.
- Reconstruire un disque ne résout **pas** la corruption du système de fichiers ; effectuez toujours une vérification ou une réparation d'abord.
- Si vous avez des doutes, publiez vos diagnostics et messages d'erreur sur les [forums d'Unraid](https://forums.unraid.net/) pour obtenir de l'aide d'experts.

:::

---

### Réparation d'un système de fichiers

Si une vérification de votre système de fichiers trouve des erreurs, vous devrez peut-être exécuter une réparation pour retrouver l'accès à vos données. Les réparations prennent généralement moins de temps qu'une reconstruction complète, mais il est important de lire attentivement la sortie et de demander de l'aide sur les [forums](https://forums.unraid.net/) si vous n'êtes pas sûr de quelque chose.

:::note\[Timing]

Les réparations peuvent prendre de quelques minutes à plusieurs heures, surtout pour les systèmes de fichiers plus grands ou lourdement corrompus. Le progrès peut sembler lent, mais vous pouvez vérifier l'activité en regardant les statistiques de lecture/écriture sur la page principale.

:::

#### Préparer la réparation

1. Dans l'onglet **Principal**, cliquez sur le disque et identifiez le type de système de fichiers (%%XFS|xfs%%, EXT4, %%BTRFS|btrfs%%, ou %%ZFS|zfs%%).

2. Démarrez la matrice en mode correct :

   - **Pour %%XFS|xfs%% ou EXT4 :** Utilisez le **mode de maintenance**.
   - **Pour %%BTRFS|btrfs%% :** Utilisez **mode normal** pour un %%scrub|scrub%% ; utilisez **module de maintenance** pour une réparation.
   - **Pour %%ZFS|zfs%% :** Utilisez le **mode normal** et effectuez un %%scrub|scrub%% pour vérifier les erreurs. Voir la page de [stockage ZFS](../../advanced-configurations/optimize-storage/zfs-storage.mdx) pour des conseils sur la maintenance et les procédures de réparation des pools %%ZFS|zfs%%.

3. If the disk is disabled and being emulated, run the repair on the %%emulated disk|emulated-disk%% before trying to do a rebuild.

#### Réparation via le WebGUI

1. Start the %%array|array%% in the correct mode (refer to the section above).
2. Dans la rubrique **Principale**, cliquez sur le lecteur que vous souhaitez réparer.
3. Faites défiler pour **Vérifier l'état du système de fichiers**.
4. Pour XFS : Le processus de réparation est entièrement automatisé. Cliquez sur **VÉRIFIER**, puis sur **RÉPARER** si une corruption est détectée, et sur **ZÉRO LOG** si vous y êtes invité.
5. Pour les autres systèmes de fichiers : Supprimez toute option qui exécuterait le processus en mode vérification uniquement (comme `--readonly` pour %%BTRFS|btrfs%%).
6. Si vous y êtes invité, ajoutez les options suggérées comme indiqué dans le résultat de la vérification.
7. Cliquez sur **Vérifier** pour commencer la réparation.
8. Surveillez la progression dans la boîte de sortie. Utilisez **Actualiser** si nécessaire.
9. Si vous remarquez un dossier `lost+found` après la réparation, il peut contenir des fichiers ou des dossiers qui n'ont pas pu être entièrement récupérés. Utilisez des sauvegardes ou la commande Linux `file` pour identifier le contenu si nécessaire.

:::info

Si vous n'êtes pas sûr de la sortie, copiez-la et partagez-la sur les [forums Unraid](https://forums.unraid.net/) pour une aide experte. Utilisez l'option de formatage de code pour la rendre lisible.

:::

#### Réparation via la ligne de commande

<Tabs>
  <TabItem value="xfs" label="XFS">
    <FsRepairCliXfs />
  </TabItem>

  <TabItem value="btrfs" label="BTRFS">
    <FsRepairCliBtrfs />
  </TabItem>

  <TabItem value="zfs" label="ZFS">
    <FsRepairCliZfs />
  </TabItem>
</Tabs>

:::info[After la réparation]

- Arrêtez et redémarrez le %%array|array%% en **mode normal**.
- Le lecteur devrait maintenant être monté et accessible.
- Si vous voyez un dossier `lost+found`, vérifiez son contenu pour d'éventuels fichiers importants.

:::

Si vous ne comprenez pas le résultat de la réparation ou si le processus échoue, partagez vos diagnostics et le journal de réparation sur les [forums d'Unraid](https://forums.unraid.net/) pour obtenir de l'aide supplémentaire.
