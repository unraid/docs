---
sidebar_position: 3
sidebar_label: Caches temporaires
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import RemoveDiskGui from './partials/remove-disk-gui.mdx';
import RemoveDiskCommandLine from './partials/remove-disk-command-line.mdx';
import PoolSingleDeviceMode from './partials/pool-single-device-mode.mdx';
import PoolMultiDeviceMode from './partials/pool-multi-device-mode.mdx';
import MovePoolToArray from './partials/move-pool-to-array.mdx';
import MoveArrayToPool from './partials/move-array-to-pool.mdx';
import MoveBetweenPoolsUsingMover from './partials/move-between-pools-using-mover.mdx';
import MoveBetweenPoolsManual from './partials/move-between-pools-manual.mdx';

# Caches temporaires

Dans Unraid, un %%cache pool|cache-pool%% est une collection d'un ou plusieurs disques, généralement des SSD ou des HDD haute-vitesse. Ces disques stockent temporairement des données avant qu'elles ne soient déplacées vers votre [%%array|array%%](./array-configuration.mdx) principal. Utiliser des %%cache pools|cache-pool%% peut améliorer significativement les vitesses d'écriture, protéger vos données, et fournir un stockage dédié pour certaines tâches comme l'exécution de conteneurs Docker ou [%%machines virtuelles|vm%%](../create-virtual-machines/overview-and-system-prep.mdx).

%%Cache pools|cache-pool%% offer several advantages, making them a valuable addition to your Unraid setup, such as:

1. **Faster write speeds:** %%Cache pools|cache-pool%% allow you to quickly write data to faster drives before it gets transferred to the main %%array|array%%. This greatly enhances perceived performance when saving files.

2. **Protection des données pour les fichiers en cache :** En utilisant plusieurs disques dans un %%cache pool|cache-pool%% (en les configurant par exemple en %%RAID 1|raid1%%), vous ajoutez de la redondance. Cela signifie que vos données en cache sont protégées contre la défaillance d'un disque avant même qu'elles atteignent l'%%array|array%% principal.

3. **Stockage optimisé pour les applications :** Stocker des applications comme des conteneurs Docker ou des %%machines virtuelles|vm%% sur un %%cache temporaire|cache-pool%% améliore leur performance, réduit l'usure de votre %%array|array%% principal et minimise le temps nécessaire pour accéder aux fichiers fréquemment utilisés.

4. **Stockage flexible et dédié :** Avec plusieurs %%cache pools|cache-pool%%, vous pouvez assigner des pools spécifiques pour différentes tâches. Par exemple, vous pourriez avoir un pool dédié aux téléchargements et un autre aux %%machines virtuelles|vm%%, réduisant ainsi la concurrence pour les ressources et améliorant l'efficacité.

:::info[Keep [En connaissance de cause]

- **Multiples pools :** Vous pouvez créer et nommer différents %%caches temporaires|cache-pool%%, les adaptant à vos besoins spécifiques.
- **SSD vs. HDD :** Les SSD sont excellents pour la vitesse, tandis que vous pouvez utiliser les HDD pour des charges de travail de données séquentielles et volumineuses. De plus, les HDD peuvent aider à prolonger la durée de vie de vos SSD.
- **La redondance est importante :** Pour protéger vos données, utilisez plus d'un disque dans un %%cache pool|cache-pool%%. Un pool à disque unique ne vous protégera pas d'une éventuelle défaillance de disque.
- **Choix du système de fichiers :** Le système de fichiers par défaut pour les %%cache pools|cache-pool%% est %%BTRFS|btrfs%%, qui prend en charge divers options de %%RAID|raid%% pour une redondance et une flexibilité accrues. Pour plus de détails sur la sélection de systèmes de fichiers, consultez [Systèmes de fichiers](./file-systems.mdx).
- **%%Mover|mover%% integration:** Data written to a %%cache pool|cache-pool%% is automatically transferred to your main %%array|array%% based on a schedule you set. This keeps your [%%user shares|user-share%%](./shares.mdx) organized and easy to manage.
- **Performance des applications :** En plaçant les conteneurs Docker, les données des applications et les disques de %%machines virtuelles|vm%% sur un %%cache temporaire|cache-pool%%, vous améliorez la vitesse d'accès et réduisez la charge sur votre stockage principal.

:::

---

## Modes de pool

Les %%cache pools|cache-pool%% Unraid peuvent fonctionner dans deux modes principaux : **mode mono-dispositif** et **mode multi-dispositifs**. Connaître la différence entre ces modes vous aidera à trouver le juste équilibre entre performance, flexibilité, et protection des données selon vos besoins.

<Tabs>
  <TabItem value="dispositif unique" label="Mode dispositif unique" default>
    <PoolSingleDeviceMode />
  </TabItem>

  <TabItem value="multi-appareils" label="Mode multi-appareils">
    <PoolMultiDeviceMode />
  </TabItem>
</Tabs>

Les tâches courantes pour le %%cache temporaire|cache-pool%% incluent :

- Sauvegarder votre pool vers le %%array|array%%
- Basculer entre les modes appareil unique et multi-appareil
- Ajout de disques à un pool
- Remplacer des disques dans un pool

## Sauvegarder votre cache temporaire vers le tableau

Sauvegarder votre %%cache pool|cache-pool%% sur l'%%array|array%% principal est une étape cruciale avant toute mise à niveau, reformatage, ou remplacement de vos dispositifs de cache. Ce processus garantit que les données importantes - telles que les conteneurs Docker, les données d'application, et les fichiers de %%machine virtuelle|vm%% - sont sécurisées sur l'%%array|array%% principal, minimisant le risque lors de la maintenance.

<h3>Pourquoi sauvegarder votre %%cache pool|cache-pool%% ?</h3>

- **Protection des données :** Protégez vos fichiers importants avant d'effectuer des changements matériels ou des mises à niveau.
- **Prévention de perte accidentelle :** Réduisez le risque de perdre des données lors de reformatage ou de remplacement d'appareils.
- **Restauration facile :** Assurez-vous de pouvoir rapidement restaurer vos données d'application et de %%machines virtuelles|vm%% après maintenance.

:::important

Ce processus arrêtera tous les conteneurs Docker et %%machines virtuelles|vm%%, donc assurez-vous de planifier un temps d'arrêt et d'informer les utilisateurs si nécessaire. Pour plus d'informations sur la gestion des conteneurs Docker, voir [Gestion et personnalisation des conteneurs](../run-docker-containers/managing-and-customizing-containers.mdx).

:::

Pour sauvegarder votre %%cache temporaire|cache-pool%% :

1. **Arrêter tous les conteneurs Docker et %%machines virtuelles|vm%% en cours :** C'est essentiel pour un processus de sauvegarde fluide.
2. **Désactiver les %%machines virtuelles|vm%% :**
   - Allez à ***Paramètres → Gestionnaire de VMs***.
   - Éteignez les %%VMs|vm%% et cliquez sur **Appliquer**.
3. **Désactiver Docker** :
   - Naviguez vers ***Paramètres → Docker***.
   - Éteignez Docker et cliquez sur **Appliquer**.
4. **Définir le stockage partagé et l'action Mover (cache → tableau) :**
   - Allez dans l'onglet **Partages**.
   - For each %%user share|user-share%% you want to move, set **Primary storage** to the source %%cache pool|cache-pool%% and **Secondary storage** to the %%array|array%%.
   - Définissez **Action du Mover** sur **cache → tableau**.
5. \*\*Vérifiez l'espace sur le %%array|array%% : Assurez-vous qu'il y a suffisamment d'espace libre pour vos fichiers.
6. **Déplacer les fichiers vers l'%%array|array%%** : Depuis la page **Principale**, cliquez sur **Déplacer maintenant**. Cela transfère les fichiers du %%cache pool|cache-pool%% à l'%%array|array%% en fonction de l'action Mover.
7. **Vérifiez que votre pool est vide :** Une fois que le %%Mover|mover%% a terminé, vérifiez qu'il ne reste pas de fichiers dans le %%cache temporaire|cache-pool%%.

:::note

N'oubliez pas que les fichiers situés directement sur l'appareil du pool (non inclus dans un partage) doivent être déplacés manuellement.

:::

### Restaurer des fichiers sur le cache temporaire

Après avoir terminé votre maintenance ou remplacé votre appareil, vous pouvez restaurer des fichiers depuis le %%array|array%% vers le %%cache temporaire|cache-pool%% en suivant ces étapes :

1. **Définir le stockage partagé et l'action Mover (tableau → cache)** :
   - Allez dans l'onglet **Partages**.
   - For each %%user share|user-share%% you want to restore, set **Primary storage** to the destination %%cache pool|cache-pool%% and **Secondary storage** to the %%array|array%%.
   - Définissez **Action du Mover** sur **array → cache**.
2. \*\*Vérifiez l'espace sur le pool : Assurez-vous qu'il y a suffisamment d'espace libre sur le %%cache temporaire|cache-pool%%.
3. \*\*Déplacez les fichiers vers le pool : Allez à la page **Principale** et cliquez sur **Déplacer maintenant** pour transférer les fichiers vers le %%cache temporaire|cache-pool%%.
4. **Vérifiez le contenu du pool :** Après que le déplacement soit terminé, vérifiez que votre %%cache temporaire|cache-pool%% contient les fichiers attendus et que les partages sont vides sur le %%array|array%%.
5. **Réactivez Docker :** Allez à ***Paramètres → Docker*** et réactivez Docker, puis cliquez sur **Appliquer**.
6. **Réactivez les %%machines virtuelles|vm%% :** Allez à ***Paramètres → Gestionnaire de VM*** et rallumez les %%VMs|vm%%, puis cliquez sur **Appliquer**.
7. **Redémarrez les conteneurs Docker et les %%VMs|vm%% :** Enfin, redémarrez tous les conteneurs Docker ou les %%machines virtuelles|vm%% que vous souhaitez faire à nouveau fonctionner.

---

## Passer au mode Multi-Appareils

%%Cache pools|cache-pool%% in Unraid can be expanded from a single device to multiple devices, allowing for increased capacity and redundancy. To take advantage of multi-device mode, your pool must be formatted as %%BTRFS|btrfs%% or %%ZFS|zfs%%.

### Converting a pool to BTRFS or ZFS

Si votre %%cache temporaire|cache-pool%% n'est pas déjà formaté en %%BTRFS|btrfs%% ou %%ZFS|zfs%%, suivez ces étapes simples :

1. **Sauvegardez vos données :** Tout d'abord, assurez-vous de sauvegarder tout contenu important. (Voir [Sauvegarder votre cache pool sur l'array](#backing-up-your-cache-pool-to-the-array))
2. **Arrêtez le %%array|array%% :** Assurez-vous de stopper le %%array|array%% pour débuter le processus de conversion.
3. **Changer le système de fichiers** : Cliquez sur le bassin dans l'onglet **Principal** et sélectionnez **BTRFS** ou **ZFS** comme format de système de fichiers.
4. **Démarrez le %%array|array%% :** Après avoir changé le format, démarrez le %%array|array%%.
5. **Formater le pool** : Le pool apparaîtra comme **non montable** et proposera l'option de formatage. Confirmez et cliquez sur le bouton **Formatage**.
6. **Formatage complet :** Une fois le formatage terminé, vous aurez un pool %%BTRFS|btrfs%% ou %%ZFS|zfs%%, bien qu'il n'aura qu'un seul appareil à ce stade.
7. **Ajoutez des disques supplémentaires si désiré :** Vous pouvez procéder à ajouter plus de disques à votre pool si vous le souhaitez.
8. **Restaurez vos données :** Enfin, suivez les étapes de restauration à partir de la procédure de sauvegarde pour déplacer vos données de retour vers le pool.

### Ajout de disques pour créer un pool multi-appareils

Une fois votre pool formaté en %%BTRFS|btrfs%% ou %%ZFS|zfs%%, vous pouvez ajouter d'autres disques pour la redondance et pour étendre le stockage.

Pour ajouter plus de disques pour la redondance :

1. **Arrêtez le %%array|array%%:** Commencez à nouveau par arrêter le %%array|array%%.
2. **Attribuez des disques supplémentaires :** Dans l'onglet **Principal**, vous pouvez attribuer un ou plusieurs nouveaux appareils à votre pool.
3. **Démarrez le %%array|array%% :** Une fois les disques assignés, démarrez le %%array|array%%.
4. **Équilibrage/résilience automatique :** Unraid incorporera automatiquement les nouveaux appareils dans le pool et lancera un **équilibrage** (%%BTRFS|btrfs%%) ou une **résilience** (%%ZFS|zfs%%) pour distribuer et protéger les données à travers les appareils.
5. **Suivez les progrès :** Dans l'onglet **Principal**, cliquez sur le premier appareil du pool, puis vérifiez **Statut de l'équilibrage** (pour %%BTRFS|btrfs%%) ou **statut du zpool** (pour %%ZFS|zfs%%) pour suivre les progrès et confirmer que le nouvel appareil a été ajouté avec succès.
6. **Pool maintenant en mode multi-appareils :** Une fois l'équilibrage terminé, votre pool fonctionnera en **mode multi-appareils** avec une capacité et une redondance améliorées.

:::tip

Vous pouvez utiliser le [calculateur d'utilisation du disque BTRFS](http://carfax.org.uk/btrfs-usage/) pour estimer l'espace disponible et la redondance en fonction de votre niveau de %%RAID|raid%% choisi et des tailles des appareils.

:::

---

## Ajout de disques à un pool

Au fur et à mesure que vos besoins de stockage augmentent, vous pouvez vouloir étendre votre cache pool en ajoutant des disques supplémentaires. Ce processus permet d'accroître à la fois la capacité et la performance tout en maintenant la protection des données via des configurations RAID.

:::note

Si vous souhaitez ajouter des disques à votre pool, assurez-vous que votre pool est déjà formaté en %%BTRFS|btrfs%% ou %%ZFS|zfs%%. Si ce n'est pas le cas, vous devrez d'abord le formater, comme expliqué dans [la section précédente](#converting-a-pool-to-btrfs-or-zfs).

:::

Pour ajouter un disque à un pool :

1. **Arrêtez le %%array|array%% :** Commencez par arrêter le %%array|array%% actuel pour vous assurer que le processus se déroule sans problème.
2. **Ouvrez l'onglet Principal** : Allez à l'onglet **Principal** dans le %%WebGUI|web-gui%%. C'est ici que vous gérerez vos disques.
3. **Trouvez la section Dispositifs de Pool** : Faites défiler vers le bas jusqu'à ce que vous voyiez la section *Dispositifs de Pool*. C'est ici que vous pouvez apporter des modifications à la configuration de vos disques.
4. **Ajustez le nombre de slots** : Réglez **Slots** sur exactement le nombre de dispositifs supplémentaires que vous ajoutez. Vous ne pouvez pas laisser de slots vides ; l'array ne démarrera pas avec des slots de pool non utilisés.
5. **Assignez vos appareils :** Choisissez quels appareils (disques) vous souhaitez ajouter au pool et assignez-les aux emplacements disponibles.
6. **Démarrez le %%array|array%% :** Après avoir assigné vos appareils, démarrez à nouveau le %%array|array%% pour activer ces modifications.

---

## Retirer des disques d'un pool

Enlever un disque d'un %%cache pool|cache-pool%% multi-dispositifs %%BTRFS|btrfs%% ou %%ZFS|zfs%% peut vous aider à récupérer du matériel, remplacer un disque défectueux, ou reconfigurer votre stockage. Ce processus n'est possible que si votre pool est configuré pour la redondance (comme %%RAID 1|raid1%% pour les données et les métadonnées) et que les dispositifs restants ont assez d'espace pour accueillir toutes vos données.

<Tabs>
  <TabItem value="gui" label="Via le WebGUI" default>
    <RemoveDiskGui />
  </TabItem>

  <TabItem value="ligne de commande" label="Utilisation de la ligne de commande (Avancé) ">
    <RemoveDiskCommandLine />
  </TabItem>
</Tabs>

### Changer les niveaux de RAID de la pool

%%BTRFS|btrfs%% offre la possibilité de changer les niveaux de %%RAID|raid%% pour les %%cache pools|cache-pool%% de façon dynamique, vous permettant d'ajuster les réglages sans arrêter l'%%array|array%% ou perdre des données. Cette flexibilité vous permet d'optimiser pour la performance, la redondance, ou l'efficacité du stockage selon l'évolution de vos besoins.

<h4>Niveaux de %%RAID|raid%% pris en charge</h4>

| Niveau %%RAID\|raid%% | Protection des données | Efficacité de l'espace | Cas d'utilisation                                                                                                 |
| --------------------- | ---------------------- | ---------------------- | ----------------------------------------------------------------------------------------------------------------- |
| Unique                | Aucune                 | 100%                   | Stockage temporaire ou données non critiques où la redondance n'est pas nécessaire.                               |
| %%RAID 0\|raid0%%     | Aucune                 | 100%                   | Maximise la performance et la capacité, mais déconseillé pour les données critiques.                              |
| %%RAID 1\|raid1%%     | 1 panne de disque      | 50%                    | Par défaut pour les pools Unraid. Idéal pour le stockage Docker/%%VM\|vm%% et les données critiques.              |
| %%RAID 10\|raid10%%   | 1 panne de disque      | 50%                    | Allie la vitesse de %%RAID 0\|raid0%% à la redondance de %%RAID 1\|raid1%% pour les besoins de haute performance. |
| %%RAID 5\|raid5%%\*   | 1 panne de disque      | 67-94%                 | **Expérimental.** Équilibre capacité et redondance pour le stockage multimédia volumineux.                        |
| %%RAID 6\|raid6%%\*   | 2 pannes de disque     | 50-88%                 | **Expérimental.** Offre une protection supplémentaire pour le stockage d'archives avec de grands disques.         |

:::important

%%RAID 5|raid5%% et %%RAID 6|raid6%% sont considérés comme expérimentaux dans %%BTRFS|btrfs%%. %%ZFS|zfs%% offre un support plus mature pour ces niveaux de %%RAID|raid%%. Utilisez avec précaution et assurez-vous d'avoir des sauvegardes. Évitez d'utiliser les niveaux de %%RAID|raid%% expérimentaux pour les données critiques.

:::

Pour changer le niveau de %%RAID|raid%% d'une pool :

1. **Démarrer l'%%array|array%%** en mode normal si ce n'est pas déjà le cas.
2. **Cliquez sur le nom de la pool** dans l'onglet **Principal**.
3. **Faites défiler jusqu'à Statut de l'Équilibre** : Vérifiez les niveaux actuels de %%RAID|raid%% pour les données et les métadonnées.
4. **Sélectionnez le nouveau profil de %%RAID|raid%%** : Choisissez parmi un menu déroulant de profils prédéfinis.
5. **Démarrer l'opération d'équilibrage** : Cliquez sur **Équilibrer** pour commencer la conversion.

<div style={{ margin: 'auto', maxWidth: '600px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
  ![Conversion de %%RAID 1|raid1%% à Single profile](/img/Btrfs-raid1.jpg)
  <p class="caption-center">*Exemple : Conversion de %%RAID 1|raid1%% à Single profile*</p>
</div>

6. **Surveiller le progrès :** Les opérations d'équilibrage peuvent prendre plusieurs heures, voire des jours, selon la quantité de données dans le pool, les vitesses des disques et la complexité du niveau de %%RAID|raid%% sélectionné.

<details>
  <summary>Dépannage des opérations d'équilibrage si bloquées - Cliquez pour développer/réduire</summary>

  Si une opération d'équilibrage semble bloquée ou ne répond pas, suivez ces étapes :

  1. **Vérifiez les journaux** : Allez dans ***Outils → Journaux*** et filtrez pour les entrées `btrfs`.
  2. **Arrêtez et reprenez l'opération** :
     - Cliquez sur **Annuler l'Équilibre**.
     - Redémarrer l'%%array|array%%.
     - Initiez à nouveau l'opération d'équilibrage.
  3. **Vérifiez la santé du disque** : Exécutez des tests %%SMART|smart%% sur tous les dispositifs du pool. Pour plus d'informations sur la surveillance de la santé des disques, consultez [rapports SMART et santé des disques](../../system-administration/monitor-performance/smart-reports-and-disk-health.mdx).
  4. **Vérifiez l'espace libre** : Assurez-vous qu'il y ait au moins 10-15% d'espace libre disponible sur la pool.
  5. **Publiez des diagnostics** : Partagez les journaux sur les [forums Unraid](https://forums.unraid.net/) si les problèmes persistent. Pour obtenir des conseils sur la capture de diagnostics, consultez [Capturer diagnostics et journaux](../../troubleshooting/diagnostics/capture-diagnostics-and-logs.mdx).
</details>

Pour des détails de configuration avancée pour %%BTRFS|btrfs%%, référez-vous au [wiki BTRFS](https://btrfs.wiki.kernel.org/index.php/Using_Btrfs_with_Multiple_Devices).

---

## Remplacer un disque dans une pool

Remplacer un disque dans votre %%cache pool|cache-pool%% est une tâche importante qui aide à maintenir la performance et la fiabilité de votre système de stockage.

:::note\[Prerequisites]

- **Vérifiez la configuration de votre pool :** Assurez-vous que votre pool est configuré avec un profil %%RAID|raid%% redondant, comme %%RAID 1|raid1%%. Vous pouvez le faire en accédant à ***Main → Pool → Balance Status*** (pour %%BTRFS|btrfs%%) ou statut du pool ZFS (pour %%ZFS|zfs%%) dans votre interface de gestion.
- **Choisissez le bon disque de remplacement :** Le nouveau disque doit être de la même taille ou plus grand que celui que vous remplacez.
- **Capacité de remplacement à chaud :** Si votre matériel supporte le remplacement à chaud, vous n'aurez pas besoin d'éteindre votre système pour remplacer le disque.

:::

Pour remplacer un disque dans une pool :

1. **Arrêtez l'%%array|array%%** : Allez à l'onglet **Main**, trouvez la section **Operation de l'Array**, et cliquez sur le bouton **Stop**. Cela arrêtera en toute sécurité l'%%array|array%% pour préparer le remplacement des disques.
2. **(Optionnel) Retirez l'ancien disque** : Si vous n'avez pas un système capable d'échange à chaud, vous devrez détacher physiquement l'ancien disque. Assurez-vous de faire cela avec précaution pour éviter tout dommage.
3. **Installez le disque de remplacement** : Insérez le nouveau disque dans votre système. Assurez-vous qu'il est correctement connecté et sécurisé.
4. **Rafraîchir le %%WebGUI|web-gui%%** : Retournez à l'onglet **Principal** et rafraîchissez la page pour permettre au système de détecter votre nouveau disque.
5. **Assignez le nouveau disque :** Une fois détecté, trouvez l'emplacement de la pool où l'ancien disque était situé et assignez le nouveau disque à cet endroit.
6. **Démarrez le %%array|array%% :** Cliquez sur le bouton **Démarrer** pour commencer le processus d'intégration du nouveau disque dans le %%array|array%%.
7. **Surveillez la reconstruction** : Le système commencera automatiquement à reconstruire les données sur le nouveau disque. Vous pouvez surveiller la progression dans le %%WebGUI|web-gui%%.

:::important\[Timing]

La reconstruction peut prendre un certain temps, selon la taille du disque et la charge actuelle de votre système. Par exemple, reconstruire un SSD de 4 To dans une configuration %%RAID 1|raid1%% peut prendre environ 3 à 6 heures. Il est préférable de planifier cela lorsque vous pouvez permettre au système de fonctionner sans interruption.

:::

---

## Espace libre minimum pour une pool de cache

Définir un espace libre minimum pour votre %%cache pool|cache-pool%% peut permettre un meilleur contrôle sur le placement des fichiers, surtout lorsqu'il s'agit de gros fichiers tels que les vidéos haute résolution. Ce réglage aide Unraid à savoir quand cesser d'écrire sur le pool et commencer à écrire directement sur l'%%array|array%% de stockage plus grand, évitant les interruptions ou la corruption de données.

:::tip\[Example]

Si vous téléchargez souvent des fichiers d'environ 10 Go, définissez l'espace libre minimum à au moins 10 Go, mais idéalement 20 Go pour permettre des ajustements.

:::

Vous pouvez accéder à l'Espace libre minimum en cliquant sur le nom de la pool dans l'onglet **Principal** et en allant dans **Paramètres de Pool Individuel**.

<h4>Comment ça fonctionne</h4>

- Lorsque vous transférez un fichier vers un partage qui inclut un pool, Unraid respectera le premier paramètre de seuil qu'il rencontre (soit l'espace libre minimum du partage, soit celui du pool, selon le cas atteint en premier).
- Le paramètre d'espace libre minimum indique à Unraid d'arrêter d'utiliser la %%cache pool|cache-pool%% lorsque l'espace libre tombe en dessous de ce montant.
- Si votre partage utilise une %%cache pool|cache-pool%% comme **Stockage Principal**, les fichiers vont à la pool jusqu'à ce qu'elle atteigne l'espace libre minimum, puis ils sont envoyés directement au %%array|array%%.
- Si elle est réglée pour utiliser exclusivement la %%cache pool|cache-pool%% (pas de **Stockage Secondaire**), ce paramètre n'est pas appliqué.
- Si elle est réglée pour n'utiliser que le %%array|array%% comme **Stockage Principal**, les fichiers vont directement au %%array|array%%.

:::tip[Use [Exemple de cas]

Le partage Média a le plancher réglé à 20 Go, ce qui convient aux fichiers dans ce partage. Cependant, si vous utilisez également le pool pour une VM et souhaitez laisser une marge de sécurité au cas où le disque virtuel grossirait, vous pourriez régler le plancher du pool à 50 Go. De cette façon, tout transfert vers le partage Média après que le pool ait moins de 50 Go libres irait directement à l'array.

:::

:::tip[Best pratique]

Réglez l'espace libre minimum à au moins la taille du plus grand fichier que vous attendez, de préférence le double de cette taille. Par exemple, si votre plus grand fichier est de 30 Go, réglez le minimum à 60 Go.

:::

:::caution

**Ne réglez pas l'espace libre minimum à 0.** Cela peut provoquer des erreurs de disque plein. Utilisez toujours une valeur raisonnable.

:::

---

## Déplacer des fichiers entre une pool et l'array

There are times when you may need to move files between your %%cache pool|cache-pool%% and the main %%array|array%%, such as when preparing for maintenance, upgrading hardware, or optimizing performance. Unraid provides a built-in tool called %%Mover|mover%% to automate this process for [%%user shares|user-share%%](./shares.mdx).

:::tip

Désactivez toujours les services Docker et %%VM|vm%% avant de déplacer des fichiers avec le %%Mover|mover%%. Cela empêche les fichiers ouverts d'être ignorés lors du transfert.

:::

<Tabs>
  <TabItem value="pool-to-array" label="Pool vers array" default>
    <MovePoolToArray />
  </TabItem>

  <TabItem value="array-to-pool" label="Array vers pool">
    <MoveArrayToPool />
  </TabItem>
</Tabs>

<details>
  <summary><strong>Pourquoi les fichiers se retrouvent-ils parfois dans le mauvais pool ou cache?</strong> - Cliquez pour développer/réduire</summary>

  When you move files between [%%user shares|user-share%%](./shares.mdx) at the Linux level (for example, using `mv` or within a Docker container), Linux tries to optimize the operation. If both the source and destination appear on the same mount point (`/mnt/user`), Linux might rename the file instead of moving it. This can result in files remaining on the original disk or pool, even if the share's "Use cache" setting is set to "No."

  Pour vous assurer que les fichiers se déplacent comme prévu, prenez en compte les options suivantes :

  - Utilisez l'outil %%Mover|mover%%.
  - Copiez les fichiers, puis supprimez les originaux.
  - Déplacez les fichiers via le réseau.

  Ces méthodes aident à éviter que des fichiers se retrouvent au mauvais endroit.
</details>

---

## Multiples pools

Unraid vous permet de créer et de gérer jusqu'à 35 pools de stockage distincts, chacun avec jusqu'à 60 dispositifs. Plusieurs pools vous donnent la flexibilité d'allouer du stockage pour différentes tâches, d'améliorer les performances et de personnaliser la redondance en fonction de vos besoins. Chaque pool peut utiliser un système de fichiers, un niveau de %%RAID|raid%% et un type de dispositif (SSD, HDD, NVMe, etc.) différents.

<h4>Pourquoi utiliser plusieurs pools ?</h4>

- **Optimisez la performance :** Les pools séparés pour les %%VMs|vm%%, conteneurs Docker, téléchargements ou médias peuvent améliorer la vitesse et réduire les conflits.
- **Protégez les données :** Assignez différents niveaux %%RAID|raid%% ou systèmes de fichiers à chaque pool pour une redondance et des options de sauvegarde personnalisées.
- **Isolez les charges de travail :** Gardez les applications critiques sur des pools plus rapides et redondants et stockez les données volumineuses sur des appareils plus grands et rentables.
- **Gérez de manière flexible :** Vous pouvez agrandir, réduire ou formater les pools indépendamment sans impact sur les autres.

<h4>Cas d'utilisation courants</h4>

| Cas d'utilisation                   | Exemple de configuration                                                   | Bénéfice                                                  |
| ----------------------------------- | -------------------------------------------------------------------------- | --------------------------------------------------------- |
| %%VMs\|vm%% à haute performance     | Pool NVMe SSD, %%RAID 1\|raid1%%, %%BTRFS\|btrfs%% ou %%ZFS\|zfs%%         | Entrée/Sortie rapide avec redondance                      |
| Stockage Docker/Appdata             | Pool SSD, %%RAID 1\|raid1%%, %%BTRFS\|btrfs%% ou %%ZFS\|zfs%%              | Accès rapide et protection des données                    |
| Téléchargements de médias en vrac   | Grand pool HDD, %%RAID 0\|raid0%% ou unique, %%XFS\|xfs%%/%%BTRFS\|btrfs%% | Grande capacité avec moins de redondance                  |
| Isolation de projet/équipe          | Pools séparés pour chaque équipe/projet                                    | Réduit les conflits de ressources                         |
| Cibles de sauvegarde et instantanés | Pool %%ZFS\|zfs%%, %%RAIDZ1\|raidz1%%/%%RAIDZ2\|raidz2%% (multi-appareil)  | Prend en charge les instantanés natifs et les sauvegardes |

:::info[Supported [Systèmes de fichiers]

- %%BTRFS|btrfs%% : Meilleur pour les pools multi-appareils (prend en charge %%RAID 0|raid0%%, %%RAID 1|raid1%%, %%RAID 10|raid10%%, %%RAID 5|raid5%%, %%RAID 6|raid6%%).
- %%ZFS|zfs%% : Excellent pour les pools à dispositif unique et multi-dispositifs (Unraid 6.12+), avec un support mature pour %%RAIDZ1|raidz1%% et %%RAIDZ2|raidz2%%. Pour des fonctionnalités ZFS avancées et leur configuration, voir [Stockage ZFS](../../advanced-configurations/optimize-storage/zfs-storage.mdx).
- %%XFS|xfs%% : Convient pour les pools à un seul appareil.

:::

Lors de l'accès à une [partage utilisateur %%user share|user-share%%](./shares.mdx) de plusieurs pools et de disques %%array|array%%, Unraid fusionne les listes de répertoires dans cet ordre :

1. Pool assigné au partage
2. Disques %%array|array%% (disk1, disk2, ..., disk28)
3. Autres pools (dans l'ordre)

### Déplacement de fichiers entre pools

Unraid ne permet pas le déplacement direct de fichiers entre pools via le %%WebGUI|web-gui%%, mais vous pouvez le faire en utilisant l'outil %%Mover|mover%% ou en ligne de commande.

:::note\[Remember]

Si l'un des fichiers appartient à un conteneur Docker et/ou %%VM|vm%%, les services doivent être désactivés pour que les fichiers puissent être déplacés avec succès.

:::

<Tabs>
  <TabItem value="using-mover" label="Utilisation de Mover" default>
    <MoveBetweenPoolsUsingMover />
  </TabItem>

  <TabItem value="transfert-manuel" label="Transfert manuel de fichiers (avancé)">
    <MoveBetweenPoolsManual />
  </TabItem>
</Tabs>

:::warning

Si vous retirez un dispositif d'un pool %%BTRFS|btrfs%% ou %%ZFS|zfs%% et le déplacez vers un nouveau pool, Unraid effacera toutes les données lorsqu'il redémarrera l'%%array|array%%. Sauvegardez toujours les données importantes avant de changer les configurations de pool.

:::
