---
sidebar_position: 5
sidebar_label: Dépannage de Docker
---

# Dépannage de Docker

:::info
Docker facilite l'exécution d'une variété d'applications sur votre serveur Unraid, mais des problèmes peuvent survenir, tels que des conteneurs qui ne démarrent pas, des fichiers d'image Docker corrompus ou des problèmes de réseau. Cette page aborde certains problèmes courants liés à Docker sur Unraid et propose les meilleures pratiques pour les résoudre efficacement.
:::

Docker facilite l'exécution d'une variété d'applications sur votre serveur Unraid, mais des problèmes peuvent survenir, tels que des conteneurs qui ne démarrent pas, des fichiers d'image Docker corrompus ou des problèmes de réseau. Cette page aborde certains problèmes courants liés à Docker sur Unraid et propose les meilleures pratiques pour les résoudre efficacement.

---

## Recréer le fichier image Docker

Un fichier d'image Docker corrompu (`docker.img`) est un problème courant, souvent causé par le pool de %%cache|cache-pool%% à court d'espace ou un arrêt non propre. Heureusement, un conteneur bien configuré stocke toutes les données variables en dehors du fichier image (généralement dans le partage `appdata`), vous pouvez donc recréer l'image sans perdre vos configurations d'application ou données.

Vous êtes maintenant prêt à réinstaller vos conteneurs en utilisant leurs paramètres sauvegardés.

1. Allez dans ***Settings → Docker*** dans le %%WebGUI|web-gui%%.
2. Réglez **Activer Docker** sur **Non** et cliquez sur **Appliquer** pour arrêter le service Docker.
3. Sélectionnez l'option pour supprimer le fichier vdisk Docker, puis cliquez sur **Appliquer**. Vous pouvez également supprimer manuellement le fichier si nécessaire.
4. Confirmez l'emplacement et le nom de fichier pour le nouveau fichier vdisk Docker. Ce paramètre inclut à la fois le chemin d'accès au dossier et le nom du fichier.
5. Définissez la taille souhaitée pour le nouveau fichier image. La taille par défaut est généralement suffisante pour la plupart des utilisateurs.
6. Réglez **Activer Docker** sur **Oui** et cliquez sur **Appliquer**. Unraid créera et formatera un nouveau fichier `docker.img` en utilisant %%BTRFS|btrfs%%.

Vous êtes maintenant prêt à réinstaller vos conteneurs en utilisant leurs paramètres sauvegardés.

---

## Réinstaller des applications Docker

Unraid sauvegarde automatiquement un modèle pour chaque conteneur installé sur votre clé USB. Ces modèles stockent votre configuration, facilitant ainsi la restauration des conteneurs après la recréation du fichier d'image Docker.

Pour réinstaller vos conteneurs :

1. Allez à l'onglet **Apps** dans le %%WebGUI|web-gui%%.
2. Ouvrez la section **Applications Précédentes**.
3. Sélectionnez les conteneurs que vous souhaitez réinstaller.
4. Procédez à l'installation. Unraid retéléchargera chaque conteneur et appliquera automatiquement vos paramètres précédents.

:::important
Ce processus restaure vos conteneurs à leur état précédent, à condition que toutes les données variables soient mappées en dehors du fichier image Docker (par exemple, dans le partage `appdata`).
:::

:::tip
Si un conteneur ne démarre pas après la réinstallation, vérifiez ses journaux dans le menu contextuel de l'onglet **Docker** pour des messages d'erreur et des indices de dépannage.
:::

:::note
Vérifiez que tous les chemins hôtes mappés existent et ont les bonnes permissions après avoir restauré vos conteneurs. Les mappages incorrects ou les permissions sont une cause courante de problèmes de démarrage.
:::

---

## Restaurer les réseaux personnalisés de Docker

Les réseaux Docker personnalisés ne persistent pas si le fichier image Docker est supprimé. Avant de supprimer l'image, documentez vos noms de réseau personnalisés en ouvrant un terminal et en exécutant :

```
docker network ls
```

Notez les noms de tous les réseaux que vous avez créés (à l'exclusion des réseaux par défaut `bridge`, `host`, et `none`).

Pour restaurer les réseaux personnalisés :

1. Après avoir recréé le fichier image Docker, recréez chaque réseau personnalisé en utilisant :

   ```
   docker network create <network-name>
   ```

   Remplacez `<network-name>` par le nom exact que vous avez noté plus tôt.

2. Mettez à jour vos conteneurs pour utiliser les réseaux restaurés si nécessaire.

:::note
Vous pouvez activer l'accès hôte aux réseaux personnalisés sous ***Settings → Docker*** en réglant **Accès hôte aux réseaux personnalisés** sur **Activé** si votre configuration l'exige.
:::

:::tip
Si les conteneurs ne peuvent pas communiquer comme prévu après la restauration, inspectez vos paramètres de réseau Docker pour des conflits ou des problèmes de connectivité.
:::
