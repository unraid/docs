# Version 6.12.8 2024-02-15

## Notes de mise à niveau

Cette version comporte deux correctifs très importants. Tout d’abord, nous avons mis à jour Docker pour intégrer les correctifs de leur [récente alerte de sécurité](https://www.docker.com/blog/docker-security-advisory-multiple-vulnerabilities-in-runc-buildkit-and-moby/).

Deuxièmement, nous avons corrigé un bug dans un cas particulier qui peut entraîner une perte de données si un lecteur de tableau nouvellement ajouté a un agencement de partition non standard. Si vous ajoutez l'un de ces lecteurs, la deuxième fois que vous démarrez le tableau, le lecteur apparaîtra comme non formaté. Si cela se produit, veuillez contacter le support et nous pourrons vous aider à récupérer les données. Même si vous n'avez pas rencontré ce problème, nous vous recommandons de mettre à jour pour ne pas être affecté lors de l'ajout de lecteurs à l'avenir.

Cette version inclut également quelques bons correctifs dans le réseau, les conteneurs Docker, le support Time Machine et les machines virtuelles, ainsi qu'un correctif pour un ralentissement que certains systèmes rencontraient sur le tableau de bord. Nous avons également amélioré la gestion des attributs SMART pour les disques NVME et SSD. Détails ci-dessous.

### Problèmes connus

#### Plugins obsolètes

Les plugins obsolètes peuvent causer des problèmes, nous recommandons de les garder à jour.

#### Traces d'appel et plantages liés à macvlan

Si vous obtenez des traces d'appels liées à macvlan (ou à tout autre plantage inexpliqué), comme première étape, nous vous recommandons de naviguer vers ***Paramètres > Docker***, de passer à la vue **avancée**, et de changer le **type de réseau personnalisé Docker** de **macvlan** à **ipvlan**. C'est la configuration par défaut qu'Unraid a expédiée depuis la version 6.11.5 et devrait fonctionner pour la plupart des systèmes.

Notez que certains utilisateurs ont signalé des problèmes avec le transfert de port depuis certains routeurs (Fritzbox) et une fonctionnalité réduite avec des outils de gestion de réseau avancés (Ubiquity) en mode ipvlan. Si cela vous affecte, consultez la solution alternative disponible depuis Unraid [6.12.4](6.12.4.md#fix-for-macvlan-call-traces).

#### Problèmes de réseau dus aux trames jumbo

Si vous rencontrez des problèmes réseau de quelque nature que ce soit, vérifiez que vous n'avez pas activé les jumbo frames. Allez à ***Paramètres > Paramètres réseau > eth0*** et confirmez que le **MTU désiré** est 1500. Pour plus d'informations, consultez l'[avertissement sur les problèmes courants pour les jumbo frames](https://forums.unraid.net/topic/120220-fix-common-problems-more-information/page/2/#comment-1167702).

#### Problèmes dus aux cartes réseau Realtek

Le noyau mis à jour corrige le problème de blocage avec les jumbo frames et le pilote interne Realtek 8125. Cependant, nous recommandons toujours de suivre les conseils ci-dessus concernant les jumbo frames.

Si vous continuez à rencontrer des problèmes de stabilité réseau et que ***Outils > Dispositifs système*** affiche que vous avez un contrôleur Ethernet Realtek, récupérez le numéro de pièce affiché et recherchez dans les Applications Communautaires pour voir s'il y a un plugin de pilote fourni par Realtek pour cet appareil. Pour plus d'informations, voir la [page de support pour les plugins de pilotes Realtek](https://forums.unraid.net/topic/141349-plugin-realtek-r8125-r8168-and-r81526-drivers/).

#### Autres problèmes ?

Nous recommandons vivement d'installer le plugin **Corriger les Problèmes Courants** car il vous avertira des problèmes de configuration courants.

Si vous rencontrez d'autres plantages ou des problèmes de stabilité, allez à ***Paramètres > Serveur Syslog*** et activez **Miroir syslog vers flash**. Cela entraînera une usure supplémentaire de votre périphérique de démarrage USB, mais est utile à court terme pour collecter des journaux après un plantage.

Après le prochain redémarrage, naviguez vers ***Outils > Diagnostics*** et téléchargez vos diagnostics anonymisés (à partir de la version 6.12.5, les diagnostics incluent automatiquement les journaux qui étaient en miroir sur le lecteur flash).

Enfin, commencez un nouveau sujet sous [Support Général](https://forums.unraid.net/forum/55-general-support/) et fournissez tous les détails du problème. Une fois le problème résolu, assurez-vous de désactiver **Miroir syslog vers flash**.

### Rétrogradation

Soyez conscient que revenir à une version précédente rendra votre système vulnérable aux problèmes de sécurité Docker et au scénario de perte de données potentielle mentionné dans [Notes de mise à niveau](#upgrade-notes).

Si vous rétrogradez à une version antérieure à 6.12.6, consultez également les [notes de version 6.12.6](6.12.6.md#rolling-back).

## Modifications par rapport à la version 6.12.7

Correction d'un problème lié à la mise à niveau des versions rc.

## Changements par rapport à [6.12.6](6.12.6.md)

### Corrections de bugs et améliorations

- Docker :
  - Correction des itinéraires WG ajoutés à la bonne interface (br0 ou eth0 ou bond0)
  - Utilisation de "démonter paresseux" du docker image pour éviter le blocage de l'arrêt de l'array
  - Mis à jour pour corriger plusieurs problèmes de sécurité (CVE-2024-21626, CVE-2024-24557)
- Améliorations réseau :
  - Démarrez plus rapidement en vérifiant le support avant d'attribuer des adresses DHCP
  - Suppression des zéros initiaux des adresses IPv4 et IPv6
  - Nouvelles commandes '/etc/rc.d/rc.inet1 status' et '/etc/rc.d/rc.inet1 status ip' pour aider au dépannage réseau depuis la ligne de commande
- Notifications : ajout de ntfy.sh aux agents de notification
- Améliorations SMART :
  - Correction du test automatique NVME
  - Correction de l'affichage de l'attribut SMART "Temps de puissance cumulée, heures:minutes xxxxx:yy"
  - Afficher KB/MB/GB/TB écrits dans les Attributs SMART pour les SSD
  - Ajout de l'attribut SMART 'Endurance restante SSD
- Journalisation système :
  - Par défaut, syslog est copié sur la clé USB au démarrage, voir ***Paramètres > Serveur Syslog*** pour désactiver
  - Les journaux ci-dessus et **Miroir syslog vers USB** sont maintenant disponibles au prochain démarrage sous ***Outils > Syslog*** et dans diagnostics
- Gestionnaire VM: Correction pour la rétrogradation : si le modèle de VM a été mis à jour vers le dernier type de machine QEMU, il ne sera pas trouvé lors de la rétrogradation. Ce changement trouve la version actuelle la plus récente pour un type de machine donné.
- ZFS : Utiliser le drapeau d'importation zpool "-f" pour permettre l'importation de pools étrangers
- Autres :
  - Activer l'amorçage EFI par défaut pour les nouvelles installations
  - Correction du ralentissement sur les pages de Dashboard et Docker (et réduit l'écriture sur périphérique flash)
  - Formatage : ne pas initialiser la disposition des partitions de périphériques si elle est déjà valide.
  - Mise à jour du système d'exploitation : refonte des pages de mise à jour et de rétrogradation du système d'exploitation, voir [article de blog](https://unraid.net/blog/new-update-os-tool)
  - Correction de l'incapacité de MacOS à écrire sur le partage 'flash' et rétablissement de la compatibilité Time Machine (changements fruit)
  - Permettre aux Applications Communautaires (si installées) de démarrer automatiquement les conteneurs lors d'une installation multiple
  - Formulaire de retour : changer le bouton TERMINÉ en ANNULER

### Mises à jour des packages

- docker : version 24.0.9
- kernel-firmware : version 20231226\_abfcad8

### Noyau Linux

- version 6.1.74
  - CONFIG\_USB\_SERIAL\_XR : Pilote USB MaxLinear/Exar pour port série
  - CONFIG\_CAN : Support du sous-système de bus CAN
  - CONFIG\_CAN\_NETLINK : Pilotes de périphériques CAN avec support Netlink
  - CONFIG\_CAN\_GS\_USB : Interfaces compatibles Geschwister Schneider UG et candleLight
  - CONFIG\_SCSI\_LPFC : Support de la fibre optique Emulex LightPulse

## Correctifs

Avec le plugin Unraid Patch installé, visitez ***Outils → Unraid Patch*** pour obtenir les correctifs / corrections à chaud suivants :

- Un sous-ensemble de mises à jour de sécurité, voir [ce blog post](https://unraid.net/blog/cvd) pour les détails. Nous recommandons de mettre à niveau vers la dernière version stable pour des mises à jour de sécurité supplémentaires.
