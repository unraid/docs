---
sidebar_position: 7
sidebar_label: WireGuard
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import WireGuardConfigureMobile from './partials/wireguard-configure-mobile.mdx';
import WireGuardConfigureOtherDevices from './partials/wireguard-configure-other-devices.mdx';

# WireGuard

Während Tailscale für die meisten eine benutzerfreundliche Erfahrung bietet, ist [WireGuard](https://www.wireguard.com/) eine robuste, integrierte VPN-Lösung in Unraid, die sich in bestimmten fortgeschrittenen Netzwerkszenarien hervorhebt. Besonders nützlich ist sie, wenn Sie detaillierte Kontrolle über das VPN-Routing benötigen oder server-zu-server- oder LAN-zu-LAN-Verbindungen ohne Drittanbieterdienste aufbauen müssen. Nachfolgend sind Schlüssel-Szenarien aufgeführt, in denen WireGuard überzeugt.

<h4>Wann sollte man WireGuard wählen?</h4>

| Szenario                          | Warum %%WireGuard\|wireguard%% wählen?                                                                                      |
| --------------------------------- | --------------------------------------------------------------------------------------------------------------------------- |
| **Erweiterte Konfiguration**      | Ermöglicht individuelle %%VPN-Tunnel\|vpn-tunnel%%-Konfigurationen und die Integration in bestehende Netzwerk-Infrastruktur |
| **Server-zu-Server-Tunnel**       | Ermöglicht das Erstellen von persistenten verschlüsselten Verbindungen zwischen Unraid-Servern                              |
| **LAN-zu-LAN-Integration**        | Verbindet ganze Netzwerke ohne Zwischendienste                                                                              |
| **Bandbreitenintensive Aufgaben** | Bietet minimalen Protokolloverhead für maximale Durchsatzrate                                                               |

:::info

For most users, [**Tailscale**](../secure-your-server/tailscale.mdx) can accomplish everything that WireGuard can do, often more easily. It typically doesn’t require port forwarding or manual configuration. However, if you need advanced, custom VPN setups or have specific compatibility requirements, choosing WireGuard may be a better option for some.

:::

<h4>Verbindungstypen und Anwendungsfälle</h4>

Das Wissen über Verbindungstypen in %%WireGuard|wireguard%% kann Ihnen dabei helfen zu entscheiden, ob es das Richtige für Sie ist:

| Verbindungstyp                  | Praktischer Anwendungsfall                                                                                                  |
| :------------------------------ | :-------------------------------------------------------------------------------------------------------------------------- |
| Fernzugriff auf Server          | Zugriff auf Unraid %%WebGUI\|web-gui%%, Docker-Container, %%VM\|vm%%s und Netzfreigaben aus der Ferne.                      |
| Fernzugriff auf LAN             | Greifen Sie auf alle Geräte in Ihrem LAN remote zu, als wären Sie im lokalen Netzwerk.                                      |
| Server-zu-Server-Zugang         | Verbinden Sie sicher zwei Unraid-Server für Datenaustausch oder Backup.                                                     |
| LAN-zu-LAN-Zugriff              | Verbinden Sie nahtlos zwei ganze LANs für eine reibungslose Kommunikation zwischen Netzwerken.                              |
| Server Hub-und-Speichen-Zugriff | Ermöglichen Sie mehreren VPN-Clients, über den Server miteinander zu verbinden.                                             |
| LAN-Hub & Spoke-Zugriff         | Kommunikation zwischen mehreren LANs über einen zentralen Server ermöglichen.                                               |
| VPN-getunnelter Zugang          | Route specific Docker containers and %%VM\|vm%%s through a commercial %%WireGuard\|wireguard%% VPN provider.                |
| Ferngetunnelter Zugriff         | Routen Sie Ihren gesamten Internetverkehr sicher über Ihren Unraid-Server, wenn Sie sich in unsicheren Netzwerken befinden. |

## Einrichten von WireGuard auf Unraid

:::note\[Prerequisites]

- **Dynamic DNS:** Set up DDNS for reliable access if your public IP changes. Popular options include [Cloudflare](https://www.cloudflare.com/) (requires domain ownership), [No-IP](https://www.noip.com/), or [DuckDNS](https://www.duckdns.org/) (free but may experience occasional outages).
- **Routerkonfiguration:**
  - Aktivieren Sie %%UPnP|upnp%% in den ***Einstellungen → Management Zugang*** für automatische Portweiterleitung.
  - Wenn %%UPnP|upnp%% nicht verfügbar ist, leiten Sie UDP-Port 51820 manuell an die IP Ihres Unraid-Servers weiter.
- **Client-Software:** Installieren Sie %%WireGuard|wireguard%% auf Ihren Geräten ([Windows](https://www.wireguard.com/install/), [macOS](https://apps.apple.com/us/app/wireguard/id1451685025), [iOS](https://apps.apple.com/us/app/wireguard/id1441195209), [Android](https://play.google.com/store/apps/details?id=com.wireguard.android)).

:::

<h4>Schritt 1: Schlüssel generieren</h4>

1. Gehen Sie zu ***Einstellungen → VPN-Manager***.

<div style={{ margin: 'auto', maxWidth: '600px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
  ![VPN Manager](/img/wg0.png)
</div>

2. Benennen Sie Ihren Tunnel (z.B. "Home VPN").
3. Klicken Sie auf **Schlüsselpaar generieren**, um öffentliche/private Schlüssel zu erstellen.

:::warning

Bewahren Sie den privaten Schlüssel sicher auf, da er vollen Netzwerkzugriff gewährt.

:::

<h4>Schritt 2: Konfigurieren Sie Ihren Endpunkt</h4>

- **Für DDNS-Nutzer:** Ersetzen Sie die IP in **Lokaler Endpunkt** durch Ihre DDNS-URL (z.B. `myhome.duckdns.org`).
- Behalten Sie den Standardport (`51820`), es sei denn, es gibt Konflikte mit bestehenden Diensten.

<h4>Schritt 3: Portweiterleitung einrichten</h4>

- **%%UPnP|upnp%%-Nutzer:** Unraid wird automatisch Ports weiterleiten, wenn in **Einstellungen → Management Zugang** aktiviert.

<div style={{ margin: 'auto', maxWidth: '600px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
  ![UPnP aktiviert](/img/upnp-yes.png)
</div>

- **Manuelle Einrichtung:** Wenn %%UPnP|upnp%% nicht verfügbar ist:
  1. Melden Sie sich bei Ihrem Router an.
  2. Leiten Sie UDP-Port `51820` an die LAN-IP Ihres Unraid-Servers weiter.
  3. Verwenden Sie denselben Port für externe und interne Einstellungen.

<div style={{ margin: 'auto', maxWidth: '600px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
  ![UPnP deaktiviert](/img/upnp-no.png)
</div>

<h4>Schritt 4: Aktivieren Sie Ihren Tunnel</h4>

1. Schalten Sie **Aktiv** um %%WireGuard|wireguard%% zu aktivieren.
2. Aktivieren Sie **Autostart**, um %%WireGuard|wireguard%% beim Start auszuführen.

<div style={{ margin: 'auto', maxWidth: '600px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
  ![Aktivierungsumschalter](/img/activate.png)
</div>

:::important[Security best Practices]

- **Nur vertrauenswürdiger Zugriff:** VPN-Zugriff ist mit physischem Netzwerkzugriff vergleichbar, deshalb sollten nur vertrauenswürdige Geräte autorisiert werden.
- **Schlüsselverwaltung:** Niemals private Schlüssel teilen; behandeln Sie sie wie Passwörter.
- **Netzwerksegmentierung:** Für komplexe Setups (benutzerdefinierte Docker/%%VM|vm%%s), isolieren Sie VPN-Verkehr mithilfe von VLANs oder separaten Subnetzen.
- **Regelmäßige Audits:** Überprüfen Sie quartalsweise verbundene Geräte und Zugriffsberechtigungen.

:::

### Definieren eines Peers (Clients)

A peer is a client device - such as a phone, laptop, or another server - that connects to your Unraid %%WireGuard|wireguard%% VPN. Defining a peer means creating a unique identity and securing keys for that device.

1. Wählen Sie **Peer hinzufügen**.

<div style={{ margin: 'auto', maxWidth: '600px', display: 'flex', flexDirection: 'column', alignItems: 'center' }}>
  ![Peer hinzufügen](/img/peer-add.png)
</div>

2. Benennen Sie den Peer (z.B. *MyAndroid*).
3. Wählen Sie den initialen Verbindungstyp für vollen Netzwerkzugriff, typischerweise *Remote-Zugriff auf LAN*.
4. Click **Generate Keypair** to create public and private keys. Keep the private key secure.
5. Erstellen Sie optional einen vorab geteilten Schlüssel für zusätzliche Sicherheit.
6. Klicken Sie auf **Übernehmen**.

:::note

Während Peers ihre eigenen Schlüssel generieren können, vereinfacht das Generieren von Schlüsseln durch Unraid das Setup, indem vollständige Konfigurationsdateien bereitgestellt werden.

:::

:::caution

Adding a new peer can temporarily disable the %%WireGuard|wireguard%% tunnel, which may interrupt your connection. Ensure you have local access to your server before making changes.

:::

### Konfiguration eines Peers (Clients)

<Tabs>
  <TabItem value="mobil" label="Mobiles Gerät" default>
    <WireGuardConfigureMobile />
  </TabItem>

  <TabItem value="sonstige" label="Andere Geräte">
    <WireGuardConfigureOtherDevices />
  </TabItem>
</Tabs>

### Konfiguration Ihres DNS

1. Greifen Sie auf Geräte mit IP-Adressen oder vollständig qualifizierten Domain-Namen (z.B. `yourpersonalhash.unraid.net`) zu.

:::note

Kurznamen wie "tower" oder vom Router verwaltete DNS-Einträge funktionieren möglicherweise nicht über das VPN.

:::

2. Um die Auflösung von Kurznamen zu ermöglichen:
   - Gehen Sie zu ***Einstellungen → VPN-Manager*** in Unraid.
   - Wechseln Sie von **Basis** zu **Erweitert**.
   - Geben Sie die IP-Adresse Ihres bevorzugten DNS-Servers im Feld **Peer-DNS-Server** ein.
   - Speichern Sie die Änderungen und aktualisieren Sie die Client-Konfigurationsdatei.
3. Empfohlene DNS-Server:
   - Die IP-Adresse des LAN-Routers.
   - Öffentliche DNS-Server wie `8.8.8.8`.

Diese Einrichtung ist besonders wichtig für **Remote getunnelten Zugang**-Modus, bei dem der ursprüngliche DNS-Server des Clients möglicherweise nicht erreichbar ist.

:::note

%%mDNS|mdns%%-Adressen (z.B., `tower.local`) funktionieren nur im lokalen Netzwerk und nicht über %%WireGuard|wireguard%% VPN.

:::

### Komplexe Netzwerke

For most users, the default **Use NAT** setting works out of the box and allows access to Unraid and most LAN devices. However, if you use Docker containers with custom IPs or %%VM|vm%%s with strict networking requirements:

1. Stellen Sie in Ihrer %%WireGuard|wireguard%%-Tunnel-Konfiguration die Option **NAT verwenden** auf **Nein**.
2. Fügen Sie auf Ihrem Router eine statische Route für das WireGuard-Tunnelnetzwerk (z.B. `10.253.0.0/24`) hinzu, die auf die IP Ihres Unraid-Servers zeigt.
3. In ***Einstellungen → Docker-Einstellungen*** stellen Sie **Zugriff für benutzerdefinierte Netzwerke** auf **Aktiviert**.

### Konfigurationen, die vermieden werden sollten

| NAT-Einstellung verwenden | Host-Zugang zu benutzerdefinierten Netzwerken | Server & Dockers (Bridge/Host) | %%VMs\|vm%% & other LAN systems | Dockers mit benutzerdefinierter IP | Anmerkungen                                                                  |
| ------------------------- | --------------------------------------------- | ------------------------------ | ------------------------------- | ---------------------------------- | ---------------------------------------------------------------------------- |
| Ja                        | Deaktiviert (statische Route optional)        | Zugänglich                     | Zugänglich                      | Nicht zugänglich                   | Einfaches Netzwerk-Setup; empfohlen für die meisten Benutzer                 |
| Ja                        | Aktiviert (statische Route optional)          | Zugänglich                     | Nicht zugänglich                | Nicht zugänglich                   | Diese Konfiguration vermeiden                                                |
| Nein                      | Deaktiviert (Keine statische Route)           | Zugänglich                     | Nicht zugänglich                | Nicht zugänglich                   | Vermeiden; erfordert eine statische Route, um ordnungsgemäß zu funktionieren |
| Nein                      | Deaktiviert (Mit statischer Route)            | Zugänglich                     | Zugänglich                      | Nicht zugänglich                   | Fast korrekt; Host-Zugriff für benutzerdefinierte Netzwerke aktivieren       |
| Nein                      | Aktiviert (Mit statischer Route)              | Zugänglich                     | Zugänglich                      | Zugänglich                         | Empfohlenes Setup für komplexe Netzwerke                                     |

## Fehlerbehebung für WireGuard

WireGuard is designed to be unobtrusive - if something isn’t working, it won’t provide error messages. To troubleshoot effectively, you should systematically check each aspect of your setup.

#### Verbindungskontrollliste

- ✅ The tunnel is active on both Unraid and client devices. *("Active" means the tunnel has started but is not necessarily connected.)*
- ✅ DDNS-URL zeigt auf Ihre aktuelle öffentliche IP und ist im **Lokalen Endpunkt** festgelegt.
- ✅ Der korrekte UDP-Port wird von Ihrem Router auf Unraid weitergeleitet und stimmt mit dem **Lokalen Endpunkt**-Port überein.
- ✅ Clients haben die neuesten Konfigurationsdateien nach Änderungen auf der Serverseite.
- ✅ Änderungen werden gespeichert, bevor Peer-Konfigurationen (QR-Codes/Dateien) eingesehen oder verteilt werden.

#### Zusätzliche Fehlerbehebungsmaßnahmen

<details>
  <summary><strong>Erste Setup-Tipps</strong> – Klicken zum Erweitern/Zusammenklappen</summary>

  Wenn Sie zum ersten Mal WireGuard einrichten, können Ihnen diese Tipps helfen, häufige Fallstricke zu vermeiden:

  - Richten Sie Ihren ersten Client mithilfe eines Mobilgeräts im Mobilfunknetz (nicht WLAN) ein, um lokale Netzwerkprobleme auszuschließen.
  - Verwenden Sie die QR-Code-Methode für den einfachsten Konfigurationstransfer.
</details>

<details>
  <summary><strong>Handshake- und Konnektivitätsprobleme</strong> – Klicken zum Erweitern/Zusammenklappen</summary>

  Wenn Sie keinen Handshake sehen oder keine Verbindung herstellen können, versuchen Sie diese gezielten Überprüfungen:

  - Wenn Sie keinen Handshake sehen, versuchen Sie, den Verkehr zu erzeugen (zum Beispiel den Server anzupingen), um die Verbindung auszulösen.
  - Deaktivieren Sie Energiespar-, Datenspar- oder Batteriesparfunktionen auf mobilen Clients, da diese die VPN-Funktion beeinträchtigen können.
  - Stellen Sie sicher, dass Client- und Servernetzwerke unterschiedliche Subnets verwenden (z. B. sollten beide nicht `192.168.1.0/24` verwenden).
  - If using Cloudflare for DDNS, set **Proxy status** to **DNS only** (not **Proxied**). Allow time for DNS changes to propagate.
  - If you can connect from some locations but not others, the remote network may block UDP traffic. %%WireGuard|wireguard%% currently does not support TCP as a fallback.
</details>

<details>
  <summary><strong>Erweiterte Netzwerkkonflikte</strong> - Klicken zum Erweitern/Zusammenklappen</summary>

  Wenn Ihre Netzwerkeinrichtung komplexer ist oder Sie einen IP-Konflikt vermuten, prüfen Sie diese erweiterten Fehlerbehebungsschritte:

  - In **Advanced** mode, confirm that your **Local tunnel network pool** does not overlap with any existing network on either side. If there’s a conflict, change to a different private subnet (for example, `10.10.10.0/24`).
  - Für Docker-Container mit benutzerdefinierten IPs oder %%VM|vm%%s mit strengen Anforderungen siehe den Abschnitt [Komplexe Netzwerke](#complex-networks).
</details>

<details>
  <summary><strong>Notfallwiederherstellung</strong> - Klicken zum Erweitern/Zusammenklappen</summary>

  Wenn Sie den Zugriff auf die Unraid %%WebGUI|web-gui%% verlieren und das automatische Starten von %%WireGuard|wireguard%% deaktivieren müssen

  - Löschen Sie `/boot/config/wireguard/autostart` von Ihrem Flash-Laufwerk und starten Sie neu.
</details>

\* *„%%WireGuard|wireguard%%“ und das „%%WireGuard|wireguard%%“-Logo sind eingetragene Warenzeichen von Jason A. Donenfeld.*
