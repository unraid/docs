---
sidebar_position: 4
sidebar_label: 保护您的连接
---

# 保护您的连接

使用%%SSL|ssl%%加密保护你的Unraid %%WebGUI|web-gui%%安全，保护敏感数据（如登录凭证和配置细节）免于在本地网络或互联网被截取或篡改。你可以使用由[Let's Encrypt](https://letsencrypt.org/)在本地及[Unraid Connect远程访问](../../../unraid-connect/remote-access.mdx)场景下获得的通配符%%SSL|ssl%%证书。

:::important[The SSL 的重要性]
%%SSL|ssl%% (Secure Sockets Layer) encrypts all traffic between your browser and the Unraid server, preventing eavesdropping and man-in-the-middle attacks. Without %%SSL|ssl%%, anyone with access to your network could potentially intercept sensitive data or hijack your session. Using %%SSL|ssl%% is strongly recommended for both local and remote management of your Unraid server.
:::

---

## SSL 参数

Several parameters in Unraid affect how %%SSL|ssl%% is configured and used. Understanding these helps you choose the right certificate and connection method for your needs.

| Parameter          | 描述                                                                    |
| ------------------ | --------------------------------------------------------------------- |
| **Server name**    | Set in ***Settings → Identification***. Default is `tower`.           |
| **Local TLD**      | Set in ***Settings → Management Access***. Default is `local`.        |
| **Use SSL/TLS**    | 在 ***设置 → 管理访问***中设置，控制%%SSL\|ssl%%是否启用。                              |
| **HTTP port**      | Set in ***Settings → Management Access***. Default is `80`.           |
| **HTTPS port**     | Set in ***Settings → Management Access***. Default is `443`.          |
| **Certificate**    | Type of %%SSL\|ssl%% certificate used (see below).                    |
| **Lan ip**         | Your server's LAN IP address, formatted for use in URLs.              |
| **Wan ip**         | Your server's public IP address, formatted for use in URLs.           |
| **%%Hash\|hash%%** | Unique 40-character identifier assigned to your server's certificate. |

### SSL 证书类型

| 类型               | When to use                                                                                       | Pros/Cons                                                                          |
| ---------------- | ------------------------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------- |
| **Self-signed**  | For local-only access when you don't need a trusted certificate.                                  | 容易设置，但浏览器会显示警告。接收警告后流量被加密。                                                         |
| **Myunraid.net** | For secure local and remote access, especially with Unraid Connect or if you want a trusted cert. | Trusted by browsers, no warnings. Enables secure remote access via Unraid Connect. |
| **Custom**       | 对于需要通配符或自定义域证书的高级用户（需要 %%DNS\|dns-name-resolution%% 配置）。                                          | Trusted, flexible, but requires additional setup.                                  |

---

## 访问您的 WebGUI 的方式

以下是在不同 %%SSL|ssl%% 配置下访问您的 Unraid %%WebGUI|web-gui%% 的主要方式：

#### 仅 HTTP（未加密）

<details>
  <summary><strong>Click to expand/collapse</strong></summary>

  With HTTP only, traffic between your browser and the server is not encrypted.

  1. 转到***设置 → 管理访问***。
  2. 将 **使用 SSL/TLS** 设置为*否*。
  3. 将 **本地 TLD** 保持为 `local`，除非您拥有自己的 DNS。
  4. 访问 URL：
     - `http://[服务器名].[本地 TLD]` （例如：`http://tower.local`）
     - `http://[ip 地址]` （例如：`http://192.168.100.1`）
  5. 点击 **应用**。

  :::warning
  Anyone on your network can intercept data sent over HTTP. Use HTTPS whenever possible.
  :::
</details>

---

#### HTTPS 配合自签名证书

<details>
  <summary><strong>Click to expand/collapse</strong></summary>

  Traffic is encrypted, but browsers will display a warning because the certificate is not signed by a trusted authority.

  1. 转到***设置 → 管理访问***。
  2. 将 **使用 SSL/TLS** 设置为*是*。
  3. 将 **本地 TLD** 保持为 `local`，除非您拥有自己的 DNS。
  4. 访问 URL：
     - `https://[服务器名].[本地 TLD]` （例如：`https://tower.local`）
     - `https://[ip 地址]` （例如：`https://192.168.100.1`）
  5. 点击 **应用**。

  :::important
  Browsers will show a certificate error. All traffic is still encrypted after you accept the warning.
  :::
</details>

---

#### 用 Myunraid.net 证书和备用 URL 的 HTTPS 访问

<details>
  <summary><strong>Click to expand/collapse</strong></summary>

  You can access your server securely via the %%WebGUI|web-gui%% using a Myunraid.net certificate, and configure a fallback URL in case your %%DNS|dns-name-resolution%% resolution is down. All traffic will be encrypted, and the server is configured to fall back to a secondary method when %%DNS|dns-name-resolution%% is unavailable.

  1. 转到***设置 → 管理访问***。
  2. 保持 **本地 TLD** 的默认值 `local`，除非您可以提供自己的 DNS 名称解析（用于备用证书）。
  3. 将 **使用 SSL/TLS** 设置为*否*或*是*。
  4. 按下 **生成** 来生成 myunraid.net 证书。

  **Your primary URLs when Use SSL/TLS is set to *No*:**

  - `http://[服务器名].[本地 TLD]` （例如：`http://tower.local`）
  - `http://[ip 地址]` （例如：`http://192.168.100.1`）

  **Your primary URLs when Use SSL/TLS is set to *Yes* (uses self-signed certificate):**

  - `https://[服务器名].[本地 TLD]` （例如：`https://tower.local`）
  - `https://[ip 地址]` （例如：`https://192.168.100.1`）

  **Your alternate myunraid.net URL:**

  - `https://[lan-ip].[hash].myunraid.net` （例如：`https://192-168-100-1.a1b2c3d4e5.myunraid.net`）
  - 此 URL 显示在 **访问管理** 页面的 **本地访问 URL** 字段中。
  - 如果您安装了 [Unraid Connect 插件](../../../unraid-connect/overview-and-setup.mdx)，它也会显示在 Connect 仪表板上。

  :::info
  The myunraid.net certificate is trusted by browsers and does not display warnings. The URL uses your LAN IP address with dots changed to dashes, plus a unique 40-character %%hash|hash%% assigned to your server.
  :::

  :::tip[Fallback access]
  If %%DNS|dns-name-resolution%% resolution becomes unavailable (e.g., your Internet goes down), you can use the local URLs with your server name or IP address as backup access methods.
  :::
</details>

#### 用 Myunraid.net 证书且无备用 URL 的 HTTPS 访问

<details>
  <summary><strong>Click to expand/collapse</strong></summary>

  This method provides the highest level of %%SSL|ssl%% enforcement by requiring all %%WebGUI|web-gui%% access to use the Myunraid.net certificate and URL. It is ideal for users who want maximum security and do not need to access their server via local IP or hostname if %%DNS|dns-name-resolution%% is unavailable.

  1. 在 %%WebGUI|web-gui%% 中的 ***设置 → 访问管理***。
  2. 保持 **本地 TLD** 设置为 `local`，除非您有自己的 %%DNS|dns-name-resolution%% 名称解析（用于备用证书，如果您稍后运行 `use_ssl` 命令）。
  3. 点击 **生成** 来生成 Myunraid.net 证书。
  4. 如果您的网络没有 %%DNS|dns-name-resolution%% 重新绑定问题，**使用 SSL/TLS** 的*严格*选项将可用。
  5. 将 **使用 SSL/TLS** 设置为*严格*（或早期 Unraid 版本中的*自动*）。
  6. 您的访问 URL 将是：\
     `https://[lan-ip].[hash].myunraid.net` （例如：`https://192-168-100-1.a1b2c3d4e5.myunraid.net`）

     如果您安装了 [Unraid Connect 插件](../../../unraid-connect/overview-and-setup.mdx)，它也会显示在 Connect 仪表板上。

  :::caution
  If %%DNS|dns-name-resolution%% resolution becomes unavailable (e.g., your Internet connection goes down), you will not be able to access the %%WebGUI|web-gui%% using the Myunraid.net URL.

  To regain access:

  - 使用 Telnet、%%SSH|ssh%% 或本地键盘/显示器登录。
  - 运行 `use_ssl no` 切换到 HTTP （`http://[服务器名].[本地 TLD]` 或 `http://[ip 地址]`）。
  - 运行 `use_ssl yes` 切换到使用自签名证书的HTTPS（`https://[服务器名].[本地TLD]` 或 `https://[ip地址]`）。查看上面的[HTTPS与自签名证书](#https-with-self-signed-certificate)了解更多细节。
  - Once %%DNS|dns-name-resolution%% is restored, set **Use SSL/TLS** back to *Strict* for full security.
    :::
</details>

---

## 重定向

当您访问 `http://[服务器名].[本地 TLD]` 时，重定向行为取决于您的 **使用 SSL/TLS** 设置：

- **Strict**: You will be redirected to `https://[lan-ip].[hash].myunraid.net`.
  :::note
  This can make local access difficult if %%DNS|dns-name-resolution%% is unavailable. See the caution under [HTTPS with Myunraid.net certificate and with no fallback URL](#https-with-myunraidnet-certificate-and-with-no-fallback-url).
  :::

- **是**：您将被重定向到 `https://[服务器名].[本地TLD]`。即使互联网连接断开，这仍然有效。

- **否**：HTTP URL 将直接加载，无重定向或加密。

:::tip
重定向仅在您从 HTTP URL 开始时才有效，而不是 HTTPS URL。
:::

---

## 自定义证书

自定义证书允许您使用自己的 %%SSL|ssl%% 证书，如由商业证书颁发机构签发的证书或域的通配符证书来保护 Unraid %%WebGUI|web-gui%%。

A custom certificate is any %%SSL|ssl%% certificate that you provide and manage yourself, rather than one generated by Unraid or Let's Encrypt. This is useful if you want to use your own domain name, a wildcard certificate, or integrate with your organization's PKI infrastructure.

:::info[When 使用自定义证书，您有责任...]

- 从可信的证书颁发机构（CA）采购证书
- 管理所选域的 %%DNS|dns-name-resolution%% 记录
- 根据需要上传和更新证书
- Ensuring the certificate matches your server's domain name (in the Subject or Subject Alternative Name fields)
  :::

如果您的证书无效或与服务器的 URL 不匹配，Unraid 将删除它并恢复为默认证书。

### HTTPS 配合自定义证书（可选的 Unraid Connect 远程访问）

<details>
  <summary><strong>Access via HTTPS with custom certificate</strong> - Click to expand/collapse</summary>

  1. 转到***设置 → 管理访问***。
  2. 将 **使用 SSL/TLS** 设置为*是*。
  3. 将 **本地 TLD** 设置为证书主题中的域名。
  4. 访问服务器地址为 `https://[服务器名].[本地TLD]`（例如，`https://tower.mydomain.com`）。您必须管理此URL的DNS。
  5. 将您的证书上传到 `/boot/config/ssl/certs/[服务器名]_unraid_bundle.pem`。
  6. 证书必须对 `[服务器名].[本地 TLD]` 或通配符 `*.[本地 TLD]` 有效（其中 `[本地 TLD]` 与您在 **本地 TLD** 字段中输入的完全相符）。
     - 域必须出现在主题或主题备用名称字段中（Unraid 6.10.3+ 支持 SANs）。
     - 如果证书不匹配，Unraid 将删除它。
  7. 可选启用 [Unraid Connect 远程访问](../../../unraid-connect/remote-access.mdx) 以实现安全、浏览器受信任的远程管理。

  :::tip
  For wildcard certificates, ensure the certificate's Subject Alternative Name or Subject field contains `*.[localTLD]` where `[localTLD]` is the exact value you entered in the **Local TLD** field in **Management Access**.
  :::
</details>

---

## SSL 故障排除和高级配置

本节介绍了一些关于使用 myunraid.net 证书的常见 SSL 相关问题和高级配置选项，无论您是否安装了 Unraid Connect。

### DNS 重绑定保护

DNS rebinding protection is a security feature on many routers that prevents public DNS entries from resolving to local IP addresses. This helps protect your network from certain attacks, but can cause issues when trying to use %%SSL|ssl%% certificates for local access to the Unraid %%WebGUI|web-gui%%.

如果在尝试提供 %%SSL|ssl%% 证书时遇到DNS重绑定错误（例如，点击 **提供** 按钮后），请考虑以下步骤：

- 在错误信息上点击 **确定**，等待2至5分钟，然后重试。
- 如果错误仍然出现，请检查路由器设置中与“DNS重绑定保护”或类似术语相关的选项。
- 允许对 `myunraid.net` 域进行DNS重绑定。
- 请记住，DNS更改需要时间传播，因此在更新后可能会再次看到错误。

具体步骤可能根据您的路由器型号和固件而有所不同。

### 当DNS失效时访问服务器

当 %%SSL|ssl%% 开启并使用 myunraid.net 证书时，通常通过一个完全限定域名（FQDN）访问 Unraid 服务器，例如：

```
https://ip.yourpersonalhash.myunraid.net
```

或者，如果您使用自定义HTTPS端口：

```
https://ip.yourpersonalhash.myunraid.net:<https_port>
```

这确保您正在使用有效的%%SSL|ssl%%证书进行安全访问。不过，如果互联网连接中断且浏览器尚未缓存DNS条目，您可能会失去对%%WebGUI|web-gui%%的访问。

如果您失去了DNS或互联网访问：

- 如果**使用SSL/TLS**设置为**是**，请尝试访问您的服务器：
  ```
  https://[servername].[localTLD]
  ```
  或者使用自定义端口：
  ```
  https://servername.[localTLD]:<https_port>
  ```

- 如果这不起作用，或者 **使用SSL/TLS** 设置为 **严格**：
  1. 使用telnet、%%SSH|ssh%% 或直接连接的键盘/显示器登录到您的服务器。
  2. 运行命令：
     ```bash
     use_ssl no
     ```
  3. 您现在可以在以下位置访问 %%WebGUI|web-gui%% ：
     ```
     http://<ip_address>
     ```
     或者，如果使用自定义端口：
     ```
     http://<server_ip>:<http_port>
     ```
     （注意：这使用的是HTTP，而不是HTTPS。）

互联网访问恢复后，前往***设置→管理访问***并将 **使用SSL/TLS** 设置回 **严格** 以重新启用本地SSL。

### 禁用本地访问的SSL

如果您希望在受信的家庭网络上使用简单的HTTP连接，或面临 %%SSL|ssl%% 证书提供、DNS重绑定或浏览器兼容性的问题，应禁用本地访问的 %%SSL|ssl%% 。

要禁用本地访问的 %%SSL|ssl%% ：

1. 在 WebGUI 中，转到 ***Settings → Management Access***。
2. 将 **使用SSL/TLS** 设置为 **否**。
3. 点击 **应用**。

此更改还将禁用远程访问功能，因为 %%SSL|ssl%% 对于安全的远程连接是必要的。

:::caution
禁用%%SSL|ssl%%意味着你的%%WebGUI|web-gui%%将通过未加密的HTTP访问。这会将你的登录凭证和会话数据暴露给任何在你本地网络上的人，除非你对你的网络安全性有信心且不需要远程访问，否则不推荐这样做。为确保最佳安全性，请尽可能保持启用%%SSL|ssl%%。
:::

:::note
%%SSL|ssl%% management is a core feature of Unraid and does not rely on the Unraid Connect plugin. You can disable %%SSL|ssl%% without affecting other Unraid functionality.
:::
