---
sidebar_position: 1
sidebar_label: 安全基础
---

# 安全基础

:::note[Principle 最低权限]
The principle of least privilege means granting users and devices only the minimum access necessary to perform their tasks, never more. This approach limits potential damage from compromised accounts or accidental actions and is a core concept in modern security, including zero trust models. Apply this principle throughout your Unraid configuration, especially when creating share users and assigning permissions.
:::

## Controlling access to shared folders

### Choosing a network file sharing protocol

When sharing files with your Unraid server over your home or office network, you have some choices about how to connect. Unraid supports popular methods, known as communication protocols, that help devices talk to each other.

| Protocol                              | Primary Use                      | Advantage                                                                         | Disadvantage                                                                           | Recommended Use Cases                                                                                           |
| ------------------------------------- | -------------------------------- | --------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------- |
| %%SMB\|samba%% (Server Message Block) | Native Windows/macOS integration | Built-in Windows support; supports printers and VM storage; fast with large files | Older versions (SMBv1) insecure; slower with small files                               | Windows and Mac networks; mixed resource environments (printers, VMs)                                           |
| %%NFS\|nfs%% (Network File System)    | Native Unix/Linux integration    | Optimized for Linux/Unix; efficient with small files; low overhead                | Requires extra tools for Windows; network reliability critical; limited locking        | Linux and Unix environments; small file operations; static data workloads                                       |
| %%FTP\|ftp%% (File Transfer Protocol) | Cross-platform compatibility     | Universal client support; simple setup; batch file transfers                      | Plaintext protocol with no encryption; credentials sent unencrypted; outdated security | Non-sensitive or legacy transfers only; use FTPS (FTP over TLS) or SFTP (FTP over SSH) for secure file transfer |

:::important
Starting with Unraid version 6.9, support for **%%AFP|AFP%% (Apple Filing Protocol)** has been removed. To ensure that your Mac computers work well with your Unraid server, including features like Time Machine backups, go to ***Settings → SMB*** and turn on **Enhanced macOS interoperability**.
:::

Deciding which protocol to use depends on the types of devices you have and what you need to do with your files. By default, Unraid enables %%SMB|samba%% because it's widely supported by modern Windows and macOS systems. %%NFS|nfs%% and %%FTP|ftp%% are turned off but can be enabled if needed.

For instance, if you use an %%FTP|ftp%% client to connect to your Unraid server, you can easily transfer large files and even pause and resume your uploads or downloads if needed.

---

### Managing network visibility of shares

You can set up different access permissions for your network folders (shares) in Unraid by:

1. **Go to the Shares Tab**: Start by clicking on the **Shares** tab in the %%WebGUI|web-gui%%.

2. **Select a Share**: Choose an existing share that you want to adjust.

3. **Scroll to Security Settings**: At the bottom of the share settings page, you’ll see a section for security options for each network protocol that is enabled.

4. **Adjust the Export Setting**: This setting controls how the share appears on the network. You have three options:

   - **Yes**: The share is visible and anyone browsing the network can access it.
   - **Yes (Hidden)**: The share won’t show up in the network browse lists, but if someone knows the name of the share, they can still access it.
   - **No**: The share is completely hidden and not accessible through that specific protocol.

By tweaking these options, you can manage who can see and access each share, making it easier to keep everything secure while ensuring the right people have the access they need, whether they are using %%SMB|samba%%, %%NFS|nfs%%, or %%FTP|ftp%% connections.

---

### Setting user permissions for shares

Share security controls how users access shared files on your system. You can set up a share to require a username and password for accessing files, limit access to read-only, or make it completely public with no credentials needed.

:::note\[Example]

If you create a `movies` share on your Unraid server, you can choose whether to require a valid username and password just for reading data or allow public access. If you need to add users, a %%root user|root-user%% can create share users by following the process in [**User management**](./user-management.mdx#add-users).

:::

When you go to the **Shares** tab and select a share, you'll see its settings, including a security section where you can manage [access permissions](#managing-network-visibility-of-shares) based on the protocols you have enabled. This way, you can tailor who has access to your files depending on their needs.

The **Security** setting has the following options:

| Type        | Explanation                                                          | Common Use Case                                                                   |
| ----------- | -------------------------------------------------------------------- | --------------------------------------------------------------------------------- |
| **Public**  | Open access: Everyone can read and write to this folder.             | Suitable for non-sensitive information, like shared media or public downloads.    |
| **Secure**  | Limited access: Everyone can read, but only certain users can write. | Good for shared projects where collaboration is needed, like team folders.        |
| **Private** | Restricted access: Only specific users can read or write.            | Ideal for sensitive information, such as financial records or personal documents. |

:::caution[Windows SMB access]
Modern versions of Windows (Windows 10 1709+, Windows 11, Server 2019+) block access to **Public** (guest/anonymous) %%SMB|samba%% shares by default, due to stricter security policies. Attempting to connect to a public share will usually fail unless you manually enable insecure guest logons in Windows settings - which is not recommended for security reasons.

**最佳实践：** 为您的 Unraid 共享设置用户帐户和密码，并使用这些凭据从 Windows 可靠访问。

**凭证限制：** Windows每次仅允许对一个服务器使用一组登录凭证。如果尝试使用不同凭证连接同一服务器上的不同共享，连接将失败。

**解决方法：** 如果遇到凭证问题，请尝试使用服务器名称连接一个共享，而使用其IP地址连接另一个共享。Windows将它们视为不同的服务器。

For more details, see [Microsoft's documentation on SMB guest access](https://learn.microsoft.com/en-us/windows-server/storage/file-server/enable-insecure-guest-logons-smb2-and-smb3).
:::

---

## 网络安全

### 设置强大的 root 密码

当您首次安装后访问 %%WebGUI|web-gui%% 时，系统会要求您为 %%root user|root-user%% 设置密码。然而，Unraid 并不强制执行密码复杂性要求——由您自行决定为服务器设置密码安全性的程度。

- 转到**用户**选项卡，选择%%root用户|root-user%%并设置密码。
- 考虑使用来自[社区应用](../../using-unraid-to/run-docker-containers/community-applications.mdx)的**Dynamix密码验证器**插件进行实时强度反馈。
- 有关更多指导，请查看在线提供的[Bitwarden密码强度工具](https://bitwarden.com/)。

### 审查和最小化端口转发

从您的路由器转发端口到 Unraid 服务器可能是远程访问服务所必需的，但这会将您的网络暴露在重大风险中。仅转发您完全了解和需要的端口。

| 端口         | 典型用途                                | 安全风险                                      | 更安全的替代方案                                                                             |
| ---------- | ----------------------------------- | ----------------------------------------- | ------------------------------------------------------------------------------------ |
| 80 / 443   | %%WebGUI\|web-gui%% (HTTP/HTTPS)    | 暴露管理界面；如果密码较弱，存在被拦截或暴力破解的风险               | 使用 Unraid Connect 或 VPN 进行远程访问，请注意 Unraid Connect 需要进行 WAN 端口转发或使用 UPnP（而不是始终在线的云中继） |
| 445        | %%SMB\|samba%% (文件共享)               | 将共享暴露在互联网上；存在数据盗窃或删除的风险                   | 使用VPN进行安全的远程文件访问                                                                     |
| 111 / 2049 | %%NFS\|nfs%%                        | 公开 %%NFS\|nfs%% 共享；与 %%SMB\|samba%% 类似的风险 | 使用VPN进行远程访问                                                                          |
| 22 / 23    | %%SSH\|ssh%%/Telnet                 | 暴露控制台访问；存在暴力破解或凭证盗窃的风险                    | 使用 %%SSH\|ssh%% 密钥或 VPN；永远不要转发 Telnet                                                |
| 57xx       | %%VNC\|vnc-session%% 用于 %%VMs\|vm%% | 公开 %%VM\|vm%% 控制台；有未经授权的远程访问风险            | 使用 Unraid Connect 或 VPN                                                              |

:::tip
如果看到不理解的端口转发规则，请删除它并监控问题。如有必要，可以重新添加。
:::

:::caution
切勿将您的服务器置于网络的 DMZ 中。将 Unraid 服务器放在 DMZ 中会将所有端口暴露在互联网上，大大增加被攻陷的风险。即使有强密码，也永远不建议这样做。
:::

---

## 共享访问安全

### 控制共享的可见性和权限

- 使用 WebGUI 中的 **Shares** 选项卡设置每个共享的导出和安全设置。
- 对于敏感数据，建议使用私人或安全共享。公共共享可被网络上的任何人访问，在现代Windows版本中默认被阻止以确保安全。
- 为用户账户分配其角色所需的权限（最小特权）。
- 尽可能限制共享访问给特定用户。

### 仔细分配用户权限

- 根据需要使用只读或读/写访问将用户分配给共享。
- %%root用户|root-user%%账户用于系统管理，不能访问网络共享。为网络共享访问创建专用用户账户。
- 定期检查用户权限并移除未使用账户。

### 限制共享访问至私有或只读

尽管无密码访问共享文件很方便，但如果您的本地网络设备遭到入侵，这也可能使您的数据处于风险之中。这包括 PC、Mac、移动设备和 IoT 设备。默认情况下，Unraid 共享设置为可公开读取和写入，意味着网络上的任何设备可能在遭到入侵时窃取、删除或加密您的文件。此外，恶意用户可以上传不需要的数据到您的服务器。

- 在%%WebGUI|web-gui%%的**共享**选项卡中将敏感共享设置为**私有**。
- 如果需要**公开**共享，请尽可能将其设置为**只读**。
- 只将写入权限给予拥有强密码的授权用户。

### 避免公开闪存共享，或使其保密

Unraid 闪存设备包含关键的系统和配置文件。虽然通过 %%SMB|samba%% 公开闪存共享以进行高级配置可能很方便，但如果公开，会带来显著的风险。

- 仅在绝对必要时曝光闪存共享并将其设为**私有**。
- 访问时要求用户名和强密码。
- 在不使用时删除或禁用共享以降低风险。

### 保持服务器更新

定期更新对于安全至关重要。经常发现新的漏洞 (CVEs)，Lime Technology 积极地为 Unraid OS 发布补丁。更新只有在您实际应用更新时才有效。

- 在%%WebGUI|web-gui%%中的***工具 → 更新OS***中检查更新。
- 在***设置 → 通知***中启用通知，以便在有更新时收到提醒。
- 通过**应用程序**选项卡更新插件和Docker容器，确保所有组件安全且兼容。
- 及时应用更新，确保您的服务器免受已知威胁。

### 使用安全的方法进行远程管理

绝不要将%%WebGUI|web-gui%%直接暴露于互联网。相反，请使用安全的远程访问解决方案：

- **%%Tailscale|tailscale%%** 是推荐的选项，在 Unraid 中有专用的插件。它为从世界任何地方访问您的服务器和服务创建了安全的私人网络 (tailnet)，无需暴露端口或配置复杂的防火墙规则。
- **%%WireGuard|wireguard%% VPN** 是内置于 Unraid 中的，并提供了远程管理的安全加密隧道。
- **%%OpenVPN|openvpn%%** 可作为插件或Docker容器使用。
- 许多现代路由器提供内置VPN支持 - 查看路由器文档了解设置。
- [Unraid Connect](../../../unraid-connect/overview-and-setup.mdx)插件使得可以远程访问%%WebGUI|web-gui%%，但需要在路由器上转发端口。

---

\* “%%WireGuard|wireguard%%”和“%%WireGuard|wireguard%%”徽标是Jason A. Donenfeld的注册商标。
