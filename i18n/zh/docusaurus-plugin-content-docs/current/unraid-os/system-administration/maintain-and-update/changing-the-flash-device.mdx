---
sidebar_position: 3
sidebar_label: 更换闪存设备
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import BackupUsingWebGUI from './partials/backup-using-webgui.mdx';
import BackupManualMethod from './partials/backup-manual-method.mdx';
import ReplacementUsingCreator from './partials/replacement-using-creator.mdx';
import ReplacementManualMethod from './partials/replacement-manual-method.mdx';

# 更换闪存设备

USB 闪存设备对您的 Unraid 服务器至关重要，因为它存储操作系统、配置文件和许可证。如果此设备发生故障或变得不可靠，及时更换至关重要，以避免数据丢失并最大限度地减少停机时间。

:::caution

当您更换 Unraid USB 闪存设备时，您的许可证将被转移到新设备，并且旧的闪存设备将被列入黑名单\*\*，且无法再用于Unraid。\*\* 此操作是永久的，不能撤销。

:::

一些常见的迹象表明您的USB闪存设备可能需要更换，包括：

- 服务器无法启动，或者设备中的文件丢失。
- 设备反复进入只读模式或显示文件系统错误。
- 设备丢失或被盗。
- 存储容量不足以进行更新或配置更改。
- 设备的物理尺寸不适合您的服务器设置。

---

## 选择替换设备

选择新的 Unraid 专用 USB 闪存时，更应注重可靠性和兼容性，而非速度。

<h4>要求</h4>

| 需求      | 详情                                |
| ------- | --------------------------------- |
| USB版本   | 推荐使用USB 2.0（通常比USB 3.0更可靠、更兼容）    |
| 唯一的GUID | 必须包含可编程ROM中的唯一硬件GUID              |
| 最小尺寸    | 至少4 GB                            |
| 建议最大尺寸  | 32 GB（为了便于手动安装；更大设备可能可用，但不必要）     |
| 品牌/供应商  | 从信誉良好的品牌和可信赖的零售商处购买；避免购买二手或灰色市场产品 |
| 物理尺寸    | 选择符合您服务器可用USB端口和物理限制的外形尺寸         |

欲了解更多关于如何选择适合 Unraid 的最佳闪存设备，请查看[Spaceinvader One 的 USB 闪存驱动测试视频指南](https://www.youtube.com/watch?v=jjkaidlZmgs)。

::::tip[Rules 替换规则]

- 从信誉良好的零售商处购买USB驱动器，避免拍卖网站和未知卖家。
- 避免使用二手或以前使用过的驱动器。
- 在传输许可证之前，请在您的服务器上测试新驱动器。
- 即使是知名品牌的产品，也要注意假冒产品。
  :::注

2022 年 1 月发布的[关于假冒 SanDisk 驱动的论坛公告](https://forums.unraid.net/topic/119052-psa-on-sandisk-usbs/)确认，由于假冒设备和制造变更导致生成非唯一 GUID，SanDisk 不被推荐。这影响了假冒和正品 SanDisk 驱动。

:::caution[Before 开始]
确保在 %%WebGUI|web-gui%% 中启用了 **%%SMB|samba%%**:

---

## 备份您的闪存设备

:::注意 在你替换之前

在更换当前闪存设备之前，请考虑检查其错误：

1. 定期备份您的闪存设备，尤其是在进行重大配置更改后。
2. 在服务器之外存储备份（在另一台计算机或云存储上）。
3. 在任何硬件更改后保留磁盘分配的截图。
   :::
4. 如果发现并修复错误，您可以继续使用设备。如果问题持续或重复，建议更换。

单次断电或不完整的写入有时可能导致轻微的损坏，但通常可修复。然而，重复出现的问题意味着需要更换新设备。

:::

有两种方法可以替换Unraid USB闪存设备：推荐用于Windows或macOS的[USB闪存创建工具](https://unraid.net/download)，或针对高级用户的手动方法。**始终在开始之前备份您的闪存设备。**

### 备份您的闪存设备

<Tabs>
  <TabItem value="webgui" label="通过 WebGUI" default>
    <BackupUsingWebGUI />
  </TabItem>

  <TabItem value="手册" label="手动复制">
    <BackupManualMethod />
  </TabItem>
</Tabs>

:::tip[Backup 最佳做法]

- 定期备份您的闪存设备，尤其是在进行重大配置更改后。
- 在服务器之外存储备份（在另一台计算机或云存储上）。
- 在任何硬件更改后保留磁盘分配的截图。

:::

:::important[Trial 密钥和设备更改]

如果您将试用配置转移到新闪存设备上，您将无法在购买有效注册码前启动%%array|array%%。试用密钥仅适用于原始设备。

:::

### 在没有备份的情况下从失败的闪存设备中恢复

<Tabs>
  <TabItem value="创建者" label="使用USB创建工具" default>
    <ReplacementUsingCreator />
  </TabItem>

  <TabItem value="手册" label="手动方法">
    <ReplacementManualMethod />
  </TabItem>
</Tabs>

You have now replaced your USB flash device and transferred your Unraid registration key. The system will display the registration date and the next eligible replacement date.

---

## 注册码更换频率

Replacing your Unraid registration key is straightforward, but there are important details about timing and eligibility to keep in mind.

- 按照本指南中提供的说明，准备一个新的 Unraid 闪存驱动器。
- 如果您需要在12个月内再次更换密钥，请[联系Unraid支持](https://unraid.net/contact)。为加速服务流程，请包含您的旧USB和新USB的%%GUIDs|guid%%、注册码和购买时使用的电子邮件地址。

:::important

如果因超过自动替换限制而被锁定，需要立即访问服务器，请使用新的USB驱动器设置新的 Unraid 试用版，然后联系支持以转移您的许可证。

:::

---

## 在没有备份的情况下从失败的闪存设备中恢复

丢失闪存设备且不知道磁盘分配可能会令人紧张，但通过谨慎步骤可以避免数据丢失。

:::caution

切勿将数据盘分配为%%parity drive|parity-drives%%。错误的分配可能会用校验信息覆盖数据，导致数据永久丢失。

:::

:::tip[Identifying 驱动器]

- \*\*%%Parity drives|parity-drives%%\*\*不具有可挂载的文件系统。如果某个驱动器无法挂载，它很可能是%%parity|parity%%驱动器。
- **Data drives** previously used by Unraid retain their data even after resetting the %%array|array%% configuration.
- 如果您发现比预期的更多无法挂载的驱动器%%parity|parity%%驱动器，请停止并在[Unraid论坛](https://forums.unraid.net/)中寻求帮助。

:::

要安全重新配置您的%%array|array%%：

1. 按照本指南中提供的说明，准备一个新的 Unraid 闪存驱动器。
2. 转到***Main***选项卡
   - 将所有驱动器分配为数据驱动器并启动%%array|array%%。
   - 注意未挂载的驱动器序列号，这些可能是您的%%parity|parity%%驱动器。
   - 不要点击任何驱动器的**格式化**按钮。如果存在比预期更多的无法挂载的%%parity|parity%%驱动器，请停止并在论坛中寻求帮助。
   - 您还可以使用[未分配设备插件](https://unraid.net/community/apps?q=Unassigned%20Devices)测试挂载每个驱动器（%%parity|parity%%不会挂载），通过排除法识别%%parity|parity%%。
   - 在继续之前停止%%array|array%%。
3. 前往***工具 → 新的配置***并创建一个新的%%array|array%%配置，保留所有当前配置的驱动器。
4. 在**主**标签中，将正确的驱动器分配为%%parity|parity%%，其余的作为数据驱动器。
5. 如果您有一个%%parity|parity%%驱动器，数据盘的顺序并不关键。只有在确信您分配了相同的物理校验盘且自原始配置后没有进行写入时才勾选“校验有效”。对于双%%parity|parity%%，数据盘的顺序以及校验1和校验2的分配很重要——校验1和校验2不可互换，如果有变化则必须重建%%parity|parity%%。
6. 启动%%array|array%%以提交分配。数据盘应该挂载，其内容应保持不变。
7. 如果您勾选了**校验有效**，请运行一个校正的[%%parity|parity%%检查](../../using-unraid-to/manage-storage/array-configuration.mdx#checking-array-devices)以确认您的配置是否正确。

:::note

恢复%%array|array%%后，验证任何特定共享的包含/排除设置，因为数据驱动器的顺序可能发生了变化。

:::

---

\* *"%%WireGuard|wireguard%%"和 "%%WireGuard|wireguard%%"徽标是Jason A. Donenfeld的注册商标.*
