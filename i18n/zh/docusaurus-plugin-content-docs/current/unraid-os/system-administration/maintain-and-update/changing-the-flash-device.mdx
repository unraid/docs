---
sidebar_position: 3
sidebar_label: 更换闪存设备
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import BackupUsingWebGUI from './partials/backup-using-webgui.mdx';
import BackupManualMethod from './partials/backup-manual-method.mdx';
import ReplacementUsingCreator from './partials/replacement-using-creator.mdx';
import ReplacementManualMethod from './partials/replacement-manual-method.mdx';

# 更换闪存设备

USB 闪存设备对您的 Unraid 服务器至关重要，因为它存储操作系统、配置文件和许可证。如果此设备发生故障或变得不可靠，及时更换至关重要，以避免数据丢失并最大限度地减少停机时间。

:::caution
When you replace your Unraid USB flash device, your license is transferred to the new device, and the old flash device is blacklisted **and can no longer be used with Unraid.** This action is permanent and cannot be undone.
:::

Some common indicators that your USB flash device may need to be replaced include:

- The server will not boot, or files are missing from the device.
- The device repeatedly enters read-only mode or shows file system errors.
- The device is lost or stolen.
- Storage capacity is insufficient for updates or configuration changes.
- The physical size of the device does not fit your server setup.

---

## Selecting a replacement device

When choosing a new USB flash drive for Unraid, focus on reliability and compatibility over speed.

<h4>要求</h4>

| Requirement              | Details                                                                                   |
| ------------------------ | ----------------------------------------------------------------------------------------- |
| USB version              | USB 2.0 recommended (typically more reliable and widely compatible than USB 3.0)          |
| Unique GUID              | Must contain a unique hardware GUID in programmable ROM                                   |
| Minimum size             | At least 4 GB                                                                             |
| Maximum recommended size | 32 GB (for ease of manual installs; larger devices may work but are not necessary)        |
| Brand/vendor             | Purchase from reputable brands and trusted retailers; avoid second-hand or gray-market    |
| Physical size            | Choose a form factor that fits your server’s available USB ports and physical constraints |

For more guidance on selecting the best flash device for Unraid, check out [Spaceinvader One's video guide on USB flash drive testing](https://www.youtube.com/watch?v=jjkaidlZmgs).

::::tip[Rules of thumb for replacement]
- Buy USB drives from reputable retailers and avoid auction sites and unknown sellers.
- Avoid second-hand or previously used drives.
- Test the new drive on your server before transferring your license.
- Be cautious of counterfeit products, even from well-known brands.
  :::note
  :::
The [forum announcement on counterfeit SanDisk drives](https://forums.unraid.net/topic/119052-psa-on-sandisk-usbs/) from January 2022 confirms SanDisk is not recommended due to counterfeit devices and manufacturing changes resulting in non-unique GUIDs. This affects both counterfeit and legitimate SanDisk drives.
::::

:::

:::

:::

---

## 更换您的USB闪存设备

:::caution[Before 替换]
Before replacing your current flash device, consider checking it for errors:

1. 关闭服务器并移除闪存设备。
2. 将设备插入Windows或Mac计算机。
3. 使用Windows的Scandisk或Mac的Disk Utility检查并修复错误。
4. 如果发现并修复了错误，则可以继续使用设备。如果问题仍然存在或重新出现，建议更换。

A single power outage or incomplete write can sometimes cause minor corruption, which is usually repairable. However, repeated issues signal the need for a new device.
:::

您可以通过两种方式更换 Unraid USB 闪存设备：适用于 Windows 或 macOS 的推荐 [USB 闪存创建工具](https://unraid.net/download)，或适合高级用户的手动方法。**在开始之前，请务必备份您的闪存设备。**

### 备份您的闪存设备

<Tabs>
  <TabItem value="webgui" label="通过 WebGUI" default>
    <BackupUsingWebGUI />
  </TabItem>

  <TabItem value="手册" label="手动复制">
    <BackupManualMethod />
  </TabItem>
</Tabs>

:::tip[Backup 最佳做法]
- 定期备份您的闪存设备，尤其是在进行重大配置更改后。
- 在服务器之外存储备份（在另一台计算机或云存储上）。
- Keep a screenshot of your disk assignments after any hardware changes.
:::

:::important[Trial 密钥与设备变更]
如果您将试用配置转移到新的闪存设备上，则在购买有效的注册密钥之前，您将无法启动 %%array|array%%。试用密钥仅在原始设备上有效。
:::

### 替换方法

<Tabs>
  <TabItem value="创建者" label="使用USB创建工具" default>
    <ReplacementUsingCreator />
  </TabItem>

  <TabItem value="手册" label="手动方法">
    <ReplacementManualMethod />
  </TabItem>
</Tabs>

您现在已更换 USB 闪存设备并转移了 Unraid 注册密钥。系统将显示注册日期和下一个可替换日期。

---

## 注册码更换频率

更换 Unraid 注册密钥很简单，但需要注意时间和资格方面的重要细节。

- 您可以随时更换注册密钥。但是，在第一次更换后，您必须等待 **12 个月**才能再次使用自动在线方法进行更换。
- 如果您需要在 12 个月内再次更换密钥，请[联系 Unraid 支持](https://unraid.net/contact)。为加快服务速度，请提供您的旧和新的 USB %%GUIDs|guid%%，您的许可证密钥，以及用于购买的电子邮件地址。

:::important
如果因超过自动替换限制而被锁定，需要立即访问服务器，请使用新的USB驱动器设置新的 Unraid 试用版，然后联系支持以转移您的许可证。
:::

---

## 在没有备份的情况下从失败的闪存设备中恢复

丢失闪存设备且不知道磁盘分配可能会令人紧张，但通过谨慎步骤可以避免数据丢失。

:::caution
切勿将数据磁盘分配为 %%parity drive|parity-drives%%。不正确的分配可能会用校验信息覆盖数据，从而导致永久性的数据丢失。
:::

:::tip[Identifying 驱动]
- **%%Parity drives|parity-drives%%** 没有可挂载的文件系统。如果磁盘无法挂载，它可能是一个 %%parity|parity%% 磁盘。
- **数据磁盘** 之前被 Unraid 使用后即使在重设 %%array|array%% 配置后仍会保留其数据。
- If you find more unmountable drives than expected %%parity|parity%% drives, stop and seek help in the [Unraid forums](https://forums.unraid.net/).
:::

要安全重新配置您的%%array|array%%：

1. 按照本指南中提供的说明，准备一个新的 Unraid 闪存驱动器。
2. 转到***Main***选项卡
   - 将所有驱动器分配为数据驱动器并启动%%array|array%%。
   - 注意未挂载的驱动器序列号，这些可能是您的%%parity|parity%%驱动器。
   - 不要点击任何磁盘上的 **格式化**。如果出现的无法挂载磁盘数量超出预期的 %%parity|parity%% 磁盘，请停止并在论坛中寻求帮助。
   - 您还可以使用[未分配设备插件](https://unraid.net/community/apps?q=Unassigned%20Devices)测试挂载每个驱动器（%%parity|parity%%不会挂载），通过排除法识别%%parity|parity%%。
   - 在继续之前停止%%array|array%%。
3. 前往***工具 → 新的配置***并创建一个新的%%array|array%%配置，保留所有当前配置的驱动器。
4. 在**主**标签中，将正确的驱动器分配为%%parity|parity%%，其余的作为数据驱动器。
5. 如果您只有一个 %%parity|parity%% 磁盘，数据磁盘的顺序并不重要。仅当您确信分配了相同的物理校验磁盘而自原始配置以来未发生写入时，才检查 **校验有效**。对于双 %%parity|parity%%，数据磁盘的顺序以及校验1和校验2的分配都很重要——校验1和校验2不可互换，如果其中任何一个更换，必须重建 %%parity|parity%%。
6. 启动 %%array|array%% 来提交分配。数据磁盘应挂载，它们的内容应保持完整。
7. 如果您勾选了**校验有效**，请运行一个校正的[%%parity|parity%%检查](../../using-unraid-to/manage-storage/array-configuration.mdx#checking-array-devices)以确认您的配置是否正确。

:::note
恢复%%array|array%%后，验证任何特定共享的包含/排除设置，因为数据驱动器的顺序可能发生了变化。
:::

---

\* “%%WireGuard|wireguard%%”和“%%WireGuard|wireguard%%”徽标是Jason A. Donenfeld的注册商标。
