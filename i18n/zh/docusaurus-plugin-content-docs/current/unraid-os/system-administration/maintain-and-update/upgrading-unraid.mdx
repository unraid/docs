---
sidebar_position: 2
sidebar_label: 升级 Unraid
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';
import UpgradeModern from './partials/upgrade-modern.mdx';
import UpgradeLegacy611612 from './partials/upgrade-legacy-611-612.mdx';
import ManualDowngradeSimplest from './partials/manual-downgrade-simplest.mdx';
import ManualDowngradeCommandLine from './partials/manual-downgrade-command-line.mdx';

# 升级 Unraid

升级 Unraid OS 可确保您获得最新功能、安全更新和硬件支持。本页概述了标准升级过程，提供了疑难解答技巧和手动升级选项。

:::note[Prerequisites]
在开始升级之前，请确保为您的 USB 闪存设备创建完整备份。有关详细信息，请参阅[备份闪存设备](../maintain-and-update/changing-the-flash-device.mdx#backing-up-your-flash-device)。
:::

:::tip[Best 升级前的实践]

1. **备份**您的闪存驱动器和任何重要数据。
2. **阅读您计划安装版本的发布说明**。
3. **将所有插件更新**至最新版本。
4. **可选步骤，停止阵列**后再进行。
5. 在 ***工具 → 更新操作系统*** 页面上**更新 Unraid OS**。
6. **重启**您的服务器以完成升级。
   :::

## 标准升级流程

<Tabs>
  <TabItem value="现代 (2025)" label="Unraid 7.x及更高版本" default>
    <UpgradeModern />
  </TabItem>

  <TabItem value="旧版 (6.11到6.12)" label="Unraid 6.11到6.12">
    <UpgradeLegacy611612 />
  </TabItem>
</Tabs>

:::caution[ZFS 存储池升级警告]

升级您的池并不紧急，但如果您决定升级，请注意它可能无法与以前的 Unraid 版本一起使用。这意味着进行升级后，您可能无法返回到以前的 Unraid 版本。

一如既往，在升级您的%%ZFS|zfs%%池之前，请记住备份您的数据。
:::

---

## 排查升级问题

如果升级后遇到问题，请查看下面相关部分获取帮助。

<details>
  <summary><strong>升级后阵列或 Docker 容器启动较慢</strong> - 点击以展开/收起</summary>

  在某些升级后可能需要对 Docker 容器进行一次性迁移。此过程可能需要一些时间，特别是如果您有很多镜像。在此过程中请耐心等待；性能应在初始启动后恢复正常。
</details>

<details>
  <summary><strong>升级后 Docker 容器无法正常工作</strong> - 点击以展开/收起</summary>

  如果您遇到类似 "layers from manifest don't match image configuration" 的错误，您可能需要重新构建您的 Docker 镜像文件。以下是方法：

  1. 前往 ***设置 → Docker*** 并停止 Docker 服务。
  2. 选中删除 Docker 镜像的复选框并单击删除按钮。
  3. 重新启动 Docker 以重建镜像。
  4. 导航到 **应用** 标签页，选择 **先前的应用**，勾选要重新安装的应用并点击 **安装 xx 应用**。
</details>

<details>
  <summary><strong>VMs 显示“无法获取接口 MTU”或网络错误</strong> - 点击以展开/收起</summary>

  如果您为 %%VM%% 网络使用了自定义桥接名称，请按照以下步骤更新所有 %%VM%% 以使用默认的 `br0` 桥接：

  1. 前往 **VMs** 标签页并编辑每个 %%VM%%（确保启用 **高级视图**）。
  2. 将网络桥接设置为 `br0` 并点击 **应用**。
  3. 前往 ***设置 → VM 管理器***（在 **高级视图** 中）并将默认桥接设置为 `br0`。
</details>

<details>
  <summary><strong>VNC 无法访问或速度慢</strong> - 点击以展开/收起</summary>

  对于旧版 %%VM%%，您可能需要更新 %%VNC%% 视频驱动程序：

  1. 在 **VMs** 标签页编辑 %%VM%%（选择 **高级视图**）。
  2. 将 **VNC 视频驱动程序** 设置为 **QXL**（推荐）。如果 QXL 不成功，可以尝试 **Cirrus** 或 **vmvga**。
  3. 点击 **应用** 以保存更改。
</details>

<details>
  <summary><strong>VM 无法启动（出现 EFI shell）</strong> - 点击以展开/收起</summary>

  If you have %%OVMF|ovmf%%-based %%VMs|vm%% created in older Unraid versions, you might encounter an EFI shell. You can boot the %%VM|vm%% by entering the following commands:

  1. 键入 `fs0:`。
  2. 然后键入 `cd efi/boot`。
  3. 最后，键入 `bootx64.efi`。

  如果 `fs0:` 不起作用，您可以尝试 `fs1:`。如果问题仍然存在，请访问 [Unraid 论坛](https://forums.unraid.net/) 寻求帮助。
</details>

<details>
  <summary><strong>尝试启动我的 VM 时出现“无效的机器类型”错误</strong> - 点击以展开/收起</summary>

  为了解决此问题，在 %%WebGUI|web-gui%% 中编辑 %%VM|vm%%，然后在不进行任何修改的情况下点击 **Apply**。此操作将更新机器类型为最新支持版本。
</details>

<details>
  <summary><strong>升级后 VM 性能差</strong> - 点击以展开/收起</summary>

  如果您的 %%VM|vm%% 在升级后速度变慢，请进入 %%VM|vm%% 设置（在 **高级视图** 中），并将 **机器** 类型版本更新到最新修订版（例如，从 `i440fx-2.5` 更改为 `i440fx-2.7`）。确保不要更改前缀（例如，不要从 `i440fx` 切换到 `Q35`）。
</details>

---

## 手动升级或降级

手动升级通常不必要，但如果无法访问 WebGUI 或需要恢复到之前的版本时可能需要。在进行之前，请务必备份 USB 闪存设备，详细信息可以在[备份闪存设备](../maintain-and-update/changing-the-flash-device.mdx#backing-up-your-flash-device)中找到。

### 使用降级 OS 工具进行降级（如果 WebGUI 可访问）

如果可以访问 WebGUI：

1. 登录到 %%WebGUI|web-gui%%。
2. 导航到 ***工具 → 降级操作系统***。
3. 之前的版本将列为可供降级的选项。
4. 点击**降级**并按提示操作。
5. 当提示时，重启服务器。

:::caution
请记住，降级可能会导致插件或 Docker 容器的兼容性问题。请务必提前备份您的 USB 闪存设备和任何重要数据。
:::

### 手动方法（如果无法访问 WebGUI）

只有在无法访问 %%WebGUI|web-gui%% 的情况下才使用这些方法：

<Tabs>
  <TabItem value="最简单的方法" label="最简单的方法">
    <ManualDowngradeSimplest />
  </TabItem>

  <TabItem value="命令行方法" label="命令行方法">
    <ManualDowngradeCommandLine />
  </TabItem>
</Tabs>
