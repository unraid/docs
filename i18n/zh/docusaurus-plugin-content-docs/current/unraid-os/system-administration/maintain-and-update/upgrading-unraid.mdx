---
sidebar_position: 2
sidebar_label: 升级 Unraid
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";
import UpgradeModern from "./partials/upgrade-modern.mdx";
import UpgradeLegacy611612 from "./partials/upgrade-legacy-611-612.mdx";
import ManualDowngradeSimplest from "./partials/manual-downgrade-simplest.mdx";
import ManualDowngradeCommandLine from "./partials/manual-downgrade-command-line.mdx";

# 升级 Unraid

升级 Unraid OS 可确保您获得最新功能、安全更新和硬件支持。本页概述了标准升级过程，提供了疑难解答技巧和手动升级选项。

:::note\[Prerequisites]

在开始升级之前，请确保完整备份您的USB闪存设备。有关更多详细信息，请参阅[备份闪存设备](../maintain-and-update/changing-the-flash-device.mdx#backing-up-your-flash-device)。

:::

:::tip[Best 升级前的实践]

1. **备份**您的闪存驱动器和任何重要数据。
2. **阅读您计划安装版本的发布说明**。
3. **将所有插件更新**至最新版本。
4. **可选步骤，停止阵列**后再进行。
5. 在 ***工具 → 更新操作系统*** 页面上**更新 Unraid OS**。
6. 重启服务器以完成升级。

:::

## 标准升级流程

<Tabs>
  <TabItem value="modern-7x" label="Unraid 7.x及更高版本" default>
    <UpgradeModern />
  </TabItem>

  <TabItem value="legacy-611-612" label="Unraid 6.11到6.12">
    <UpgradeLegacy611612 />
  </TabItem>
</Tabs>

:::caution[ZFS 存储池升级警告]

升级到 Unraid 7.x 时，您可能会在启动过程中或 %%WebGUI|web-gui%% 中看到有关 [%%ZFS|zfs%%](../../advanced-configurations/optimize-storage/zfs-storage.mdx) 池功能升级的警告。这些警告并不是问题的迹象；它们只是表示您的 %%ZFS|zfs%% 池正在使用来自旧版本 ZFS 的功能。

升级您的池并不紧急，但如果您决定升级，请注意它可能无法与以前的 Unraid 版本一起使用。这意味着进行升级后，您可能无法返回到以前的 Unraid 版本。

如以往一样，升级您的%%ZFS|zfs%%池之前，请记得备份数据。

:::

---

## 排查升级问题

如果升级后遇到问题，请查看下面相关部分获取帮助。

<details>
  <summary><strong>升级后 Docker 容器无法正常工作</strong> - 点击以展开/收起</summary>

  如果您遇到类似 "layers from manifest don't match image configuration" 的错误，您可能需要重新构建您的 Docker 镜像文件。以下是方法：
</details>

<details>
  <summary><strong>VMs 显示“无法获取接口 MTU”或网络错误</strong> - 点击以展开/收起</summary>

  If you have %%OVMF|ovmf%%-based %%VMs|vm%% created in older Unraid versions, you might encounter an EFI shell. You can boot the %%VM|vm%% by entering the following commands:

  1. 键入 `fs0:`。
  2. 然后键入 `cd efi/boot`。
  3. 最后，键入 `bootx64.efi`。
  4. 导航到 **应用** 标签页，选择 **先前的应用**，勾选要重新安装的应用并点击 **安装 xx 应用**。
</details>

<details>
  <summary><strong>VNC 无法访问或速度慢</strong> - 点击以展开/收起</summary>

  为了解决此问题，在 %%WebGUI|web-gui%% 中编辑 %%VM|vm%%，然后在不进行任何修改的情况下点击 **Apply**。此操作将更新机器类型为最新支持版本。

  1. 前往 **VMs** 标签页并编辑每个 %%VM%%（确保启用 **高级视图**）。
  2. 将网络桥接设置为 `br0` 并点击 **应用**。
  3. 前往 ***设置 → VM 管理器***（在 **高级视图** 中）并将默认桥接设置为 `br0`。
</details>

<details>
  <summary><strong>VM 无法启动（出现 EFI shell）</strong> - 点击以展开/收起</summary>

  If you have %%OVMF|ovmf%%-based %%VMs|vm%% created in older Unraid versions, you might encounter an EFI shell. You can boot the %%VM|vm%% by entering the following commands:

  1. 在 **VMs** 标签页编辑 %%VM%%（选择 **高级视图**）。
  2. 将 **VNC 视频驱动程序** 设置为 **QXL**（推荐）。如果 QXL 不成功，可以尝试 **Cirrus** 或 **vmvga**。
  3. 点击 **应用** 以保存更改。
</details>

<details>
  <summary><strong>VMs 显示“无法获取接口 MTU”或网络错误</strong> - 点击以展开/收起</summary>

  If you have %%OVMF|ovmf%%-based %%VMs|vm%% created in older Unraid versions, you might encounter an EFI shell. You can boot the %%VM|vm%% by entering the following commands:

  1. 键入 `fs0:`。
  2. 然后键入 `cd efi/boot`。
  3. 最后，键入 `bootx64.efi`。

  如果 `fs0:` 不起作用，您可以尝试 `fs1:`。如果问题仍然存在，请访问 [Unraid 论坛](https://forums.unraid.net/) 寻求帮助。
</details>

<details>
  <summary><strong>VNC 无法访问或速度慢</strong> - 点击以展开/收起</summary>

  为了解决此问题，在 %%WebGUI|web-gui%% 中编辑 %%VM|vm%%，然后在不进行任何修改的情况下点击 **Apply**。此操作将更新机器类型为最新支持版本。
</details>

<details>
  <summary><strong>VM 无法启动（出现 EFI shell）</strong> - 点击以展开/收起</summary>

  If you have %%OVMF|ovmf%%-based %%VMs|vm%% created in older Unraid versions, you might encounter an EFI shell. You can boot the %%VM|vm%% by entering the following commands:
</details>

---

## 降级 Unraid

在降级之前，请务必阅读您将降级版本的发行说明。查找标题为"回滚"的部分，因为它包含任何需要执行的重要步骤。

如果您可以访问 WebGUI，您可以转到 **工具 → 降级操作系统。** 此选项允许您降级到先前安装的版本，而无需从版本历史页面下载 zip 文件。

如果在 **工具 → 降级操作系统** 下看不到降级选项，请使用下面描述的手动方法。这通常意味着先前版本的文件不在您的闪存驱动器上。

### 手动降级

只有当您无法访问 %%WebGUI|web-gui%% 或降级选项不可用时，才需要手动降级。在继续之前，备份您的 USB 闪存设备非常重要。更多详细信息，请参阅 [备份您的闪存设备](../maintain-and-update/changing-the-flash-device.mdx#backing-up-your-flash-device) 。

<Tabs>
  <TabItem value="最简单的方法" label="最简单的方法">
    <ManualDowngradeSimplest />
  </TabItem>

  <TabItem value="命令行方法" label="命令行方法">
    <ManualDowngradeCommandLine />
  </TabItem>
</Tabs>
