---
sidebar_position: 1
sidebar_label: 概述
---

# 数组

Unraid 的存储系统通过结合 %%array|数组%% 和 %%cache|缓存%% 架构，实现灵活性与数据保护。%%array|数组%% 管理您的主要存储，提供可选 %%parity|校验%% 保护，而缓存池则加速性能。

## Driving principles

1. **Use your largest drives for parity** - Data disks can't be larger than your %%parity disks|parity-drives%%, so use your biggest drives for parity to avoid future expansion limits. If you use dual parity, both drives should be at least the size of your largest data disk, but they can be different sizes from each other. No disk can be larger than your smallest parity drive.

2. **Save SSDs for cache pools** - Unraid doesn't support TRIM/Discard for SSDs in the main array, which causes performance degradation over time. Use SSDs in %%cache pools|cache-pool%% or as unassigned devices instead, where these features work properly.

3. **Add a cache for better write performance** - A cache dramatically speeds up writes by temporarily storing data on fast drives before the %%Mover|mover%% transfers it to the array (typically at 3:40 AM). Cached data still appears in your shares, so access feels instant while the transfer happens in the background.

4. **Use a cache pool for data protection** - A single cache device puts your cached data at risk until the %%Mover|mover%% runs. Multiple devices in a %%cache pool|cache-pool%% provide redundancy and protect your data from cache device failures.

5. **SSDs excel for apps and VMs** - Applications and virtual machines benefit significantly from SSD speed. A %%cache pool|cache-pool%% with SSDs provides the perfect balance of speed, efficiency, and data protection for these workloads.

6. **Encryption is optional** - Encryption is disabled by default and requires reformatting drives (which erases data). If you need it, move data off the disk, change to an encrypted file system, format, then move data back. See [How to encrypt a drive in Unraid](../../../system-administration/secure-your-server/securing-your-data.mdx#how-to-encrypt-a-drive-in-unraid) for details. Be aware that encryption complicates data recovery if something goes wrong.

:::info[Disk 识别和端口灵活性]

Unraid identifies disks based on their serial numbers and sizes, not the specific SATA ports they're connected to. This means you can switch drives between different SATA ports without affecting their assignments in Unraid. This feature is particularly useful for troubleshooting hardware problems, like finding a faulty port or replacing unreliable power or SATA cables.

:::

:::caution

如果您分配或连接的设备数量超过许可证密钥允许的数量，您的阵列将不会启动。

:::

## 启动/停止阵列

当系统启动时，通常会自动启动磁盘阵列。然而，如果您最近更改了磁盘设置，例如添加了新的磁盘，阵列将保持关闭以便让您检查配置。

:::caution

Unraid provides several maintenance and configuration options for your storage array. Key operations include:

:::

要启动或停止阵列：

1. 点击**主界面**选项卡。
2. 导航到 **阵列操作** 部分。
3. 单击**开始**或**停止**。在继续之前，您可能需要选中“是，我要这样做”选项框。

## File system selection

默认情况下，新的阵列驱动器将使用%%XFS|xfs%%格式化。如果您希望使用%%ZFS|zfs%%或%%BTRFS|btrfs%%，请从下拉菜单中选择您喜欢的文件系统。

For detailed information about file system options, see [File systems](../file-systems.mdx).

## 设置新磁盘

Unraid provides several maintenance and configuration options for your storage array. Operations include:

- [Adding disks to array](./adding-disks-to-array.mdx) - Expand storage capacity
- [Replacing disks in array](./replacing-disks-in-array.mdx) - Upgrade or swap failed drives
- [Removing disks from array](./removing-disks-from-array.mdx) - Decommission or reduce array size
- [Array health and maintenance](./array-health-and-maintenance.mdx) - Monitor and maintain your array

## 阵列写入模式

Unraid 提供多种写入模式用于管理阵列操作，每种模式在速度、电量消耗和磁盘损耗方面各有优劣。了解这些模式的工作原理以及缓存盘或缓存池的作用，有助于根据您的需求优化服务器。

**写入模式概览**

| 写入模式            | 速度（典型）                                  | 能耗 | 何时驱动器启动   | 数据保护    | 最佳使用场景                               |
| --------------- | --------------------------------------- | -- | --------- | ------- | ------------------------------------ |
| 读/修改/写          | 20–40 MB/s                              | 低  | 仅校验和目标驱动器 | 可以      | 大多数工作负载，节能，小写入                       |
| Turbo Write（重建） | 40–120 MB/s                             | 高  | 所有驱动器     | 可以      | 大文件传输, 阵列重建, %%parity checks\|校验检查%% |
| 缓存写入（SSD/NVMe）  | 50–110 MB/s (SSD)，250–900 MB/s (NVMe)\* | 变化 | 仅缓存驱动器    | 否（直到移动） | 应用，虚拟机，频繁写入，最大化速度                    |

### 读/修改/写

This is the default write mode. It reads the existing data and the parity, calculates the new parity, and then writes the updated data. Only the %%parity drive|parity-drives%% and the target data drive spin up, which results in lower power usage and less wear on the drives. However, it can be slower due to the additional read/write cycles.

Use this mode anytime, especially if you want energy savings and idle drives to spin down. It's great for small or infrequent writes.

### Turbo Write（重建写入）

Turbo write, also known as reconstruct write, is a feature designed to boost the writing speed of your Unraid array. It works by reading all data drives and updating the parity simultaneously. This process eliminates the delays caused by waiting for the platters to rotate, as seen in the default write mode. However, all array drives need to be spinning and functioning properly for this to work effectively.

**How it works:** When you write new data, Unraid reads from all the other data drives and recalculates the parity at the same time. Both the new data and the updated parity get written together. All drives in the array must be operational and actively spinning.

**When to use:** Transferring large, sequential files to the array. During array rebuilds or %%parity checks|parity-check%%, as all drives are already spinning. When minimizing write time is a priority and you can confirm all drives are healthy.

**When to avoid:** If you want your drives to spin down during idle times to conserve energy. For small or infrequent write operations since it causes all drives to spin up for every write, increasing power usage and wear. If you suspect any drive is failing or unreliable, since it relies on every drive being operational.

:::info

Turbo write is best suited for bulk operations and scenarios requiring high throughput. However, it might not be the best choice for everyday tasks if you're focused on energy savings and minimizing drive wear.

:::

### 缓存写入

Data is written first to a fast SSD or NVMe %%cache|cache%% and can then be moved to the main array later by a process called the %%Mover|mover%%. The speeds vary: SSD: 50–110 MB/s; NVMe: 250–900 MB/s (which can utilize 10GbE networks). Once data is moved to the array, it is protected by parity.

**When to use:** For shares with frequent write operations like applications, virtual machines, or downloads. To enhance performance and reduce perceived write latency.

**性能期望:**

- Without a cache drive: Average 20–30 MB/s, with peaks up to 40 MB/s
- With SSD cache: 50–110 MB/s
- With NVMe cache: 250–900 MB/s depending on network or drive constraints

:::tip

考虑使用缓存池（多个设备）以在Mover运行之前增加冗余和数据保护。

:::

:::info[Automated 解决方案]

- **自动**模式（未来功能）将仅在所有驱动器已旋转时启用turbo写入。
- 社区插件（在应用标签中搜索“Turbo Write”）可能提供增强的自动化或调度选项。

:::

更改写入模式：

1. Navigate to ***Settings → Disk Settings***.
2. 找到 **可调(md_write_method)**。
3. 选择您喜欢的模式：
   - **读/修改/写** (默认)
   - **重建写入** (Turbo Write)
   - **自动** (未来功能)
4. 点击**应用**以确认您的选择。

:::important[Quick 回顾]

- 当你需要速度时使用 **Turbo Write**，但要注意增加的功耗和驱动启动。
- 使用 **缓存写入**以获得最佳性能，特别是在使用SSD或NVMe驱动器时。
- 对于大多数用户，默认写入模式提供了最佳平衡，除非你特别需要更高的速度。

:::

## 读取模式

使用 Unraid 时，读取文件的速度主要由存储每个文件的单独驱动器决定。与传统 %%RAID|硬盘冗余数组%% 系统不同，Unraid 是将每个文件存储在单个磁盘上。这意味着读取速度不会由于组合多个驱动器的速度而提高。

### 性能期望

- **典型单个HDD：** 70–250 MB/s（取决于驱动型号、年龄和数据位置）
- **典型SATA SSD：** 400–550 MB/s
- **NVMe SSD（在池中）：** 250–7,000 MB/s（受PCIe代和网络/PCIe限制影响；例如，10GbE网络限制约1,100 MB/s）

:::note[Special 案例]

- 如果磁盘被禁用且其数据正在重建，Unraid 将使用剩余的磁盘和校验信息重建数据。此过程中，读取速度可能会变慢到 30–60 MB/s 甚至更低，具体取决于系统中最慢的驱动器。
- Any ongoing operations in the array, such as a %%parity check|parity-check%% or rebuilding a drive, can also affect read performance. This is due to increased movement of the drive heads and overall contention for resources.

:::

## 缓存池

Unraid 中的 %%Cache pools|缓存池%% 为写重任务，虚拟机（VMs）和 Docker 容器提供显著优势。这些池独立于主阵列运行，可以使用 %%BTRFS|BTRFS 文件系统%% 或 %%ZFS|ZFS 文件系统%% 设置多个驱动器，支持多种 %%RAID|硬盘冗余数组%% 配置以提高速度和数据保护。

### 缓存池与主阵列对比

| 功能        | 缓存池 （BTRFS）                                                                            | 缓存池 （ZFS）                                                                                                                | 主阵列（Unraid）            |
| --------- | -------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------ | ---------------------- |
| **读取速度**  | SSD：400–550 MB/s，NVMe：250–7,000 MB/s\*                                                 | SSD：400–550 MB/s，NVMe：250–7,000 MB/s\*                                                                                   | HDD：70–250 MB/s（每个磁盘）  |
| **写入速度**  | SSD：400–550 MB/s，NVMe：250–7,000 MB/s\*                                                 | SSD：400–550 MB/s，NVMe：250–7,000 MB/s\*                                                                                   | 20–120 MB/s（取决于奇偶校验模式） |
| **数据保护**  | %%RAID 1\|raid1%%/%%RAID 10\|raid10%%；%%RAID 5\|raid5%%/%%RAID 6\|raid6%%（实验性，不适合关键数据） | %%RAID 1\|raid1%%/%%RAID 10\|raid10%%；%%RAIDZ1\|raidz1%%/%%RAIDZ2\|raidz2%%/%%RAIDZ3\|raidz3%% （稳定，适合生产）                 | 基于奇偶校验，文件系统无关          |
| **扩展**    | 混合驱动器尺寸；动态添加/删除设备                                                                      | Limited add/remove device support; cannot remove from RAIDZ; single-device add to expand single-vdev RAIDZ in Unraid 7.2 | 添加驱动器，但无条带化或性能扩展       |
| **恢复复杂性** | 数据丢失风险较高；需要%%BTRFS\|btrfs%%工具                                                          | 数据丢失风险更高；需要%%ZFS\|zfs%%工具                                                                                                | 更易基于奇偶校验的重建            |
| **最佳用途**  | 应用程序、VMs、频繁写入                                                                          | 应用程序、VMs、频繁写入、企业工作负载                                                                                                     | 批量存储、媒体库               |

\**Actual NVMe speeds depend on PCIe generation, cooling, and network bandwidth (e.g., 10GbE caps at ~1,100 MB/s).*

### 缓存池的优点

- \*\*更高性能：\*\*NVMe池可以饱和10GbE/40GbE网络（1,100–3,500 MB/s）。
- **灵活的RAID：** %%BTRFS|btrfs%% 和 %%ZFS|zfs%%均支持%%RAID 1|raid1%%/%%RAID 10|raid10%%，以实现冗余而无需匹配驱动器大小。
- \*\*低延迟：\*\*非常适合数据库、VMs和Docker容器。
- **ZFS优势：**%%ZFS|zfs%%提供企业级功能，如数据完整性检查、压缩和快照。

### 缓存池的缺点

- \*\*无奇偶校验保护：\*\*在移动到数组之前，数据未受保护。
- **恢复风险：** %%BTRFS|btrfs%% %%RAID 5|raid5%%/%%RAID 6|raid6%%不稳定；单驱动器池缺乏冗余。
- **ZFS考虑因素：**%%ZFS|zfs%%需要更多的RAM，并且硬件要求比%%BTRFS|btrfs%%更严格。

For more detailed information about %%cache pools|cache-pool%%, including how to set them up, manage them, and advanced features, check the [Cache pools](../cache-pools.mdx) page.
