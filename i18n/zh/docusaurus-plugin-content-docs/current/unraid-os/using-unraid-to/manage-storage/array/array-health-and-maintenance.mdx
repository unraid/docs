---
sidebar_position: 5
sidebar_label: Array health and maintenance
---

import ArrayCheckParity from "../partials/array-check-parity.mdx";
import ArrayCheckRead from "../partials/array-check-read.mdx";
import TroubleshootMissingDisks from "../partials/troubleshoot-missing-disks.mdx";
import TroubleshootDeviceLimit from "../partials/troubleshoot-device-limit.mdx";
import TroubleshootLicenseIssues from "../partials/troubleshoot-license-issues.mdx";
import TroubleshootKeyServer from "../partials/troubleshoot-key-server.mdx";
import TroubleshootWithdrawnRelease from "../partials/troubleshoot-withdrawn-release.mdx";

# Array health and maintenance

Regularly checking your Unraid array is crucial for maintaining data integrity and identifying potential issues before they result in data loss. This page covers monitoring tools and troubleshooting procedures for your array.

## 检查阵列设备

You can initiate a check using the **Check** button under ***Array Operations***. Depending on your array's configuration, this button allows you to conduct either a %%parity check|parity-check%% or a %%read check|read-check%%.

<div
  style={{
   margin: "auto",
   maxWidth: "400px",
   display: "flex",
   flexDirection: "column",
   alignItems: "center",
  }}
>
  ![检查按钮可让您执行校验和读取
  检查](/img/Check_button.PNG)
</div>

For convenience, you can schedule these checks to run automatically at intervals that suit you by navigating to ***Settings → Scheduler***. It's advisable to perform automated, correcting checks on a monthly or quarterly basis to ensure the ongoing health of your data and fix any sync errors found.

### 校验检查

<ArrayCheckParity />

### 读取检查

<ArrayCheckRead />

### 检查历史

Whenever the system performs a %%parity check|parity-check%% or a %%read check|read-check%%, it keeps a record of what happened. You can view these details easily by clicking the **History** button found under ***Array Operations*** in the interface.

Unraid 提供多种写入模式用于管理阵列操作，每种模式在速度、电量消耗和磁盘损耗方面各有优劣。了解这些模式的工作原理以及缓存盘或缓存池的作用，有助于根据您的需求优化服务器。

## 磁盘升降速操作

Unraid 允许您控制硬盘的电源状态。您可以轻松地 %%spin them up or down|电源状态%%，并管理 SSD 处于活动或待机状态。这有助于省电，延长硬盘寿命，并在磁盘未使用时降低噪音。

### 为什么要启动或停止？

Spinning down drives that aren't used often saves energy and helps them last longer. Spinning up disks ahead of time cuts down wait times when you need files soon.

### 如何控制启动状态

Control disk spin states through the **Main** tab:

1. Go to the **Main** tab and locate your array devices.
2. Each disk shows spin control buttons:
   - 🔘 button - **Spin Up** (if currently spun down)
   - 🟢 button - **Spin Down** (if currently spinning)
3. Click the appropriate button for the action you want.

请记住，如果磁盘被访问（例如打开文件），它将保持活动并忽略任何停止请求。

当磁盘不转时，其温度将不会在%%WebGUI|web-gui%%中显示。然而，一旦任何应用程序或用户访问它，它将自动开始转动。

:::tip

使用旋转控制来节省电力并减少对驱动器的损耗。请记住，正在被使用的磁盘将保持开启状态，直到所有任务完成。

:::

## 重置阵列配置

重置阵列配置是一个需要谨慎对待的重要步骤。此过程通常在移除磁盘、以新阵列布局重头开始或修复磁盘分配问题时是必要的。请注意，此操作可能会影响数据保护和校验，因此请确保只有在确有必要时才继续进行。

Reset your array when:

- Removing or replacing disks
- Starting fresh with a new array layout
- Fixing disk assignment errors
- Recovering from configuration problems

<div
  style={{
   margin: "auto",
   maxWidth: "650px",
   display: "flex",
   flexDirection: "column",
   alignItems: "center",
  }}
>
  ![可以通过新配置页面重置您的磁盘配置](/img/Newconfig.png)
</div>

要重置阵列配置：

1. Go to **Tools → New Config**.
2. Optionally keep some existing disk assignments for minor adjustments.
3. Check the confirmation box and click **Apply**.
4. Return to the **Main** tab.
5. Assign or unassign disks as needed.
6. Start the array in Normal or %%Maintenance Mode|maintenance-mode%%.

:::important

- Unraid attempts to recognize previously used drives and preserve data where possible
- Removing a data drive invalidates parity unless that drive was zeroed before removal
- Changing disk order won't affect parity1, but it can invalidate parity2

:::

:::caution

When you see the **Start** button, there is a checkbox labeled **Parity is Valid**. Only check this box if you are certain it is correct or if an experienced Unraid user has advised you to do so during recovery. Incorrectly checking this option can lead to data loss.

Do not use **New Config** if your goal is to rebuild a disk. Performing a New Config clears the array history required for a rebuild, and Unraid will not offer to rebuild the disk afterward. Follow the disk rebuild procedure instead.

:::

### 撤销重置

To reverse a reset:

1. \*\*无奇偶校验保护：\*\*在移动到数组之前，数据未受保护。
2. Open the `config` folder.
3. Rename `super.old` to `super.dat`.
4. Reboot your server to restore the prior configuration.

## 状态报告

Unraid 提供状态报告，帮助您跟踪存储阵列的健康状况。这些报告是快速检查任何磁盘是否禁用或在读取或写入数据时出现问题的快捷方式。

- \*\*当前状态：\*\*状态报告显示您的阵列当前情况。重要的是要注意，这些信息在系统重新启动后将被重置，因此不会保留过去的历史问题。

- \*\*无历史数据：\*\*如果您想查看重启前发生了什么，您需要去其它地方查看，因为这些报告不保存过去的状态。

:::important

请记住，状态报告不包括%%SMART|smart%%数据。%%SMART报告|smart-report%%为您提供了单个磁盘健康的更详细视图。因此，即使您的状态报告显示一切正常，定期检查%%SMART报告|smart-report%%以尽早发现任何潜在问题仍然是个好主意。

:::

## 故障排除数组启动失败

If your array won't start, follow these steps to identify and fix common problems. Look for error messages under ***Main → Array Operation***.

### 缺少磁盘

<TroubleshootMissingDisks />

### 设备限制

<TroubleshootDeviceLimit />

### 许可问题

<TroubleshootLicenseIssues />

### 密钥服务器连接

<TroubleshootKeyServer />

### 撤回发布

<TroubleshootWithdrawnRelease />

## 重建期间的磁盘故障

如果在重建另一个磁盘时发生第二个磁盘故障，您能做的将取决于您的奇偶校验设置。

### Single parity disk

如果在重建另一个磁盘时一个磁盘故障，重建将停止，因为数据无法准确恢复。

### Dual parity disk

如果您有两个 %%parity drives|校验盘%%，您有更多的选择：

- 您可以等待第一个重建完成，然后再处理第二个故障磁盘。
- 或者，您可以停止当前重建，替换第二个故障磁盘，然后启动阵列以同时重建两个磁盘。

如果第一次重建快要完成，通常最好让它完成。如果刚开始，重建两个可能会更快。

:::warning

重建磁盘会给所有驱动器带来很大压力，从而增加新故障的概率。在开始重建前，请使用%%SMART报告|smart-report%%检查磁盘健康。

:::

:::info[Rebuild 时间]

要准备好重建过程可能需要几个小时。时间可能因磁盘大小和系统忙碌程度而异。较大的磁盘和繁忙的系统可能需要更长时间。

:::
