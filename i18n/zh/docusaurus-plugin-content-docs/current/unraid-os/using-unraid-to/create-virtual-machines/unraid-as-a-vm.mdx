---
sidebar_position: 4
sidebar_label: Unraid as a VM
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Unraid as a VM

Running Unraid as a virtual machine on your primary Unraid server can be very helpful for development, testing, and evaluation. This configuration allows you to:

- Develop and test plugins or Docker containers without putting your production server at risk.
- Evaluate new Unraid releases before upgrading your main system.
- Create isolated environments for troubleshooting or training.

:::caution[Important considerations]

- Lime Technology does not officially support this configuration for production data.
- Virtualization introduces some overhead; expect reduced performance compared to running directly on hardware.
- 您需要为虚拟机准备一个单独的、有效的许可证密钥。
  :::

:::note\[Prerequisites]

- A valid Unraid license key for the %%VM|vm%%
- A dedicated USB flash drive (use a different manufacturer than your host's boot drive)
- 虚拟机需要 Unraid 版本 6.4.0 或更高版本（旧版本需要手动设置）

To get Unraid up and running as a %%VM|vm%%:

<details>
  <summary><strong>1. 准备 %%VM|vm%% 的闪存驱动器</strong> - 点击展开/折叠</summary>

  让您的闪存驱动器准备就绪对于流畅和可靠的 %%VM|vm%% 启动过程至关重要。以下是如何使用独特且正确配置的引导设备设置您的 %%VM|vm%% 环境。

  1. Use the [Unraid USB Creator](https://unraid.net/download) tool on your desktop to prepare the flash drive:
     - Select **Allow EFI boot**.
     - Set a unique server name (like `TowerVM` if your host is `Tower`).
     - Write the image to the flash drive.

  2. Modify configuration files:
     - Rename the flash drive label from `UNRAID` to a unique name (e.g., `UNRAID-VM`).

     - Edit the `syslinux/syslinux.cfg` file on the flash drive:

       ```
       label Unraid OS
         menu default
         kernel /bzimage
         append unraidlabel=UNRAID-VM initrd=/bzroot
       ```

     - Make this change in all boot modes (GUI/Safe Mode) within the file.

     - Copy the updated `syslinux.cfg` file to `EFI/boot/syslinux.cfg`

  3. Create a file named `startup.nsh` in the root of the flash drive with this content:

     ```
     \EFI\boot\bootx64.efi
     ```

  4. Note the manufacturer of the flash drive (you'll need this for %%VM|vm%% setup later).
</details>

<details>
  <summary><strong>1. 准备虚拟机的闪存驱动器</strong> - 点击展开/折叠</summary>

  配置 Unraid 虚拟机需要一些特定设置以确保正常运行。

  创建虚拟机模板：

  1. On the host Unraid server, go to ***Settings → VM Manager*** and ensure that %%VM|vm%% are enabled.
  2. Navigate to the **VMs** tab and click **Add VM**.
  3. Select the **Slackware** template, as it's the closest match to Unraid.
  4. (Optional) If available, replace the Slackware icon with the Unraid icon.
  5. Name the %%VM|vm%% (e.g., `UNRAID-VM`).
  6. (Optional) Add a description, such as *"Unraid test environment - vX.XX.X."*
  7. Assign resources:
     - CPUs: 2-4 cores
     - RAM: 4-8 GB (set Initial and Max to the same value)
  8. Set **Machine type** to **Q35 (latest)**.
  9. Set **BIOS** to **OVMF** and **USB controller** to **3.0 (QEMU XHCI)**.
  10. Configure virtual disks:
      - Add %%vDisks|vdisk%% for cache/data using **RAW** format and **SATA** bus.
      - Size disks differently for easy identification (e.g., %%parity|parity%% > data > %%cache|cache%%).
  11. Leave graphics, sound, and network at their default settings.
  12. Under **USB devices**, select the flash drive by **manufacturer**, not label.

  :::重要
  %%VM|vm%% 的闪存驱动器必须与主机的引导驱动器来自不同的制造商。如果它们相同，%%VM|vm%% 驱动器将不可见。
  :::
</details>

<details>
  <summary><strong>2. 在主机上设置虚拟机</strong> - 点击展开/折叠</summary>

  在配置后启动虚拟机：

  1. Uncheck **Start VM after creation** if you want manual control.
  2. Click **Create**.
  3. On the **VMs** tab, click the Unraid %%VM|vm%% icon and select **Start with console (%%VNC|vnc-session%%)**.
  4. Watch the boot process in the %%VNC|vnc-session%% console and note the %%VM|vm%%'s IP address displayed before login.
</details>

<details>
  <summary><strong>3. 创建并启动虚拟机</strong> - 点击展开/折叠</summary>

  虚拟机运行后，与物理 Unraid 服务器一样进行设置：

  1. Access the %%VM|vm%%'s **%%WebGUI|web-gui%%** at `http://[VM-IP]`.
  2. Go to ***Settings → Identification***:
     - Set a unique **Server name** (e.g., `Unraid-VM`).
     - Add a description like "Development instance."
  3. (Optional) Go to ***Settings → Display settings*** and choose a different color theme to distinguish it from the host.
  4. Go to ***Settings → %%SMB|samba%% settings → Workgroup settings*** and set **Local master** to *No* to avoid conflicts.
  5. For UPS passthrough (if the host has UPS):
     - Go to ***Settings → UPS*** on the %%VM|vm%%.
     - Set **UPS cable** to *Ether*.
     - Set **UPS type** to *net*.
     - Enter the host's IP in **Device**.
     - Configure **Runtime** to shut down the %%VM|vm%% before the host.
  6. Start the %%array|array%% with your configured devices.
  7. Install [**Community Applications**](https://unraid.net/community/apps) for plugin/Docker testing.
  8. Update the %%VM|vm%% via ***Tools → Update OS***, just like a physical server.
</details>

### 故障排除

If you encounter an *Execution Error* related to the USB flash device after editing %%VM|vm%% settings:

1. Edit the %%VM|vm%% and switch to **XML view**.
2. Locate the `<hostdev>` node that defines the flash device (usually near the end).
3. Delete the entire `<hostdev>...</hostdev>` block.
4. Click **Update**.
5. Re-edit the %%VM|vm%% in **Form view**.
6. Re-select the flash drive under **USB devices**.
7. Click **Update** again. The %%VM|vm%% should now start normally.
