# 版本 7.1.0 2025-05-05

This release adds wireless networking, the ability to import TrueNAS and other foreign pools, multiple enhancements to VMs, early steps toward making the webGUI responsive, and more.

## 升级

### 已知问题

此版本存在潜在的数据丢失问题，最近的"移动空盘"功能无法正确处理共享架构中的分级。已在7.1.2版本中修复。

#### 插件

Please upgrade all plugins, particularly Unraid Connect and the Nvidia driver.

有关其他已知问题，请参阅[7.0.0 发行说明](7.0.0.md#known-issues)。

### 回滚

我们正在改进补丁在各版本间的分发方式，因此本版本中将卸载独立补丁插件。如果回滚到早期版本，建议重新安装该插件。更多详情待发布。

如果回滚到早于7.0.0的版本，请参阅[7.0.0发行说明](7.0.0.md#rolling-back)。

## 更改 vs. [7.0.1](7.0.1.md)

### 存储

- Import foreign ZFS pools such as TrueNAS, Proxmox, Ubuntu, QNAP.
- 导入磁盘上最大的分区而不是第一个。
- Removing device from btrfs raid1 or zfs single-vdev mirror will now reduce pool slot count.

#### 其他存储更改

- 修正：仪表板不显示禁用的磁盘。
- 修正：添加自定义盘片设置后，最初仅第一个池设备停止旋转。
- 修复：仅有 2 个奇偶校验设备而无数据设备时允许数组启动。
- 修正：奇偶校验检查通知经常显示了先前的奇偶校验检查而不是当前的。
- 修复：升级时解决某些情况下_错误的池状态。太多错误或缺失设备_的问题。
- Fix: Not possible to replace a zfs device from a smaller vdev.
- 移动器：
  - 修正：解决了旧的share.cfg文件阻止移动程序运行的问题。
  - 修复：如果父目录不存在，则移动程序无法重新创建硬链接。
  - 修正：移动程序会卡在命名管道上。
  - 修正：[使用移动程序清空阵列磁盘](7.0.0.md#using-mover-to-empty-an-array-disk)现在只移动具有相应share.cfg文件的顶级文件夹，还修复了一个bug，无法显示_未移动的文件_列表。

### 网络

#### 无线网络

Unraid 现在支持WiFi！通常更倾向于有线连接，但如果对您的情况不可能，现在可以设置WiFi。

初始化设置时，您需要一个本地键盘/显示器（进入GUI模式），或使用有线连接。未来，USB Creator将能够在首次启动之前配置无线网络。

- Access the webGUI and visit _**Settings → Network Settings → Wireless wlan0**_
  - 首先，启用WiFi
  - **法规区域**通常可以留为**自动**，但如果想要连接的网络不可用，则设置为您的位置。
  - 找到您首选的网络并单击**连接到WiFi网络**图标
  - 填写您的WiFi密码和其他设置，然后按**加入此网络**
  - 注意：如果您的目标是通过WiFi使用Docker容器，请在启动Docker之前拔下任何有线连接

附加细节

- 支持WPA2/WPA3和WPA2/WPA3企业版，如果同时可用WPA2和WPA3，则使用WPA3。
- 长期使用时不建议同时使用有线和无线连接，应选择其一。但如果两个连接都使用DHCP且您在配置了无线后插拔网络电缆，系统（不包括Docker）应在45至60秒内调整。
- 无线芯片组支持：预计可以成功使用现代WiFi适配器，但旧款适配器可能无法工作。如果WiFi适配器未被检测到，请启动一个新帖子并提供诊断信息以进行调查。
- 如果想使用USB WiFi适配器，请参阅此[支持Linux内核驱动的USB WiFi适配器列表](https://github.com/morrownr/USB-WiFi/blob/main/home/USB_WiFi_Adapters_that_are_supported_with_Linux_in-kernel_drivers.md)
- 高级：将新的固件文件放置在`/boot/config/firmware/`中，将在加载驱动程序模块前复制到`/lib/firmware/`中（现有文件不会被覆盖）。

限制：使用无线时有网络限制，因为wlan只能有一个mac地址。

- 仅支持一个无线NIC，wlan0
- wlan0无法参与bond
- Docker容器
  - 在_**设置→Docker**_，注意启用无线时，系统将忽略**Docker自定义网络类型**设置并始终使用**ipvlan**（不能使用macvlan，因为无线不支持单个接口上的多个mac地址）
  - _**设置→Docker**_，**主机访问自定义网络**必须禁用
  - Docker容器的**网络类型**不能使用br0/bond0/eth0
  - Docker存在不能参与共享同一子网的两个网络的限制。如果在有线和无线之间切换，您需要重启Docker并重新配置所有现有容器以使用新接口。建议设置有线或无线中的一种并不进行切换。
- 虚拟机
  - 建议将虚拟机的**网络来源**设置为**virbr0**，在此模式下可以运行无限数量的虚拟机。虚拟机将拥有完整的网络访问权限，但缺点是无法从网络访问。您仍然可以通过VNC访问主机。
  - 通过一些手动配置，一个虚拟机可以在网络上访问：
    - 为虚拟机分配静态IP地址
    - 在ipvtap界面上配置相同的IP地址，类型：`ip addr add IP-地址 dev shim-wlan0`

#### 其他网络更改

- 在_**设置 → 网络设置**_，现在无需先停止其他服务便可调整服务器的DNS设置。请查看**eth0**部分的顶部。
- 配置网络接口时，每个接口都有一个**信息**按钮显示当前连接的详细信息。
- 配置网络接口时，**期望的MTU**字段默认禁用，直到点击**启用巨型帧**。将鼠标悬停在图标上可查看更改MTU的警告，大多数情况下应保持默认设置。
- 配置多个网络接口时，默认情况下，其他接口的网关将被禁用，这是适用于大多数需要单网关的网络的安全默认设置。如果启用了额外的网关，它将被赋予比现有网关更高的优先级，以避免冲突。根据需要可进行覆盖。
- 当您保存更改到_**设置→网络设置**_时，旧的网络接口将从配置文件中自动移除。
- 修正各种DHCP问题。

### VM管理器

#### Nouveau GPU驱动

默认情况下包含Nvidia显卡的Nouveau驱动程序，但大多数用户可能更希望使用Nvidia驱动程序。要启用，需卸载Nvidia驱动程序插件并运行`touch /boot/config/modprobe.d/nouveau.conf`，然后重新启动。

#### VirGL

现在可以使用VirGL在多个Linux虚拟机之间共享Intel和AMD显卡，VirGL是虚拟3D OpenGL渲染器。当以这种方式使用时，GPU将提供加速的图形，但不会在显示器上输出。请注意，这尚不适用于Windows虚拟机或标准Nvidia插件（但可在使用Nouveau驱动程序的Nvidia显卡上运行）。

要在Linux虚拟机中使用虚拟GPU，请编辑虚拟机模板，将**显卡**设置为**虚拟**。然后将**VM控制台视频驱动程序**设置为**Virtio(3d)**，并从可用的GPU列表中选择合适的**渲染GPU**。（注意，绑定到VFIO-PCI或传递给其他虚拟机的GPU不能在此处选择，Nvidia显卡仅在启用Nouveau驱动程序时可用。）

#### QXL虚拟GPU

要在虚拟机中使用此功能，编辑虚拟机模板并将**显卡**设置为**虚拟**，将**虚拟机控制台视频驱动程序**设置为**QXL (最佳)**，然后您可以选择支持的屏幕数量以及分配给它的内存大小。

#### CPU固定是可选的

CPU固定现在是可选的，如果没有将内核固定到虚拟机，则操作系统选择使用哪个内核。

在_**设置→CPU设置**_中或编辑虚拟机时，按**取消全选**取消固定此虚拟机的所有核心，并将vCPU数量设置为1，按需增加。

### 用户虚拟机模板

创建用户模板：

- 编辑虚拟机，选择**创建修改模板**并命名。它将以**用户模板**的形式存储在**添加虚拟机**屏幕中。

使用用户模板：

- 从虚拟机列表中，按**添加虚拟机**，然后从**用户模板**区域中选择模板。

导入/导出

- 在**添加虚拟机**页面上，将鼠标悬停在用户模板上，单击箭头将模板导出到服务器上的位置或下载它。
- 在另一台 Unraid 系统上，使用 **从文件导入** 或 **上传** 来使用模板。

#### 其他虚拟机更改

- 当 **Primary** GPU 被分配为虚拟机的直通时，警告其可能无法在不加载兼容的 vBIOS 时运行。
- 修正：当设置虚拟机服务时，移除误导的_路径不存在_消息
- Feat: Unraid VMs can now boot into GUI mode, when using the QXL video driver
- 修正：使用XML视图时无法更改虚拟机图标

### WebGUI

#### CSS更改

为让webGUI响应更好，我们重做了CSS。除了一些细微的颜色调整外，这在大多数情况下不应引起注意。我们预计大多数插件也能正常工作，尽管插件作者可能希望查看[此文档](https://github.com/unraid/webgui/blob/master/emhttp/plugins/dynamix/styles/themes/README.md)。未来版本将继续改善响应性。

如果您在任何官方主题中注意到对齐问题或颜色问题，请告知我们。

#### nchan共享内存问题

我们进行了几项更改以预防此问题，并且如果检测到问题发生，我们将重新启动 nginx 以尝试自动恢复。

If your Main page never populates, or if you see "nchan: Out of shared memory" in your logs, please start a new forum thread and provide your diagnostics. You can optionally navigate to _**Settings → Display Settings**_ and disable **Allow realtime updates on inactive browsers**; this prevents your browser from requesting certain updates once it loses focus. When in this state you will see a banner saying **Live Updates Paused**, simply click on the webGUI to bring it to the foreground and re-enable live updates. Certain pages will automatically reload to ensure they are displaying the latest information.

#### WebGUI 其他更改

- 修正：广告拦截器可能会阻止仪表板加载。
- 修正：在某些情况下，仪表板上的浏览器内存使用率可能会成倍增长。
- 修正：防止损坏的配置文件破坏仪表板。

## 其他

### 其他更改

- 在_**设置→日期和时间**_您现在可以使用**PTP**服务器同步时钟（我们预计大多数用户会继续使用**NTP**)
- 升级到jQuery 3.7.1和jQuery UI 1.14.1
- 修正：访问boot.php将不再关闭服务器
- 修正：在Docker选项卡上，最后一个容器的下拉菜单在某些情况下被截断
- Fix: On _**Settings → Docker**_, deleting a **Docker directory** stored on a ZFS volume now works properly
- 修正：启动时，自定义ssh配置从`/boot/config/ssh/`复制到`/etc/ssh/`
- 修正：文件管理器可以将文件从用户共享复制到未分配的磁盘挂载点
- 修正：删除Docker服务时的误导性_路径不存在_消息
- 修正：更新`rc.messagebus`以更正`/etc/machine-id`的处理
- 诊断
  - 修正：提高诊断中IPv6地址的匿名化
  - 修正：提高诊断中某些配置文件的用户名匿名化
  - 修正：诊断可能因syslog中的多字节字符串而失败
  - 功能：诊断现在记录错误在logs/diagnostics.error.log中记录

### Linux kernel

- 版本 6.12.24-Unraid
  - 应用：\[补丁] [还原 "PCI: 在通过sysfs禁用时避免重置"](https://lore.kernel.org/lkml/20250414211828.3530741-1-alex.williamson@redhat.com/)
  - CONFIG\_NR\_CPUS：从256增加到512
  - CONFIG\_TEHUTI\_TN40：Tehuti Networks TN40xx 10G以太网适配器
  - CONFIG\_DRM\_XE：Intel Xe图形
  - CONFIG\_UDMABUF：用户空间dmabuf杂项驱动程序
  - CONFIG\_DRM\_NOUVEAU：Nouveau（NVIDIA）显卡
  - CONFIG\_DRM\_QXL：QXL虚拟GPU
  - CONFIG\_EXFAT\_FS：exFAT文件系统支持
  - CONFIG\_PSI：压力坍塌信息跟踪
  - CONFIG\_PSI\_DEFAULT\_DISABLED：需要启动参数启用压力坍塌信息跟踪，即`psi=1`
  - CONFIG\_ENCLOSURE\_SERVICES：机箱服务
  - CONFIG\_SCSI\_ENCLOSURE：SCSI机箱支持
  - CONFIG\_DRM\_ACCEL：计算加速框架
  - CONFIG\_DRM\_ACCEL\_HABANALABS：HabanaLabs人工智能加速器
  - CONFIG\_DRM\_ACCEL\_IVPU：Intel神经处理单元（NPU）
  - CONFIG\_DRM\_ACCEL\_QAIC：Qualcomm云AI加速器
  - zfs: 版本 2.3.1

- 无线支持
  - Atheros/高通
  - 博通
  - 英特尔
  - Marvell
  - Microtek
  - Realtek

### 基础发行版更新

- aaa\_glibc-solibs：版本2.41
- adwaita-icon-theme: 版本 48.0
- at-spi2-core: 版本 2.56.1
- bind: 版本 9.20.8
- btrfs-progs: 版本 6.14
- ca-certificates: 版本 20250425
- cairo: 版本 1.18.4
- cifs-utils: 版本 7.3
- coreutils: 版本 9.7
- dbus: 版本 1.16.2
- dbus-glib: 版本 0.114
- dhcpcd: 版本 9.5.2
- diffutils: 版本 3.12
- dnsmasq: 版本 2.91
- docker: 版本 27.5.1
- e2fsprogs: 版本 1.47.2
- elogind: 版本 255.17
- elfutils: 版本 0.193
- ethtool: 版本 6.14
- firefox: 版本 128.10 (AppImage)
- floppy: 版本 5.6
- fontconfig: 版本 2.16.2
- gdbm: 版本 1.25
- git: 版本 2.49.0
- glib2: 版本 2.84.1
- glibc: 版本 2.41
- glibc-zoneinfo: 版本 2025b
- grep: 版本 3.12
- gtk+3: 版本 3.24.49
- gzip: 版本 1.14
- harfbuzz: 版本 11.1.0
- htop: 版本 3.4.1
- icu4c: 版本 77.1
- inih: 版本 60
- 英特尔微码: 版本 20250211
- iperf3: 版本 3.18
- iproute2: 版本 6.14.0
- iw: 版本 6.9
- jansson: 版本 2.14.1
- kernel-firmware：版本20250425\_cf6ea3d
- kmod: 版本 34.2
- less: 版本 674
- libSM: 版本 1.2.6
- libX11: 版本 1.8.12
- libarchive: 版本 3.7.8
- libcgroup: 版本 3.2.0
- libedit：版本20250104\_3.1
- libevdev: 版本 1.13.4
- libffi: 版本 3.4.8
- libidn: 版本 1.43
- libnftnl: 版本 1.2.9
- libnvme: 版本 1.13
- libgpg-error: 版本 1.55
- libpng: 版本 1.6.47
- libseccomp: 版本 2.6.0
- liburing: 版本 2.9
- libusb: 版本 1.0.28
- libuv: 版本 1.51.0
- libvirt: 版本 11.2.0
- libXft: 版本 2.3.9
- libxkbcommon: 版本 1.9.0
- libxml2: 版本 2.13.8
- libxslt: 版本 1.1.43
- libzip: 版本 1.11.3
- linuxptp: 版本 4.4
- lvm2: 版本 2.03.31
- lzip: 版本 1.25
- lzlib: 版本 1.15
- mcelog: 版本 204
- mesa: 版本 25.0.4
- mpfr: 版本 4.2.2
- nano: 版本 8.4
- ncurses：版本6.5\_20250419
- nettle: 版本 3.10.1
- nghttp2: 版本 1.65.0
- nghttp3: 版本 1.9.0
- noto-fonts-ttf: 版本 2025.03.01
- nvme-cli: 版本 2.13
- oniguruma: 版本 6.9.10
- openssh: 版本 10.0p1
- openssl: 版本 3.5.0
- ovmf: 稳定版 202502
- pam: 版本 1.7.0
- pango: 版本 1.56.3
- parted: 版本 3.6
- patch: 版本 2.8
- pcre2: 版本 10.45
- perl: 版本 5.40.2
- php: 版本 8.3.19
- procps-ng: 版本 4.0.5
- qemu: 版本 9.2.3
- rsync: 版本 3.4.1
- samba: 版本 4.21.3
- shadow: 版本 4.17.4
- spice: 版本 0.15.2
- spirv-llvm-translator: 版本 20.1.0
- sqlite: 版本 3.49.1
- sysstat: 版本 12.7.7
- sysvinit: 版本 3.14
- talloc: 版本 2.4.3
- tdb: 版本 1.4.13
- tevent: 版本 0.16.2
- tree: 版本 2.2.1
- userspace-rcu: 版本 0.15.2
- utempter: 版本 1.2.3
- util-linux: 版本 2.41
- virglrenderer: 版本 1.1.1
- virtiofsd: 版本 1.13.1
- which: 版本 2.23
- 无线-regdb: 版本 2025.02.20
- wpa\_supplicant：版本2.11
- xauth: 版本 1.1.4
- xf86-input-synaptics: 版本 1.10.0
- xfsprogs: 版本 6.14.0
- xhost: 版本 1.0.10
- xinit: 版本 1.4.4
- xkeyboard-config: 版本 2.44
- xorg-server: 版本 21.1.16
- xterm: 版本 398
- xtrans: 版本 1.6.0
- xz: 版本 5.8.1
- zstd: 版本 1.5.7

## 补丁

当前版本没有可用补丁。
