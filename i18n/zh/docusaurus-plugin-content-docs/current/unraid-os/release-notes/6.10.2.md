## 版本 6.10.2 2022-05-27

### tg3 驱动可能导致数据损坏，当启用 Intel VT-d 时

Linux 5.15 内核、tg3 驱动程序与开启的 Intel VT-d 结合使用
似乎导致数据损坏。此问题已在多个平台上验证，这些平台包括 Broadcom NetXtreme Gigabit Ethernet
NIC（注意：可能还有其他平台）。本版本包括以下
解决方法：

在服务器启动的早期阶段（rc.S），如果检测到启用了 Intel VT-d，脚本将无条件创建文件：

`/etc/modprobe.d/tg3.conf`

内容如下：

`blacklist tg3`

因此，如果默认状态下启用了 VT-d，即没有在 Bios 或通过内核"intel\_iommu=off"禁用，那么我们将在所有平台上将 tg3 驱动程序列入黑名单。如果某些人在某个平台上启用 VT-d 后，tg3 驱动程序没有出现问题，
那么他们必须在闪存设备中创建一个\_空白\_文件：

`config/modprobe.d/tg3.conf`

当启动序列继续时，它将执行：

`install -p -m 0644 /boot/config/modprobe.d/* /etc/modprobe.d`

在闪存上存储一个\_空白\_的tg3.conf文件，然后有效地将其解除黑名单。

会有用户因为他们的 NIC 被列入黑名单而失去网络连接。如果您正在使用问题平台，您应该进入您的 Bios 并禁用 VT-d。如果这是一个没有问题的平台，
那么您需要在您的闪存 config/modprobe.d 目录中创建空白的 tg3.conf 文件。

可能需要一些时间来识别和集成对此问题的适当修复，然后我们将删除自动将其列入黑名单的代码。

#### 如何在带 E3-1265LV2 的 HP MicroServer Gen 8 上禁用 Intel VT-d

重启服务器，然后：

- 启动时按 F9 键进入 BIOS。
- 一旦 bios 加载完成，进入菜单 系统选项 → 处理器选项 → Intel(R) VT-d
- 将其设置为禁用
- 按 Esc 返回到顶部菜单
- 按 F10 退出 BIOS 并保存

服务器现在应该能够正常启动。向社区成员
Oceanic 表示感谢
对于指导。

### 安全相关变更

- Firefox 浏览器已更新至 100.0.2 版本，以
  解决一个非常严重的安全漏洞。如果您使用 Firefox
  我们还建议在所有平台上进行升级。
- 我们修复了一个问题，即使该用户名包含字符串 "root"，WebGUI 登录可以接受来自非“root”用户的密码。
- Linux 内核已更新至 5.15.43 以解决“安全绕过”漏洞。

### 其他变更

- 在管理访问页面的 "使用 SSL/TLS" 设定中，我们将下拉菜单中的 "自动" 改成了 "严格"。此举更好地描述了此设置的作用。
- Docker 管理器现在将使用 Docker 标签作为图标的后备。
- 虚拟机管理器现在提供使用 libvirt 网络的选项，无需编辑虚拟机的 XML。
- 改进了自定义 SSL 证书的处理。
- \[6.10.1] 修复回归问题：支持分区 1 以外的 USB 闪存启动
- 其他杂项错误修复

## 与 Unraid OS 6.10.1 的变更日志

#### 基本发行版

- firefox AppImage：版本：100.0.r20220519220738 (CVE-2022-1802 CVE-2022-1529)

#### Linux kernel

- 版本 5.15.43-Unraid (CVE-2022-21499)

#### 管理

- nginx：避免在重定向 URL 中附加默认端口号
- nginx：自签名证书文件：接受普通名称和所有备用名称
- 启动：修复多个网络接口分配相同 MAC 地址的问题
- 启动：如果启用 Intel VT-d，则默认将 tg3 列入黑名单
- WebGUI：管理访问： 使用 SSL/TLS 设置：将“Auto”改为“Strict”
- WebGUI: 已修复：选择控制器时未包含 smGlue
- WebGUI：修复：允许共享名称中嵌入 & 符号
- WebGUI：添加 LXC 终端支持（用于 LXC 插件）
- WebGUI：Docker Web UI 使用 Docker 标签作为图标的后备
- WebGUI：虚拟机管理器：支持 libvirt 网络（使 libvirt 网络可通过 gui 访问）
- WebGUI：修复问题，即‘root’登录可以使用包含‘root’字符串的其他用户名的密码
- WebGUI：更新系统页面拼写修正：warninging → warning
- WebGUI：帮助文本复查：小修正

## 补丁

安装 [Unraid Patch 插件](https://forums.unraid.net/topic/185560-unraid-patch-plugin/) 后，访问 ***工具 → Unraid Patch*** 获取以下补丁/紧急修复：

- 一部分安全更新，详情请参阅 [这篇博客文章](https://unraid.net/blog/cvd)。我们建议升级到最新稳定版本以获取其他安全更新。
